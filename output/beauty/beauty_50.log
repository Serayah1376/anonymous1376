nohup: ignoring input
Cpp extension not loaded
>>SEED: 2023
loading [./datasets/beauty]
82167 interactions for training
16399 interactions for testing
beauty Sparsity : 0.0020608405216870815
beauty is ready to go
loading adjacency matrix
lgn is already to go(dropout:0)
load and save to ./checkpoints/lgn-beauty-4-64.pth.tar
===========config================
dataset: beauty
layer num: 4
recdim: 64
model: lgn
testbatch 100
topks [10, 20, 50]
epochs 2000
max_len 64
regloss2_decay 1e-06
head_num 1
gamma 0.5
gamma2(submodular) 2.0
sigma(submodular) 1.0
k(number of aggregated neighbors) 20
ADD new aspects 16
loss function au
===========end===================
EPOCH[1/2000] loss2.370-|Sample:1.88|use_time:19.995269060134888
EPOCH[2/2000] loss2.252-|Sample:1.88|use_time:19.86355209350586
EPOCH[3/2000] loss2.140-|Sample:2.14|use_time:20.093483448028564
EPOCH[4/2000] loss2.028-|Sample:1.76|use_time:19.77028203010559
EPOCH[5/2000] loss1.909-|Sample:1.98|use_time:19.194793462753296
EPOCH[6/2000] loss1.820-|Sample:2.06|use_time:20.090877532958984
EPOCH[7/2000] loss1.735-|Sample:0.96|use_time:19.686150074005127
EPOCH[8/2000] loss1.655-|Sample:0.95|use_time:20.130824089050293
EPOCH[9/2000] loss1.579-|Sample:0.95|use_time:18.163005828857422
EPOCH[10/2000] loss1.505-|Sample:1.76|use_time:19.62960124015808
EPOCH[11/2000] loss1.434-|Sample:2.16|use_time:20.118205308914185
EPOCH[12/2000] loss1.366-|Sample:1.89|use_time:19.787208795547485
EPOCH[13/2000] loss1.301-|Sample:0.96|use_time:19.89434266090393
EPOCH[14/2000] loss1.238-|Sample:0.96|use_time:19.126988172531128
EPOCH[15/2000] loss1.178-|Sample:0.95|use_time:18.681315422058105
EPOCH[16/2000] loss1.118-|Sample:1.83|use_time:19.733665704727173
EPOCH[17/2000] loss1.058-|Sample:2.18|use_time:22.401029109954834
EPOCH[18/2000] loss0.999-|Sample:2.13|use_time:21.533745050430298
EPOCH[19/2000] loss0.937-|Sample:1.32|use_time:22.877700567245483
EPOCH[20/2000] loss0.876-|Sample:1.32|use_time:22.294482946395874
EPOCH[21/2000] loss0.821-|Sample:1.31|use_time:21.596670389175415
EPOCH[22/2000] loss0.762-|Sample:2.59|use_time:22.14090895652771
EPOCH[23/2000] loss0.678-|Sample:2.12|use_time:22.389254093170166
EPOCH[24/2000] loss0.620-|Sample:2.54|use_time:22.711668968200684
EPOCH[25/2000] loss0.567-|Sample:2.24|use_time:22.44672393798828
EPOCH[26/2000] loss0.518-|Sample:1.82|use_time:19.44579553604126
EPOCH[27/2000] loss0.472-|Sample:0.95|use_time:19.956470727920532
EPOCH[28/2000] loss0.429-|Sample:0.95|use_time:19.699214696884155
EPOCH[29/2000] loss0.390-|Sample:0.95|use_time:18.818409204483032
EPOCH[30/2000] loss0.350-|Sample:2.12|use_time:19.066665649414062
EPOCH[31/2000] loss0.313-|Sample:1.77|use_time:19.663599967956543
EPOCH[32/2000] loss0.277-|Sample:2.01|use_time:19.901105642318726
EPOCH[33/2000] loss0.242-|Sample:0.95|use_time:19.787768602371216
EPOCH[34/2000] loss0.209-|Sample:0.95|use_time:19.87575364112854
EPOCH[35/2000] loss0.177-|Sample:0.96|use_time:18.45793890953064
EPOCH[36/2000] loss0.143-|Sample:1.95|use_time:19.781789779663086
EPOCH[37/2000] loss0.116-|Sample:1.76|use_time:19.72603964805603
EPOCH[38/2000] loss0.084-|Sample:2.14|use_time:20.12379264831543
EPOCH[39/2000] loss0.057-|Sample:0.95|use_time:18.73910617828369
EPOCH[40/2000] loss0.030-|Sample:0.95|use_time:19.979001760482788
EPOCH[41/2000] loss0.003-|Sample:0.95|use_time:18.786242961883545
EPOCH[42/2000] loss-0.024-|Sample:1.84|use_time:19.657071828842163
EPOCH[43/2000] loss-0.047-|Sample:1.87|use_time:19.881149291992188
EPOCH[44/2000] loss-0.070-|Sample:2.10|use_time:19.290151596069336
EPOCH[45/2000] loss-0.093-|Sample:0.96|use_time:19.45398783683777
EPOCH[46/2000] loss-0.118-|Sample:0.95|use_time:19.90537142753601
EPOCH[47/2000] loss-0.138-|Sample:0.95|use_time:18.97363591194153
EPOCH[48/2000] loss-0.159-|Sample:1.76|use_time:18.76945471763611
EPOCH[49/2000] loss-0.179-|Sample:1.96|use_time:19.701348304748535
EPOCH[50/2000] loss-0.201-|Sample:2.02|use_time:19.624496459960938
[TEST]
/root/autodl-tmp/anonymous1376/code/evaluater.py:42: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  self.aspect = np.array(list(dataset.item_aspect_dic.values()))
{'precision': array([0.0043196 , 0.00385768, 0.00330337]), 'recall': array([0.0164477 , 0.02902345, 0.06280676]), 'ndcg': array([0.00985081, 0.01373375, 0.02211077]), 'coverage': array([24.039201  , 28.1948814 , 32.67965044]), 'Acoverage': array([ 454.57253433,  710.32484395, 1238.34219725]), 'ILD': array([0.75428492, 0.76219791, 0.77241672]), 'F1': array([0.0321934 , 0.05591763, 0.11616769])}
test time: 63.2005033493042
reg_loss2: tensor(0.3591, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-0.5805, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2850, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[51/2000] loss-0.217-|Sample:2.35|use_time:20.402658224105835
EPOCH[52/2000] loss-0.239-|Sample:0.95|use_time:19.667256593704224
EPOCH[53/2000] loss-0.257-|Sample:0.96|use_time:18.070407390594482
EPOCH[54/2000] loss-0.275-|Sample:2.13|use_time:20.717081785202026
EPOCH[55/2000] loss-0.293-|Sample:0.96|use_time:18.816418886184692
EPOCH[56/2000] loss-0.307-|Sample:1.80|use_time:19.798815488815308
EPOCH[57/2000] loss-0.323-|Sample:2.19|use_time:20.031627655029297
EPOCH[58/2000] loss-0.340-|Sample:1.83|use_time:20.201773405075073
EPOCH[59/2000] loss-0.355-|Sample:0.96|use_time:18.716614484786987
EPOCH[60/2000] loss-0.371-|Sample:2.16|use_time:20.84630513191223
EPOCH[61/2000] loss-0.384-|Sample:0.95|use_time:18.66186833381653
EPOCH[62/2000] loss-0.400-|Sample:1.97|use_time:19.03699016571045
EPOCH[63/2000] loss-0.410-|Sample:2.04|use_time:19.710739374160767
EPOCH[64/2000] loss-0.426-|Sample:0.95|use_time:19.518739938735962
EPOCH[65/2000] loss-0.439-|Sample:0.95|use_time:19.958110094070435
EPOCH[66/2000] loss-0.449-|Sample:0.97|use_time:18.910528898239136
EPOCH[67/2000] loss-0.464-|Sample:1.76|use_time:18.998422861099243
EPOCH[68/2000] loss-0.478-|Sample:2.08|use_time:20.07498264312744
EPOCH[69/2000] loss-0.487-|Sample:0.95|use_time:19.73512625694275
EPOCH[70/2000] loss-0.501-|Sample:0.95|use_time:19.970679998397827
EPOCH[71/2000] loss-0.509-|Sample:0.96|use_time:18.158743858337402
EPOCH[72/2000] loss-0.518-|Sample:1.91|use_time:19.5544273853302
EPOCH[73/2000] loss-0.530-|Sample:1.76|use_time:19.700011491775513
EPOCH[74/2000] loss-0.541-|Sample:2.17|use_time:19.95425534248352
EPOCH[75/2000] loss-0.553-|Sample:0.94|use_time:19.440292835235596
EPOCH[76/2000] loss-0.564-|Sample:0.97|use_time:19.633875370025635
EPOCH[77/2000] loss-0.571-|Sample:0.95|use_time:18.737441062927246
EPOCH[78/2000] loss-0.581-|Sample:1.87|use_time:19.631333827972412
EPOCH[79/2000] loss-0.593-|Sample:1.77|use_time:19.743369102478027
EPOCH[80/2000] loss-0.602-|Sample:2.09|use_time:19.155579566955566
EPOCH[81/2000] loss-0.611-|Sample:0.95|use_time:19.5786874294281
EPOCH[82/2000] loss-0.619-|Sample:0.97|use_time:18.73666000366211
EPOCH[83/2000] loss-0.628-|Sample:2.18|use_time:19.913574695587158
EPOCH[84/2000] loss-0.637-|Sample:2.24|use_time:22.25198197364807
EPOCH[85/2000] loss-0.644-|Sample:2.20|use_time:22.487000942230225
EPOCH[86/2000] loss-0.654-|Sample:2.63|use_time:22.572922706604004
EPOCH[87/2000] loss-0.661-|Sample:2.13|use_time:22.380363941192627
EPOCH[88/2000] loss-0.669-|Sample:2.57|use_time:21.924703121185303
EPOCH[89/2000] loss-0.675-|Sample:2.16|use_time:22.310269594192505
EPOCH[90/2000] loss-0.684-|Sample:1.31|use_time:22.7463538646698
EPOCH[91/2000] loss-0.694-|Sample:1.31|use_time:21.432453393936157
EPOCH[92/2000] loss-0.700-|Sample:2.12|use_time:21.43945574760437
EPOCH[93/2000] loss-0.707-|Sample:2.52|use_time:22.71238398551941
EPOCH[94/2000] loss-0.712-|Sample:2.24|use_time:22.366588592529297
EPOCH[95/2000] loss-0.721-|Sample:1.30|use_time:22.60155987739563
EPOCH[96/2000] loss-0.726-|Sample:1.31|use_time:21.773300170898438
EPOCH[97/2000] loss-0.736-|Sample:1.31|use_time:21.50861644744873
EPOCH[98/2000] loss-0.740-|Sample:2.39|use_time:22.63867688179016
EPOCH[99/2000] loss-0.748-|Sample:2.36|use_time:22.482691526412964
EPOCH[100/2000] loss-0.755-|Sample:2.15|use_time:22.207456588745117
[TEST]
{'precision': array([0.01262172, 0.01016854, 0.00683645]), 'recall': array([0.05195257, 0.08365598, 0.13846755]), 'ndcg': array([0.03218653, 0.04203259, 0.05561809]), 'coverage': array([24.98826467, 28.90087391, 32.99338327]), 'Acoverage': array([ 489.72421973,  749.85530587, 1275.1627965 ]), 'ILD': array([0.77341379, 0.77636244, 0.78433387]), 'F1': array([0.09736485, 0.15103714, 0.23538062])}
test time: 68.3889307975769
reg_loss2: tensor(0.1731, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-0.9705, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2580, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[101/2000] loss-0.759-|Sample:1.31|use_time:22.835622549057007
EPOCH[102/2000] loss-0.766-|Sample:1.32|use_time:22.31354308128357
EPOCH[103/2000] loss-0.773-|Sample:1.30|use_time:21.22063112258911
EPOCH[104/2000] loss-0.780-|Sample:2.38|use_time:22.237096309661865
EPOCH[105/2000] loss-0.784-|Sample:2.42|use_time:21.598905086517334
EPOCH[106/2000] loss-0.789-|Sample:2.13|use_time:21.33056139945984
EPOCH[107/2000] loss-0.796-|Sample:2.59|use_time:21.767677783966064
EPOCH[108/2000] loss-0.801-|Sample:1.83|use_time:18.715275049209595
EPOCH[109/2000] loss-0.807-|Sample:1.77|use_time:19.85335350036621
EPOCH[110/2000] loss-0.812-|Sample:0.96|use_time:19.9460391998291
EPOCH[111/2000] loss-0.818-|Sample:0.95|use_time:19.643670082092285
EPOCH[112/2000] loss-0.820-|Sample:0.95|use_time:18.77226734161377
EPOCH[113/2000] loss-0.828-|Sample:2.13|use_time:19.810577869415283
EPOCH[114/2000] loss-0.833-|Sample:1.77|use_time:19.695244550704956
EPOCH[115/2000] loss-0.838-|Sample:2.00|use_time:19.95740008354187
EPOCH[116/2000] loss-0.843-|Sample:0.94|use_time:19.7937593460083
EPOCH[117/2000] loss-0.847-|Sample:0.96|use_time:19.04183292388916
EPOCH[118/2000] loss-0.854-|Sample:0.96|use_time:18.817951440811157
EPOCH[119/2000] loss-0.855-|Sample:2.03|use_time:19.720000743865967
EPOCH[120/2000] loss-0.860-|Sample:1.76|use_time:19.500516414642334
EPOCH[121/2000] loss-0.866-|Sample:2.07|use_time:19.87783908843994
EPOCH[122/2000] loss-0.871-|Sample:0.95|use_time:19.143336296081543
EPOCH[123/2000] loss-0.873-|Sample:0.95|use_time:19.858197450637817
EPOCH[124/2000] loss-0.879-|Sample:0.96|use_time:18.851994276046753
EPOCH[125/2000] loss-0.885-|Sample:1.94|use_time:19.819276571273804
EPOCH[126/2000] loss-0.889-|Sample:1.75|use_time:18.805690050125122
EPOCH[127/2000] loss-0.892-|Sample:2.14|use_time:19.92267370223999
EPOCH[128/2000] loss-0.898-|Sample:0.96|use_time:19.572446823120117
EPOCH[129/2000] loss-0.900-|Sample:0.95|use_time:18.6886625289917
EPOCH[130/2000] loss-0.903-|Sample:2.18|use_time:19.831695795059204
EPOCH[131/2000] loss-0.909-|Sample:1.90|use_time:18.925957918167114
EPOCH[132/2000] loss-0.910-|Sample:1.75|use_time:19.54140853881836
EPOCH[133/2000] loss-0.914-|Sample:2.17|use_time:20.101327657699585
EPOCH[134/2000] loss-0.919-|Sample:1.88|use_time:19.752020359039307
EPOCH[135/2000] loss-0.922-|Sample:1.78|use_time:18.945470809936523
EPOCH[136/2000] loss-0.926-|Sample:2.10|use_time:20.07818031311035
EPOCH[137/2000] loss-0.929-|Sample:0.97|use_time:19.77022624015808
EPOCH[138/2000] loss-0.934-|Sample:0.96|use_time:19.011244297027588
EPOCH[139/2000] loss-0.937-|Sample:2.14|use_time:20.02873659133911
EPOCH[140/2000] loss-0.940-|Sample:1.75|use_time:19.207380771636963
EPOCH[141/2000] loss-0.943-|Sample:1.96|use_time:20.01947021484375
EPOCH[142/2000] loss-0.945-|Sample:0.95|use_time:19.81934356689453
EPOCH[143/2000] loss-0.949-|Sample:0.97|use_time:19.80384850502014
EPOCH[144/2000] loss-0.951-|Sample:0.96|use_time:18.17988657951355
EPOCH[145/2000] loss-0.953-|Sample:1.96|use_time:19.617960453033447
EPOCH[146/2000] loss-0.959-|Sample:1.74|use_time:19.5799663066864
EPOCH[147/2000] loss-0.964-|Sample:2.11|use_time:19.87592649459839
EPOCH[148/2000] loss-0.963-|Sample:0.95|use_time:19.7019259929657
loss: -0.9630099215158602, EarlyStopping counter: 1 out of 300
EPOCH[149/2000] loss-0.966-|Sample:0.97|use_time:19.475048303604126
EPOCH[150/2000] loss-0.968-|Sample:0.95|use_time:18.81713843345642
[TEST]
{'precision': array([0.01882647, 0.01437578, 0.00921348]), 'recall': array([0.08138663, 0.12267711, 0.19182401]), 'ndcg': array([0.05330193, 0.06598978, 0.08308653]), 'coverage': array([24.61735331, 28.38913858, 33.0639201 ]), 'Acoverage': array([ 482.67790262,  731.27990012, 1250.521598  ]), 'ILD': array([0.75269247, 0.76212103, 0.78279946]), 'F1': array([0.14689039, 0.21133589, 0.30813896])}
test time: 69.02260541915894
reg_loss2: tensor(0.1068, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.0691, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2375, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[151/2000] loss-0.971-|Sample:2.34|use_time:20.36490273475647
EPOCH[152/2000] loss-0.977-|Sample:2.21|use_time:20.11070203781128
EPOCH[153/2000] loss-0.976-|Sample:1.83|use_time:18.843019723892212
loss: -0.9761412419923922, EarlyStopping counter: 1 out of 300
EPOCH[154/2000] loss-0.983-|Sample:1.76|use_time:19.853010177612305
EPOCH[155/2000] loss-0.981-|Sample:2.12|use_time:20.092325448989868
loss: -0.9809755174125113, EarlyStopping counter: 1 out of 300
EPOCH[156/2000] loss-0.988-|Sample:1.78|use_time:19.72284197807312
EPOCH[157/2000] loss-0.990-|Sample:0.97|use_time:19.991252899169922
EPOCH[158/2000] loss-0.994-|Sample:0.95|use_time:19.29543447494507
EPOCH[159/2000] loss-0.996-|Sample:0.95|use_time:18.898104667663574
EPOCH[160/2000] loss-0.999-|Sample:1.89|use_time:19.803481340408325
EPOCH[161/2000] loss-0.999-|Sample:2.11|use_time:19.80007290840149
loss: -0.9989883056501063, EarlyStopping counter: 1 out of 300
EPOCH[162/2000] loss-1.001-|Sample:1.77|use_time:18.863383769989014
EPOCH[163/2000] loss-1.005-|Sample:0.96|use_time:19.95605182647705
EPOCH[164/2000] loss-1.007-|Sample:0.96|use_time:19.560062885284424
EPOCH[165/2000] loss-1.008-|Sample:0.96|use_time:18.909878969192505
EPOCH[166/2000] loss-1.012-|Sample:2.03|use_time:20.011861085891724
EPOCH[167/2000] loss-1.014-|Sample:1.97|use_time:19.13947081565857
EPOCH[168/2000] loss-1.016-|Sample:1.75|use_time:19.70972180366516
EPOCH[169/2000] loss-1.017-|Sample:0.97|use_time:20.16447925567627
EPOCH[170/2000] loss-1.023-|Sample:0.96|use_time:19.67019248008728
EPOCH[171/2000] loss-1.024-|Sample:0.95|use_time:18.010520935058594
EPOCH[172/2000] loss-1.026-|Sample:2.14|use_time:19.891247034072876
EPOCH[173/2000] loss-1.025-|Sample:1.89|use_time:19.754146337509155
loss: -1.0254039473649932, EarlyStopping counter: 1 out of 300
EPOCH[174/2000] loss-1.030-|Sample:1.77|use_time:19.79392647743225
EPOCH[175/2000] loss-1.030-|Sample:0.95|use_time:19.93353033065796
EPOCH[176/2000] loss-1.032-|Sample:0.96|use_time:18.202306509017944
EPOCH[177/2000] loss-1.032-|Sample:1.77|use_time:19.747010707855225
EPOCH[178/2000] loss-1.035-|Sample:2.21|use_time:20.100900888442993
EPOCH[179/2000] loss-1.037-|Sample:1.84|use_time:19.69694972038269
EPOCH[180/2000] loss-1.039-|Sample:1.89|use_time:19.03144884109497
EPOCH[181/2000] loss-1.041-|Sample:2.15|use_time:20.03630542755127
EPOCH[182/2000] loss-1.043-|Sample:1.76|use_time:19.712942361831665
EPOCH[183/2000] loss-1.045-|Sample:2.01|use_time:19.88391613960266
EPOCH[184/2000] loss-1.050-|Sample:0.98|use_time:19.74394655227661
EPOCH[185/2000] loss-1.048-|Sample:0.96|use_time:18.529611825942993
loss: -1.047513560550969, EarlyStopping counter: 1 out of 300
EPOCH[186/2000] loss-1.050-|Sample:2.02|use_time:19.969640254974365
EPOCH[187/2000] loss-1.051-|Sample:2.00|use_time:19.860946655273438
EPOCH[188/2000] loss-1.054-|Sample:1.77|use_time:19.75598430633545
EPOCH[189/2000] loss-1.055-|Sample:0.96|use_time:19.286806106567383
EPOCH[190/2000] loss-1.060-|Sample:0.96|use_time:19.53985095024109
EPOCH[191/2000] loss-1.058-|Sample:0.97|use_time:18.869768381118774
loss: -1.0584763724629471, EarlyStopping counter: 1 out of 300
EPOCH[192/2000] loss-1.061-|Sample:2.10|use_time:19.879395484924316
EPOCH[193/2000] loss-1.059-|Sample:1.90|use_time:19.591500520706177
loss: -1.059177099204645, EarlyStopping counter: 1 out of 300
EPOCH[194/2000] loss-1.062-|Sample:1.76|use_time:19.206665992736816
EPOCH[195/2000] loss-1.064-|Sample:0.96|use_time:20.133970499038696
EPOCH[196/2000] loss-1.065-|Sample:0.96|use_time:19.60313367843628
EPOCH[197/2000] loss-1.066-|Sample:0.96|use_time:18.950166940689087
EPOCH[198/2000] loss-1.068-|Sample:2.12|use_time:19.107296228408813
EPOCH[199/2000] loss-1.071-|Sample:1.84|use_time:19.686620950698853
EPOCH[200/2000] loss-1.072-|Sample:1.83|use_time:19.99367117881775
[TEST]
{'precision': array([0.02228464, 0.01660424, 0.01040699]), 'recall': array([0.09741049, 0.14168387, 0.2162141 ]), 'ndcg': array([0.06421018, 0.07773801, 0.09624808]), 'coverage': array([24.51972534, 28.37740325, 32.92247191]), 'Acoverage': array([ 479.19500624,  731.83695381, 1239.95917603]), 'ILD': array([0.74033014, 0.75615875, 0.78105521]), 'F1': array([0.17216765, 0.23865096, 0.33867512])}
test time: 69.19790315628052
reg_loss2: tensor(0.0716, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.1572, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2474, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[201/2000] loss-1.073-|Sample:0.96|use_time:20.37638545036316
EPOCH[202/2000] loss-1.073-|Sample:0.95|use_time:18.983754634857178
EPOCH[203/2000] loss-1.074-|Sample:1.78|use_time:18.834004640579224
EPOCH[204/2000] loss-1.077-|Sample:1.83|use_time:19.63000750541687
EPOCH[205/2000] loss-1.075-|Sample:0.95|use_time:19.80709457397461
loss: -1.0751079786114577, EarlyStopping counter: 1 out of 300
EPOCH[206/2000] loss-1.079-|Sample:0.97|use_time:19.71330761909485
EPOCH[207/2000] loss-1.078-|Sample:0.96|use_time:18.118711709976196
loss: -1.078125238418579, EarlyStopping counter: 1 out of 300
EPOCH[208/2000] loss-1.084-|Sample:2.12|use_time:20.835994243621826
EPOCH[209/2000] loss-1.085-|Sample:0.95|use_time:18.825602054595947
EPOCH[210/2000] loss-1.086-|Sample:1.98|use_time:19.85939311981201
EPOCH[211/2000] loss-1.085-|Sample:2.01|use_time:19.89020037651062
loss: -1.0847827283347524, EarlyStopping counter: 1 out of 300
EPOCH[212/2000] loss-1.086-|Sample:0.97|use_time:19.007137298583984
EPOCH[213/2000] loss-1.087-|Sample:0.96|use_time:20.172603130340576
EPOCH[214/2000] loss-1.089-|Sample:0.96|use_time:18.787492513656616
EPOCH[215/2000] loss-1.088-|Sample:1.75|use_time:19.79525136947632
loss: -1.0883599926785725, EarlyStopping counter: 1 out of 300
EPOCH[216/2000] loss-1.091-|Sample:2.16|use_time:19.30899953842163
EPOCH[217/2000] loss-1.091-|Sample:0.96|use_time:19.77728247642517
loss: -1.0905623697653049, EarlyStopping counter: 1 out of 300
EPOCH[218/2000] loss-1.091-|Sample:0.96|use_time:20.034238815307617
EPOCH[219/2000] loss-1.095-|Sample:0.96|use_time:18.881882905960083
EPOCH[220/2000] loss-1.094-|Sample:1.90|use_time:19.600210189819336
loss: -1.094038998208395, EarlyStopping counter: 1 out of 300
EPOCH[221/2000] loss-1.097-|Sample:1.75|use_time:19.247425317764282
EPOCH[222/2000] loss-1.098-|Sample:2.11|use_time:20.097541093826294
EPOCH[223/2000] loss-1.098-|Sample:0.95|use_time:19.643821239471436
EPOCH[224/2000] loss-1.102-|Sample:0.95|use_time:19.855249166488647
EPOCH[225/2000] loss-1.100-|Sample:0.97|use_time:18.103590965270996
loss: -1.1003676100475033, EarlyStopping counter: 1 out of 300
EPOCH[226/2000] loss-1.103-|Sample:1.83|use_time:19.6932954788208
EPOCH[227/2000] loss-1.101-|Sample:1.82|use_time:19.924756050109863
loss: -1.1013555119677287, EarlyStopping counter: 1 out of 300
EPOCH[228/2000] loss-1.105-|Sample:2.05|use_time:19.81157946586609
EPOCH[229/2000] loss-1.108-|Sample:0.95|use_time:19.679970264434814
EPOCH[230/2000] loss-1.107-|Sample:0.99|use_time:18.49143671989441
loss: -1.106713303705541, EarlyStopping counter: 1 out of 300
EPOCH[231/2000] loss-1.104-|Sample:2.13|use_time:20.000888347625732
loss: -1.1044818075691782, EarlyStopping counter: 2 out of 300
EPOCH[232/2000] loss-1.108-|Sample:1.76|use_time:19.68726634979248
EPOCH[233/2000] loss-1.108-|Sample:2.01|use_time:19.763460636138916
loss: -1.1077126584401944, EarlyStopping counter: 1 out of 300
EPOCH[234/2000] loss-1.106-|Sample:2.03|use_time:18.987550497055054
loss: -1.1061293817147977, EarlyStopping counter: 2 out of 300
EPOCH[235/2000] loss-1.110-|Sample:1.75|use_time:19.681851625442505
EPOCH[236/2000] loss-1.112-|Sample:2.03|use_time:20.020408153533936
EPOCH[237/2000] loss-1.112-|Sample:1.92|use_time:19.730156421661377
loss: -1.1118389077302886, EarlyStopping counter: 1 out of 300
EPOCH[238/2000] loss-1.112-|Sample:0.96|use_time:19.87342643737793
EPOCH[239/2000] loss-1.114-|Sample:0.95|use_time:18.61647343635559
EPOCH[240/2000] loss-1.114-|Sample:1.94|use_time:19.791008234024048
loss: -1.1136402676745158, EarlyStopping counter: 1 out of 300
EPOCH[241/2000] loss-1.114-|Sample:1.75|use_time:19.70740580558777
EPOCH[242/2000] loss-1.115-|Sample:2.13|use_time:19.924469232559204
EPOCH[243/2000] loss-1.115-|Sample:0.98|use_time:18.846723556518555
loss: -1.1149245907620686, EarlyStopping counter: 1 out of 300
EPOCH[244/2000] loss-1.114-|Sample:0.96|use_time:19.855947017669678
loss: -1.114309508626054, EarlyStopping counter: 2 out of 300
EPOCH[245/2000] loss-1.118-|Sample:0.95|use_time:18.87529945373535
EPOCH[246/2000] loss-1.119-|Sample:1.87|use_time:19.59183430671692
EPOCH[247/2000] loss-1.120-|Sample:1.79|use_time:19.764803409576416
EPOCH[248/2000] loss-1.123-|Sample:2.10|use_time:19.821824312210083
EPOCH[249/2000] loss-1.121-|Sample:0.95|use_time:19.733777046203613
loss: -1.1209170091442946, EarlyStopping counter: 1 out of 300
EPOCH[250/2000] loss-1.122-|Sample:0.95|use_time:19.98039412498474
loss: -1.1216811523204897, EarlyStopping counter: 2 out of 300
[TEST]
{'precision': array([0.02367041, 0.01752809, 0.01118602]), 'recall': array([0.10298193, 0.15086732, 0.23008066]), 'ndcg': array([0.06907241, 0.08353724, 0.10341069]), 'coverage': array([24.07490637, 28.08327091, 32.63645443]), 'Acoverage': array([ 477.35168539,  730.43907615, 1235.82846442]), 'ILD': array([0.72993758, 0.74973126, 0.77657153]), 'F1': array([0.18049854, 0.25118837, 0.35498674])}
test time: 69.89127707481384
reg_loss2: tensor(0.0519, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.1827, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2354, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[251/2000] loss-1.124-|Sample:0.95|use_time:19.466328859329224
EPOCH[252/2000] loss-1.123-|Sample:2.11|use_time:19.13429093360901
loss: -1.1228595913910284, EarlyStopping counter: 1 out of 300
EPOCH[253/2000] loss-1.123-|Sample:1.86|use_time:19.697309017181396
loss: -1.123293417256053, EarlyStopping counter: 2 out of 300
EPOCH[254/2000] loss-1.122-|Sample:1.75|use_time:19.6887845993042
loss: -1.1218164054358877, EarlyStopping counter: 3 out of 300
EPOCH[255/2000] loss-1.124-|Sample:2.21|use_time:20.097670316696167
EPOCH[256/2000] loss-1.127-|Sample:1.85|use_time:19.71227240562439
EPOCH[257/2000] loss-1.127-|Sample:1.79|use_time:19.376957654953003
loss: -1.126667650734506, EarlyStopping counter: 1 out of 300
EPOCH[258/2000] loss-1.127-|Sample:0.95|use_time:20.05662965774536
loss: -1.1267287614868908, EarlyStopping counter: 2 out of 300
EPOCH[259/2000] loss-1.128-|Sample:0.95|use_time:19.642009258270264
EPOCH[260/2000] loss-1.127-|Sample:0.97|use_time:18.872174739837646
loss: -1.1271152612639637, EarlyStopping counter: 1 out of 300
EPOCH[261/2000] loss-1.129-|Sample:2.18|use_time:19.153393507003784
EPOCH[262/2000] loss-1.129-|Sample:1.75|use_time:19.462661266326904
EPOCH[263/2000] loss-1.131-|Sample:1.94|use_time:19.814010858535767
EPOCH[264/2000] loss-1.133-|Sample:0.95|use_time:19.65424633026123
EPOCH[265/2000] loss-1.129-|Sample:0.96|use_time:19.843758821487427
loss: -1.129205930523756, EarlyStopping counter: 1 out of 300
EPOCH[266/2000] loss-1.132-|Sample:0.96|use_time:18.2581627368927
loss: -1.1323169033701828, EarlyStopping counter: 2 out of 300
EPOCH[267/2000] loss-1.131-|Sample:2.04|use_time:19.871376276016235
loss: -1.1312177675526316, EarlyStopping counter: 3 out of 300
EPOCH[268/2000] loss-1.133-|Sample:1.76|use_time:19.499959468841553
EPOCH[269/2000] loss-1.136-|Sample:2.04|use_time:19.870325565338135
EPOCH[270/2000] loss-1.137-|Sample:0.95|use_time:18.87259531021118
EPOCH[271/2000] loss-1.137-|Sample:0.95|use_time:19.760353565216064
loss: -1.13671101011881, EarlyStopping counter: 1 out of 300
EPOCH[272/2000] loss-1.137-|Sample:0.97|use_time:18.815035343170166
EPOCH[273/2000] loss-1.137-|Sample:1.97|use_time:19.570252180099487
loss: -1.1369030911748002, EarlyStopping counter: 1 out of 300
EPOCH[274/2000] loss-1.137-|Sample:1.76|use_time:19.64729404449463
EPOCH[275/2000] loss-1.137-|Sample:2.12|use_time:19.37203359603882
loss: -1.1370235536156632, EarlyStopping counter: 1 out of 300
EPOCH[276/2000] loss-1.138-|Sample:0.96|use_time:19.474780559539795
EPOCH[277/2000] loss-1.140-|Sample:0.95|use_time:18.952726364135742
EPOCH[278/2000] loss-1.141-|Sample:2.15|use_time:20.007628917694092
EPOCH[279/2000] loss-1.139-|Sample:1.88|use_time:18.824750423431396
loss: -1.1389700261557973, EarlyStopping counter: 1 out of 300
EPOCH[280/2000] loss-1.139-|Sample:1.77|use_time:19.488276958465576
loss: -1.1391664656197154, EarlyStopping counter: 2 out of 300
EPOCH[281/2000] loss-1.140-|Sample:2.18|use_time:19.823341608047485
loss: -1.1404235246704846, EarlyStopping counter: 3 out of 300
EPOCH[282/2000] loss-1.142-|Sample:1.87|use_time:19.475202083587646
EPOCH[283/2000] loss-1.141-|Sample:1.77|use_time:19.810781002044678
loss: -1.1414319683865803, EarlyStopping counter: 1 out of 300
EPOCH[284/2000] loss-1.143-|Sample:2.09|use_time:19.44340443611145
EPOCH[285/2000] loss-1.142-|Sample:0.96|use_time:19.68341898918152
loss: -1.1422847858289393, EarlyStopping counter: 1 out of 300
EPOCH[286/2000] loss-1.143-|Sample:0.96|use_time:18.977307558059692
loss: -1.143256632293143, EarlyStopping counter: 2 out of 300
EPOCH[287/2000] loss-1.143-|Sample:2.12|use_time:20.016362190246582
loss: -1.1426599287405246, EarlyStopping counter: 3 out of 300
EPOCH[288/2000] loss-1.144-|Sample:1.77|use_time:18.78208827972412
EPOCH[289/2000] loss-1.146-|Sample:1.91|use_time:19.773982286453247
EPOCH[290/2000] loss-1.146-|Sample:0.95|use_time:19.704917430877686
EPOCH[291/2000] loss-1.143-|Sample:0.95|use_time:19.666016340255737
loss: -1.142602603609969, EarlyStopping counter: 1 out of 300
EPOCH[292/2000] loss-1.145-|Sample:0.96|use_time:18.87449884414673
loss: -1.1445285895975625, EarlyStopping counter: 2 out of 300
EPOCH[293/2000] loss-1.144-|Sample:2.12|use_time:19.19857382774353
loss: -1.1444937833925573, EarlyStopping counter: 3 out of 300
EPOCH[294/2000] loss-1.147-|Sample:1.76|use_time:19.705591201782227
EPOCH[295/2000] loss-1.146-|Sample:1.99|use_time:19.995935916900635
loss: -1.1463827098288186, EarlyStopping counter: 1 out of 300
EPOCH[296/2000] loss-1.148-|Sample:0.96|use_time:19.84025478363037
EPOCH[297/2000] loss-1.146-|Sample:0.96|use_time:18.91456627845764
loss: -1.1459782501546347, EarlyStopping counter: 1 out of 300
EPOCH[298/2000] loss-1.147-|Sample:0.96|use_time:18.856757402420044
loss: -1.1472889795535948, EarlyStopping counter: 2 out of 300
EPOCH[299/2000] loss-1.150-|Sample:2.03|use_time:19.763246297836304
EPOCH[300/2000] loss-1.149-|Sample:1.75|use_time:19.66668200492859
loss: -1.1492248802650264, EarlyStopping counter: 1 out of 300
[TEST]
{'precision': array([0.02438202, 0.01810237, 0.01151311]), 'recall': array([0.10640777, 0.15443424, 0.23779544]), 'ndcg': array([0.07084244, 0.08545219, 0.10621777]), 'coverage': array([23.94843945, 28.05168539, 32.46691635]), 'Acoverage': array([ 470.94469413,  723.93882647, 1232.03682896]), 'ILD': array([0.72968789, 0.74973651, 0.77717353]), 'F1': array([0.18573105, 0.2561131 , 0.36416547])}
test time: 69.46458125114441
reg_loss2: tensor(0.0400, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2320, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2473, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[301/2000] loss-1.151-|Sample:2.36|use_time:20.417794704437256
EPOCH[302/2000] loss-1.150-|Sample:0.96|use_time:19.58916163444519
loss: -1.1502268227135264, EarlyStopping counter: 1 out of 300
EPOCH[303/2000] loss-1.150-|Sample:0.95|use_time:18.631340265274048
loss: -1.1501477171735066, EarlyStopping counter: 2 out of 300
EPOCH[304/2000] loss-1.150-|Sample:1.82|use_time:19.7434401512146
loss: -1.1504058663438006, EarlyStopping counter: 3 out of 300
EPOCH[305/2000] loss-1.151-|Sample:2.07|use_time:19.833192586898804
loss: -1.1509183965078214, EarlyStopping counter: 4 out of 300
EPOCH[306/2000] loss-1.150-|Sample:0.96|use_time:18.784334421157837
loss: -1.1503407838867932, EarlyStopping counter: 5 out of 300
EPOCH[307/2000] loss-1.153-|Sample:0.96|use_time:19.941706895828247
EPOCH[308/2000] loss-1.155-|Sample:0.95|use_time:18.770678997039795
EPOCH[309/2000] loss-1.152-|Sample:1.84|use_time:20.508885622024536
loss: -1.152398490324253, EarlyStopping counter: 1 out of 300
EPOCH[310/2000] loss-1.155-|Sample:0.96|use_time:18.819839000701904
EPOCH[311/2000] loss-1.152-|Sample:2.15|use_time:19.279949426651
loss: -1.152276196130892, EarlyStopping counter: 1 out of 300
EPOCH[312/2000] loss-1.156-|Sample:1.74|use_time:19.49786925315857
EPOCH[313/2000] loss-1.155-|Sample:0.96|use_time:19.955663919448853
loss: -1.1551338695898288, EarlyStopping counter: 1 out of 300
EPOCH[314/2000] loss-1.156-|Sample:0.95|use_time:19.755603790283203
loss: -1.1555011301505855, EarlyStopping counter: 2 out of 300
EPOCH[315/2000] loss-1.154-|Sample:0.95|use_time:18.648844480514526
loss: -1.1544958062288238, EarlyStopping counter: 3 out of 300
EPOCH[316/2000] loss-1.156-|Sample:1.98|use_time:19.629297494888306
EPOCH[317/2000] loss-1.155-|Sample:2.02|use_time:19.57828426361084
loss: -1.155042438972287, EarlyStopping counter: 1 out of 300
EPOCH[318/2000] loss-1.156-|Sample:0.96|use_time:19.477509260177612
loss: -1.1562149321160666, EarlyStopping counter: 2 out of 300
EPOCH[319/2000] loss-1.158-|Sample:0.96|use_time:19.839367866516113
EPOCH[320/2000] loss-1.159-|Sample:0.97|use_time:18.552407264709473
EPOCH[321/2000] loss-1.157-|Sample:1.74|use_time:18.734851360321045
loss: -1.1574071471284075, EarlyStopping counter: 1 out of 300
EPOCH[322/2000] loss-1.156-|Sample:2.07|use_time:19.00801396369934
loss: -1.1560679441545068, EarlyStopping counter: 2 out of 300
EPOCH[323/2000] loss-1.160-|Sample:1.91|use_time:18.740846633911133
EPOCH[324/2000] loss-1.160-|Sample:0.95|use_time:18.809869289398193
EPOCH[325/2000] loss-1.158-|Sample:0.96|use_time:19.562920331954956
loss: -1.1582719087600708, EarlyStopping counter: 1 out of 300
EPOCH[326/2000] loss-1.158-|Sample:0.95|use_time:18.700106859207153
loss: -1.1581231239365368, EarlyStopping counter: 2 out of 300
EPOCH[327/2000] loss-1.159-|Sample:1.75|use_time:19.683846473693848
loss: -1.1585789715371482, EarlyStopping counter: 3 out of 300
EPOCH[328/2000] loss-1.159-|Sample:2.18|use_time:19.905792236328125
loss: -1.1594312074707775, EarlyStopping counter: 4 out of 300
EPOCH[329/2000] loss-1.160-|Sample:1.89|use_time:18.8582706451416
EPOCH[330/2000] loss-1.159-|Sample:0.95|use_time:19.94391131401062
loss: -1.1588402666696689, EarlyStopping counter: 1 out of 300
EPOCH[331/2000] loss-1.160-|Sample:0.96|use_time:18.835628747940063
loss: -1.1596516428924188, EarlyStopping counter: 2 out of 300
EPOCH[332/2000] loss-1.160-|Sample:1.89|use_time:19.532241821289062
EPOCH[333/2000] loss-1.163-|Sample:1.77|use_time:19.550588607788086
EPOCH[334/2000] loss-1.164-|Sample:2.19|use_time:19.464650630950928
EPOCH[335/2000] loss-1.163-|Sample:1.86|use_time:19.546080112457275
loss: -1.1629308985500801, EarlyStopping counter: 1 out of 300
EPOCH[336/2000] loss-1.162-|Sample:1.80|use_time:19.604040145874023
loss: -1.1616709871989925, EarlyStopping counter: 2 out of 300
EPOCH[337/2000] loss-1.163-|Sample:2.15|use_time:19.870906114578247
loss: -1.1633507652980526, EarlyStopping counter: 3 out of 300
EPOCH[338/2000] loss-1.164-|Sample:1.76|use_time:18.822920083999634
loss: -1.16374859577272, EarlyStopping counter: 4 out of 300
EPOCH[339/2000] loss-1.165-|Sample:0.96|use_time:20.02352285385132
EPOCH[340/2000] loss-1.164-|Sample:0.95|use_time:18.778767824172974
loss: -1.1638486588873513, EarlyStopping counter: 1 out of 300
EPOCH[341/2000] loss-1.165-|Sample:1.75|use_time:19.612205028533936
EPOCH[342/2000] loss-1.165-|Sample:1.96|use_time:19.726080656051636
EPOCH[343/2000] loss-1.165-|Sample:1.98|use_time:18.99681282043457
EPOCH[344/2000] loss-1.164-|Sample:0.96|use_time:19.472156286239624
loss: -1.1644281148910522, EarlyStopping counter: 1 out of 300
EPOCH[345/2000] loss-1.165-|Sample:0.96|use_time:20.060043811798096
EPOCH[346/2000] loss-1.165-|Sample:0.95|use_time:18.844499588012695
loss: -1.1648972645038511, EarlyStopping counter: 1 out of 300
EPOCH[347/2000] loss-1.164-|Sample:1.74|use_time:18.785996437072754
loss: -1.1640408446149129, EarlyStopping counter: 2 out of 300
EPOCH[348/2000] loss-1.167-|Sample:2.08|use_time:19.99284338951111
EPOCH[349/2000] loss-1.165-|Sample:1.93|use_time:19.7573139667511
loss: -1.1651962646623937, EarlyStopping counter: 1 out of 300
EPOCH[350/2000] loss-1.165-|Sample:0.96|use_time:19.769416332244873
loss: -1.1651785344612309, EarlyStopping counter: 2 out of 300
[TEST]
{'precision': array([0.02474407, 0.01851436, 0.01164045]), 'recall': array([0.10691331, 0.15653317, 0.24046605]), 'ndcg': array([0.07160042, 0.08669174, 0.1075643 ]), 'coverage': array([23.77403246, 28.02696629, 32.52858926]), 'Acoverage': array([ 471.90124844,  727.22846442, 1233.48164794]), 'ILD': array([0.72678319, 0.74840134, 0.77565727]), 'F1': array([0.18640548, 0.25891295, 0.3671193 ])}
test time: 69.74738883972168
reg_loss2: tensor(0.0324, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2237, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2287, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[351/2000] loss-1.168-|Sample:0.95|use_time:20.191355228424072
EPOCH[352/2000] loss-1.168-|Sample:0.97|use_time:18.07299518585205
loss: -1.1677322998279478, EarlyStopping counter: 1 out of 300
EPOCH[353/2000] loss-1.167-|Sample:1.85|use_time:19.74507427215576
loss: -1.1670433166550427, EarlyStopping counter: 2 out of 300
EPOCH[354/2000] loss-1.169-|Sample:2.15|use_time:19.99977421760559
EPOCH[355/2000] loss-1.168-|Sample:1.75|use_time:19.62673854827881
loss: -1.16812218689337, EarlyStopping counter: 1 out of 300
EPOCH[356/2000] loss-1.169-|Sample:1.93|use_time:18.965288162231445
loss: -1.1690989267535326, EarlyStopping counter: 2 out of 300
EPOCH[357/2000] loss-1.169-|Sample:2.07|use_time:19.87621283531189
loss: -1.1687274851450107, EarlyStopping counter: 3 out of 300
EPOCH[358/2000] loss-1.167-|Sample:1.76|use_time:19.494049072265625
loss: -1.1665153067286422, EarlyStopping counter: 4 out of 300
EPOCH[359/2000] loss-1.168-|Sample:0.95|use_time:20.073421239852905
loss: -1.1683366327750973, EarlyStopping counter: 5 out of 300
EPOCH[360/2000] loss-1.169-|Sample:0.96|use_time:19.791172742843628
loss: -1.1686983777255546, EarlyStopping counter: 6 out of 300
EPOCH[361/2000] loss-1.169-|Sample:0.96|use_time:18.434112071990967
EPOCH[362/2000] loss-1.168-|Sample:2.04|use_time:20.00571298599243
loss: -1.1678013074688796, EarlyStopping counter: 1 out of 300
EPOCH[363/2000] loss-1.169-|Sample:1.97|use_time:19.833672285079956
loss: -1.1692052469020937, EarlyStopping counter: 2 out of 300
EPOCH[364/2000] loss-1.170-|Sample:1.76|use_time:19.741421937942505
EPOCH[365/2000] loss-1.168-|Sample:0.96|use_time:19.288111686706543
loss: -1.1678183747500908, EarlyStopping counter: 1 out of 300
EPOCH[366/2000] loss-1.167-|Sample:0.95|use_time:19.631598711013794
loss: -1.1673081909737937, EarlyStopping counter: 2 out of 300
EPOCH[367/2000] loss-1.172-|Sample:0.95|use_time:18.89661979675293
EPOCH[368/2000] loss-1.171-|Sample:2.18|use_time:19.8756320476532
loss: -1.1713746844268427, EarlyStopping counter: 1 out of 300
EPOCH[369/2000] loss-1.172-|Sample:1.89|use_time:19.737589120864868
EPOCH[370/2000] loss-1.171-|Sample:1.77|use_time:19.465657234191895
loss: -1.1708200588458921, EarlyStopping counter: 1 out of 300
EPOCH[371/2000] loss-1.171-|Sample:0.96|use_time:20.05731201171875
loss: -1.1712583158074357, EarlyStopping counter: 2 out of 300
EPOCH[372/2000] loss-1.170-|Sample:0.96|use_time:19.640190601348877
loss: -1.1700346586180896, EarlyStopping counter: 3 out of 300
EPOCH[373/2000] loss-1.172-|Sample:0.95|use_time:18.853044986724854
loss: -1.1719201425226724, EarlyStopping counter: 4 out of 300
EPOCH[374/2000] loss-1.172-|Sample:2.09|use_time:19.12843656539917
loss: -1.1717295530365734, EarlyStopping counter: 5 out of 300
EPOCH[375/2000] loss-1.172-|Sample:1.79|use_time:19.64284873008728
EPOCH[376/2000] loss-1.173-|Sample:1.88|use_time:20.00063157081604
EPOCH[377/2000] loss-1.171-|Sample:0.96|use_time:19.917065858840942
loss: -1.1709551142483223, EarlyStopping counter: 1 out of 300
EPOCH[378/2000] loss-1.174-|Sample:0.97|use_time:18.83391761779785
EPOCH[379/2000] loss-1.173-|Sample:1.98|use_time:19.10363006591797
loss: -1.1725331661177845, EarlyStopping counter: 1 out of 300
EPOCH[380/2000] loss-1.172-|Sample:2.06|use_time:19.876652479171753
loss: -1.1715489422402732, EarlyStopping counter: 2 out of 300
EPOCH[381/2000] loss-1.173-|Sample:1.76|use_time:19.449331283569336
loss: -1.1725161976930571, EarlyStopping counter: 3 out of 300
EPOCH[382/2000] loss-1.171-|Sample:2.01|use_time:19.722477674484253
loss: -1.1710906057822994, EarlyStopping counter: 4 out of 300
EPOCH[383/2000] loss-1.173-|Sample:2.04|use_time:18.95671796798706
loss: -1.1733893446806, EarlyStopping counter: 5 out of 300
EPOCH[384/2000] loss-1.173-|Sample:1.75|use_time:19.726435661315918
loss: -1.172691383012911, EarlyStopping counter: 6 out of 300
EPOCH[385/2000] loss-1.173-|Sample:2.07|use_time:20.0099618434906
loss: -1.172694206237793, EarlyStopping counter: 7 out of 300
EPOCH[386/2000] loss-1.176-|Sample:0.96|use_time:19.675343990325928
EPOCH[387/2000] loss-1.174-|Sample:0.95|use_time:18.853174448013306
loss: -1.17380900208543, EarlyStopping counter: 1 out of 300
EPOCH[388/2000] loss-1.173-|Sample:2.10|use_time:19.44140076637268
loss: -1.1726150832525113, EarlyStopping counter: 2 out of 300
EPOCH[389/2000] loss-1.176-|Sample:1.88|use_time:19.689256191253662
loss: -1.1755450934898564, EarlyStopping counter: 3 out of 300
EPOCH[390/2000] loss-1.175-|Sample:1.76|use_time:19.77825379371643
loss: -1.17456927532103, EarlyStopping counter: 4 out of 300
EPOCH[391/2000] loss-1.174-|Sample:0.97|use_time:20.09493589401245
loss: -1.1739774855171763, EarlyStopping counter: 5 out of 300
EPOCH[392/2000] loss-1.174-|Sample:0.95|use_time:18.75285768508911
loss: -1.1741611085286954, EarlyStopping counter: 6 out of 300
EPOCH[393/2000] loss-1.173-|Sample:0.96|use_time:18.70997428894043
loss: -1.1733504097636154, EarlyStopping counter: 7 out of 300
EPOCH[394/2000] loss-1.175-|Sample:2.20|use_time:19.872166395187378
loss: -1.1748511994757302, EarlyStopping counter: 8 out of 300
EPOCH[395/2000] loss-1.179-|Sample:1.88|use_time:19.682462692260742
EPOCH[396/2000] loss-1.176-|Sample:1.76|use_time:19.84729790687561
loss: -1.1755006545927467, EarlyStopping counter: 1 out of 300
EPOCH[397/2000] loss-1.176-|Sample:0.97|use_time:19.438772201538086
loss: -1.1758038706895781, EarlyStopping counter: 2 out of 300
EPOCH[398/2000] loss-1.177-|Sample:0.96|use_time:19.59308099746704
loss: -1.1769609015162399, EarlyStopping counter: 3 out of 300
EPOCH[399/2000] loss-1.177-|Sample:0.97|use_time:18.99570369720459
loss: -1.1769182245905807, EarlyStopping counter: 4 out of 300
EPOCH[400/2000] loss-1.177-|Sample:2.13|use_time:20.07015562057495
loss: -1.1767900920495755, EarlyStopping counter: 5 out of 300
[TEST]
{'precision': array([0.02479401, 0.01872035, 0.01185019]), 'recall': array([0.10777362, 0.15974823, 0.24559941]), 'ndcg': array([0.07203484, 0.08776226, 0.10908907]), 'coverage': array([23.62259675, 28.06404494, 32.60399501]), 'Acoverage': array([ 469.12846442,  725.49675406, 1236.58027466]), 'ILD': array([0.72560965, 0.74820488, 0.77579199]), 'F1': array([0.18767255, 0.26328321, 0.37308725])}
test time: 69.70989441871643
reg_loss2: tensor(0.0273, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2022, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2348, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[401/2000] loss-1.177-|Sample:2.35|use_time:19.453259468078613
loss: -1.1768528164886847, EarlyStopping counter: 6 out of 300
EPOCH[402/2000] loss-1.179-|Sample:0.95|use_time:19.5604989528656
loss: -1.1786016661946366, EarlyStopping counter: 7 out of 300
EPOCH[403/2000] loss-1.179-|Sample:0.96|use_time:18.68026065826416
EPOCH[404/2000] loss-1.177-|Sample:2.14|use_time:20.903524160385132
loss: -1.1771506158317007, EarlyStopping counter: 1 out of 300
EPOCH[405/2000] loss-1.178-|Sample:0.96|use_time:18.62756037712097
loss: -1.178365631801326, EarlyStopping counter: 2 out of 300
EPOCH[406/2000] loss-1.178-|Sample:1.76|use_time:18.850708723068237
loss: -1.1777046337360288, EarlyStopping counter: 3 out of 300
EPOCH[407/2000] loss-1.179-|Sample:2.14|use_time:20.092743158340454
loss: -1.1790483463101271, EarlyStopping counter: 4 out of 300
EPOCH[408/2000] loss-1.179-|Sample:1.88|use_time:19.726280212402344
loss: -1.17899609775078, EarlyStopping counter: 5 out of 300
EPOCH[409/2000] loss-1.178-|Sample:1.76|use_time:19.563045263290405
loss: -1.1781924962997437, EarlyStopping counter: 6 out of 300
EPOCH[410/2000] loss-1.179-|Sample:2.19|use_time:19.177370309829712
loss: -1.17863482091485, EarlyStopping counter: 7 out of 300
EPOCH[411/2000] loss-1.179-|Sample:1.83|use_time:19.540066242218018
EPOCH[412/2000] loss-1.179-|Sample:1.77|use_time:19.929394721984863
loss: -1.1790226872374372, EarlyStopping counter: 1 out of 300
EPOCH[413/2000] loss-1.179-|Sample:0.95|use_time:19.91605019569397
loss: -1.1788459405666445, EarlyStopping counter: 2 out of 300
EPOCH[414/2000] loss-1.177-|Sample:0.95|use_time:18.629013538360596
loss: -1.1772712759855317, EarlyStopping counter: 3 out of 300
EPOCH[415/2000] loss-1.179-|Sample:1.79|use_time:19.109885454177856
loss: -1.1792548138920853, EarlyStopping counter: 4 out of 300
EPOCH[416/2000] loss-1.180-|Sample:2.10|use_time:20.035938501358032
EPOCH[417/2000] loss-1.181-|Sample:1.78|use_time:19.64528727531433
EPOCH[418/2000] loss-1.180-|Sample:0.97|use_time:20.04932713508606
loss: -1.1797741796912216, EarlyStopping counter: 1 out of 300
EPOCH[419/2000] loss-1.180-|Sample:0.96|use_time:19.019969940185547
loss: -1.1797911539310362, EarlyStopping counter: 2 out of 300
EPOCH[420/2000] loss-1.178-|Sample:0.97|use_time:18.871059894561768
loss: -1.177506653273978, EarlyStopping counter: 3 out of 300
EPOCH[421/2000] loss-1.180-|Sample:1.92|use_time:19.860944271087646
loss: -1.1804024678904836, EarlyStopping counter: 4 out of 300
EPOCH[422/2000] loss-1.178-|Sample:2.09|use_time:19.976920127868652
loss: -1.1778608066279714, EarlyStopping counter: 5 out of 300
EPOCH[423/2000] loss-1.180-|Sample:1.76|use_time:19.71247410774231
loss: -1.180204911929805, EarlyStopping counter: 6 out of 300
EPOCH[424/2000] loss-1.179-|Sample:0.95|use_time:19.60738778114319
loss: -1.1786517718943155, EarlyStopping counter: 7 out of 300
EPOCH[425/2000] loss-1.180-|Sample:0.96|use_time:18.823394775390625
loss: -1.1798051101405447, EarlyStopping counter: 8 out of 300
EPOCH[426/2000] loss-1.179-|Sample:1.76|use_time:19.749526262283325
loss: -1.1787599470557235, EarlyStopping counter: 9 out of 300
EPOCH[427/2000] loss-1.181-|Sample:2.06|use_time:20.006709098815918
loss: -1.180514856082637, EarlyStopping counter: 10 out of 300
EPOCH[428/2000] loss-1.181-|Sample:1.96|use_time:18.99363422393799
loss: -1.1805965609666778, EarlyStopping counter: 11 out of 300
EPOCH[429/2000] loss-1.182-|Sample:1.77|use_time:19.535316705703735
EPOCH[430/2000] loss-1.181-|Sample:2.16|use_time:19.953470468521118
loss: -1.1812020685614608, EarlyStopping counter: 1 out of 300
EPOCH[431/2000] loss-1.182-|Sample:1.89|use_time:19.611302614212036
EPOCH[432/2000] loss-1.181-|Sample:1.78|use_time:19.884344816207886
loss: -1.1807960242759892, EarlyStopping counter: 1 out of 300
EPOCH[433/2000] loss-1.182-|Sample:0.96|use_time:19.544840812683105
EPOCH[434/2000] loss-1.181-|Sample:0.95|use_time:18.837292432785034
loss: -1.1813133431643974, EarlyStopping counter: 1 out of 300
EPOCH[435/2000] loss-1.180-|Sample:1.77|use_time:19.82599973678589
loss: -1.1802549798314164, EarlyStopping counter: 2 out of 300
EPOCH[436/2000] loss-1.181-|Sample:2.16|use_time:20.054701566696167
loss: -1.1814188462931936, EarlyStopping counter: 3 out of 300
EPOCH[437/2000] loss-1.182-|Sample:1.86|use_time:18.866917610168457
loss: -1.1815055957654628, EarlyStopping counter: 4 out of 300
EPOCH[438/2000] loss-1.179-|Sample:0.97|use_time:20.070789575576782
loss: -1.179474025237851, EarlyStopping counter: 5 out of 300
EPOCH[439/2000] loss-1.182-|Sample:0.95|use_time:20.01668357849121
EPOCH[440/2000] loss-1.183-|Sample:0.97|use_time:18.666544675827026
EPOCH[441/2000] loss-1.182-|Sample:1.89|use_time:19.87688159942627
loss: -1.1822162546762607, EarlyStopping counter: 1 out of 300
EPOCH[442/2000] loss-1.183-|Sample:2.16|use_time:19.398391008377075
loss: -1.1832409690066081, EarlyStopping counter: 2 out of 300
EPOCH[443/2000] loss-1.182-|Sample:1.77|use_time:19.527820825576782
loss: -1.1822871987412615, EarlyStopping counter: 3 out of 300
EPOCH[444/2000] loss-1.182-|Sample:0.96|use_time:19.932926416397095
loss: -1.182226192660448, EarlyStopping counter: 4 out of 300
EPOCH[445/2000] loss-1.182-|Sample:0.96|use_time:19.685380935668945
loss: -1.1821691524691698, EarlyStopping counter: 5 out of 300
EPOCH[446/2000] loss-1.184-|Sample:0.95|use_time:18.03174901008606
EPOCH[447/2000] loss-1.184-|Sample:1.96|use_time:19.763680458068848
EPOCH[448/2000] loss-1.183-|Sample:2.04|use_time:19.702675104141235
loss: -1.1825227155918028, EarlyStopping counter: 1 out of 300
EPOCH[449/2000] loss-1.185-|Sample:1.78|use_time:19.60370969772339
EPOCH[450/2000] loss-1.183-|Sample:0.96|use_time:20.005049467086792
loss: -1.1834652714613008, EarlyStopping counter: 1 out of 300
[TEST]
{'precision': array([0.02510612, 0.01887016, 0.01194007]), 'recall': array([0.10968173, 0.1591258 , 0.24728564]), 'ndcg': array([0.07314172, 0.08835337, 0.11009629]), 'coverage': array([23.65930087, 28.11310861, 32.743196  ]), 'Acoverage': array([ 469.98014981,  728.7463171 , 1248.71735331]), 'ILD': array([0.72097101, 0.74386096, 0.77306235]), 'F1': array([0.19039809, 0.26216878, 0.37470984])}
test time: 69.54790353775024
reg_loss2: tensor(0.0237, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2241, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2198, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[451/2000] loss-1.185-|Sample:0.96|use_time:19.30398154258728
loss: -1.1848357915878296, EarlyStopping counter: 2 out of 300
EPOCH[452/2000] loss-1.183-|Sample:2.20|use_time:19.465155839920044
loss: -1.18296476980535, EarlyStopping counter: 3 out of 300
EPOCH[453/2000] loss-1.183-|Sample:1.87|use_time:20.402158737182617
loss: -1.1830942107409965, EarlyStopping counter: 4 out of 300
EPOCH[454/2000] loss-1.186-|Sample:0.98|use_time:19.021060943603516
EPOCH[455/2000] loss-1.186-|Sample:2.13|use_time:19.979128122329712
loss: -1.1856131350121848, EarlyStopping counter: 1 out of 300
EPOCH[456/2000] loss-1.186-|Sample:1.83|use_time:18.91768741607666
EPOCH[457/2000] loss-1.184-|Sample:1.80|use_time:19.786702394485474
loss: -1.183851718902588, EarlyStopping counter: 1 out of 300
EPOCH[458/2000] loss-1.185-|Sample:0.97|use_time:19.87665367126465
loss: -1.1847628122422753, EarlyStopping counter: 2 out of 300
EPOCH[459/2000] loss-1.185-|Sample:0.95|use_time:18.648416757583618
loss: -1.1852853414489002, EarlyStopping counter: 3 out of 300
EPOCH[460/2000] loss-1.185-|Sample:1.93|use_time:19.831888914108276
loss: -1.1851103509344705, EarlyStopping counter: 4 out of 300
EPOCH[461/2000] loss-1.182-|Sample:2.13|use_time:19.146402835845947
loss: -1.1822352060457555, EarlyStopping counter: 5 out of 300
EPOCH[462/2000] loss-1.185-|Sample:1.77|use_time:19.689834117889404
loss: -1.1853379447285721, EarlyStopping counter: 6 out of 300
EPOCH[463/2000] loss-1.183-|Sample:1.99|use_time:19.92259955406189
loss: -1.1829081599305316, EarlyStopping counter: 7 out of 300
EPOCH[464/2000] loss-1.186-|Sample:2.05|use_time:19.96246862411499
loss: -1.1857561745294711, EarlyStopping counter: 8 out of 300
EPOCH[465/2000] loss-1.185-|Sample:1.77|use_time:18.854376077651978
loss: -1.1845935583114624, EarlyStopping counter: 9 out of 300
EPOCH[466/2000] loss-1.185-|Sample:2.01|use_time:19.966742992401123
loss: -1.184604179568407, EarlyStopping counter: 10 out of 300
EPOCH[467/2000] loss-1.184-|Sample:0.97|use_time:19.841376066207886
loss: -1.1838167644128568, EarlyStopping counter: 11 out of 300
EPOCH[468/2000] loss-1.186-|Sample:0.97|use_time:18.73013472557068
EPOCH[469/2000] loss-1.186-|Sample:2.02|use_time:19.81389570236206
EPOCH[470/2000] loss-1.186-|Sample:1.99|use_time:19.071123600006104
loss: -1.1857346296310425, EarlyStopping counter: 1 out of 300
EPOCH[471/2000] loss-1.188-|Sample:1.77|use_time:19.561025142669678
EPOCH[472/2000] loss-1.185-|Sample:0.96|use_time:20.189414024353027
loss: -1.1848670738499338, EarlyStopping counter: 1 out of 300
EPOCH[473/2000] loss-1.187-|Sample:0.95|use_time:19.659613847732544
loss: -1.1866115738705891, EarlyStopping counter: 2 out of 300
EPOCH[474/2000] loss-1.185-|Sample:0.95|use_time:18.098200798034668
loss: -1.1853214327881976, EarlyStopping counter: 3 out of 300
EPOCH[475/2000] loss-1.186-|Sample:2.13|use_time:20.076682090759277
loss: -1.1864895936919422, EarlyStopping counter: 4 out of 300
EPOCH[476/2000] loss-1.186-|Sample:1.91|use_time:19.79599905014038
loss: -1.1864389530042323, EarlyStopping counter: 5 out of 300
EPOCH[477/2000] loss-1.185-|Sample:1.77|use_time:19.85939621925354
loss: -1.184953064453311, EarlyStopping counter: 6 out of 300
EPOCH[478/2000] loss-1.189-|Sample:0.98|use_time:20.179144859313965
EPOCH[479/2000] loss-1.186-|Sample:0.95|use_time:19.154720067977905
loss: -1.185882841668478, EarlyStopping counter: 1 out of 300
EPOCH[480/2000] loss-1.188-|Sample:0.97|use_time:18.830440759658813
loss: -1.1877508861262625, EarlyStopping counter: 2 out of 300
EPOCH[481/2000] loss-1.186-|Sample:2.15|use_time:19.861613273620605
loss: -1.1858974317225015, EarlyStopping counter: 3 out of 300
EPOCH[482/2000] loss-1.187-|Sample:1.84|use_time:19.75964331626892
loss: -1.1871183093001203, EarlyStopping counter: 4 out of 300
EPOCH[483/2000] loss-1.187-|Sample:1.81|use_time:19.09132957458496
loss: -1.1866472610613195, EarlyStopping counter: 5 out of 300
EPOCH[484/2000] loss-1.186-|Sample:0.96|use_time:20.087308883666992
loss: -1.1859613686073116, EarlyStopping counter: 6 out of 300
EPOCH[485/2000] loss-1.187-|Sample:0.95|use_time:18.70797061920166
loss: -1.186698425106886, EarlyStopping counter: 7 out of 300
EPOCH[486/2000] loss-1.186-|Sample:1.82|use_time:19.877595901489258
loss: -1.186277712263712, EarlyStopping counter: 8 out of 300
EPOCH[487/2000] loss-1.188-|Sample:2.17|use_time:19.902998685836792
loss: -1.1881721514027292, EarlyStopping counter: 9 out of 300
EPOCH[488/2000] loss-1.187-|Sample:1.87|use_time:19.143202543258667
loss: -1.186858857550272, EarlyStopping counter: 10 out of 300
EPOCH[489/2000] loss-1.189-|Sample:1.87|use_time:19.902541160583496
loss: -1.1888085167582443, EarlyStopping counter: 11 out of 300
EPOCH[490/2000] loss-1.187-|Sample:2.17|use_time:20.103526830673218
loss: -1.1866157142127431, EarlyStopping counter: 12 out of 300
EPOCH[491/2000] loss-1.185-|Sample:1.75|use_time:19.72092580795288
loss: -1.1849488892206332, EarlyStopping counter: 13 out of 300
EPOCH[492/2000] loss-1.190-|Sample:2.01|use_time:19.27877116203308
EPOCH[493/2000] loss-1.187-|Sample:0.96|use_time:19.629101037979126
loss: -1.1873914148749374, EarlyStopping counter: 1 out of 300
EPOCH[494/2000] loss-1.190-|Sample:0.96|use_time:18.940383672714233
EPOCH[495/2000] loss-1.187-|Sample:2.03|use_time:20.04693579673767
loss: -1.1867364296099034, EarlyStopping counter: 1 out of 300
EPOCH[496/2000] loss-1.189-|Sample:1.97|use_time:19.80532217025757
loss: -1.1885999092241613, EarlyStopping counter: 2 out of 300
EPOCH[497/2000] loss-1.190-|Sample:1.77|use_time:19.390174627304077
EPOCH[498/2000] loss-1.188-|Sample:0.95|use_time:20.003860473632812
loss: -1.1878113746643066, EarlyStopping counter: 1 out of 300
EPOCH[499/2000] loss-1.188-|Sample:0.96|use_time:19.77385115623474
loss: -1.1882516814441215, EarlyStopping counter: 2 out of 300
EPOCH[500/2000] loss-1.186-|Sample:0.97|use_time:18.819642543792725
loss: -1.1860061360568535, EarlyStopping counter: 3 out of 300
[TEST]
{'precision': array([0.02550562, 0.01910737, 0.01207241]), 'recall': array([0.11082204, 0.16055587, 0.25071032]), 'ndcg': array([0.07344566, 0.08873824, 0.11096367]), 'coverage': array([23.70449438, 27.97465668, 32.79937578]), 'Acoverage': array([ 472.16991261,  731.6443196 , 1252.98377029]), 'ILD': array([0.72134831, 0.74388002, 0.7722718 ]), 'F1': array([0.19212722, 0.26410784, 0.37853351])}
test time: 70.17519283294678
reg_loss2: tensor(0.0211, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.1953, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2347, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[501/2000] loss-1.189-|Sample:2.41|use_time:19.515256881713867
loss: -1.18905511716517, EarlyStopping counter: 4 out of 300
EPOCH[502/2000] loss-1.187-|Sample:1.77|use_time:19.805912256240845
loss: -1.186603877602554, EarlyStopping counter: 5 out of 300
EPOCH[503/2000] loss-1.186-|Sample:1.96|use_time:19.886362314224243
loss: -1.1864372811666348, EarlyStopping counter: 6 out of 300
EPOCH[504/2000] loss-1.187-|Sample:2.01|use_time:19.742063522338867
loss: -1.1873683667764432, EarlyStopping counter: 7 out of 300
EPOCH[505/2000] loss-1.186-|Sample:0.95|use_time:19.736579656600952
loss: -1.1863045488915793, EarlyStopping counter: 8 out of 300
EPOCH[506/2000] loss-1.188-|Sample:0.96|use_time:18.531099319458008
loss: -1.1884844041452176, EarlyStopping counter: 9 out of 300
EPOCH[507/2000] loss-1.188-|Sample:2.04|use_time:19.96281623840332
loss: -1.1877348132249785, EarlyStopping counter: 10 out of 300
EPOCH[508/2000] loss-1.188-|Sample:1.77|use_time:19.78179168701172
loss: -1.188223411397236, EarlyStopping counter: 11 out of 300
EPOCH[509/2000] loss-1.187-|Sample:2.09|use_time:19.849364042282104
loss: -1.1869036337224448, EarlyStopping counter: 12 out of 300
EPOCH[510/2000] loss-1.187-|Sample:1.97|use_time:18.954097509384155
loss: -1.187406409077528, EarlyStopping counter: 13 out of 300
EPOCH[511/2000] loss-1.190-|Sample:1.77|use_time:19.73810887336731
loss: -1.1896081116141342, EarlyStopping counter: 14 out of 300
EPOCH[512/2000] loss-1.188-|Sample:2.17|use_time:20.126760244369507
loss: -1.1876617670059204, EarlyStopping counter: 15 out of 300
EPOCH[513/2000] loss-1.191-|Sample:1.85|use_time:19.7693190574646
EPOCH[514/2000] loss-1.189-|Sample:0.96|use_time:19.821752548217773
loss: -1.1888607624100476, EarlyStopping counter: 1 out of 300
EPOCH[515/2000] loss-1.189-|Sample:0.95|use_time:18.640345811843872
loss: -1.1890633571438673, EarlyStopping counter: 2 out of 300
EPOCH[516/2000] loss-1.190-|Sample:1.89|use_time:19.792110681533813
loss: -1.1896581359025908, EarlyStopping counter: 3 out of 300
EPOCH[517/2000] loss-1.190-|Sample:1.77|use_time:19.875539779663086
loss: -1.1896075766261032, EarlyStopping counter: 4 out of 300
EPOCH[518/2000] loss-1.188-|Sample:2.14|use_time:19.939186334609985
loss: -1.1882218093406864, EarlyStopping counter: 5 out of 300
EPOCH[519/2000] loss-1.190-|Sample:0.96|use_time:18.801696300506592
loss: -1.1902130667756243, EarlyStopping counter: 6 out of 300
EPOCH[520/2000] loss-1.189-|Sample:0.95|use_time:20.13169288635254
loss: -1.1894202116059094, EarlyStopping counter: 7 out of 300
EPOCH[521/2000] loss-1.192-|Sample:0.96|use_time:18.875306606292725
EPOCH[522/2000] loss-1.189-|Sample:1.79|use_time:19.58039355278015
loss: -1.188879675981475, EarlyStopping counter: 1 out of 300
EPOCH[523/2000] loss-1.191-|Sample:1.89|use_time:19.762844800949097
loss: -1.19136075857209, EarlyStopping counter: 2 out of 300
EPOCH[524/2000] loss-1.190-|Sample:2.13|use_time:19.52921962738037
loss: -1.1898779810928717, EarlyStopping counter: 3 out of 300
EPOCH[525/2000] loss-1.189-|Sample:0.95|use_time:19.76676297187805
loss: -1.1890255590764487, EarlyStopping counter: 4 out of 300
EPOCH[526/2000] loss-1.188-|Sample:0.95|use_time:20.050710439682007
loss: -1.1879299239414494, EarlyStopping counter: 5 out of 300
EPOCH[527/2000] loss-1.191-|Sample:0.95|use_time:18.67379879951477
loss: -1.1908527496384411, EarlyStopping counter: 6 out of 300
EPOCH[528/2000] loss-1.190-|Sample:1.75|use_time:18.8505380153656
loss: -1.1903677248373263, EarlyStopping counter: 7 out of 300
EPOCH[529/2000] loss-1.190-|Sample:2.04|use_time:20.091946363449097
loss: -1.1900930811719197, EarlyStopping counter: 8 out of 300
EPOCH[530/2000] loss-1.188-|Sample:1.92|use_time:19.837444067001343
loss: -1.1879728974365606, EarlyStopping counter: 9 out of 300
EPOCH[531/2000] loss-1.193-|Sample:0.96|use_time:19.91425395011902
EPOCH[532/2000] loss-1.191-|Sample:0.96|use_time:18.868033170700073
loss: -1.1905737475651066, EarlyStopping counter: 1 out of 300
EPOCH[533/2000] loss-1.189-|Sample:1.94|use_time:19.57843255996704
loss: -1.1892642829476334, EarlyStopping counter: 2 out of 300
EPOCH[534/2000] loss-1.189-|Sample:1.77|use_time:19.51050567626953
loss: -1.188851048306721, EarlyStopping counter: 3 out of 300
EPOCH[535/2000] loss-1.193-|Sample:2.18|use_time:19.808811902999878
loss: -1.1926525598619042, EarlyStopping counter: 4 out of 300
EPOCH[536/2000] loss-1.190-|Sample:1.88|use_time:19.573707580566406
loss: -1.189696439882604, EarlyStopping counter: 5 out of 300
EPOCH[537/2000] loss-1.188-|Sample:1.80|use_time:19.573514223098755
loss: -1.1875414848327637, EarlyStopping counter: 6 out of 300
EPOCH[538/2000] loss-1.189-|Sample:2.11|use_time:19.883132934570312
loss: -1.188909963863652, EarlyStopping counter: 7 out of 300
EPOCH[539/2000] loss-1.193-|Sample:1.76|use_time:18.671577215194702
loss: -1.1930104668547468, EarlyStopping counter: 8 out of 300
EPOCH[540/2000] loss-1.192-|Sample:0.97|use_time:19.051490545272827
loss: -1.1924089920230028, EarlyStopping counter: 9 out of 300
EPOCH[541/2000] loss-1.192-|Sample:0.95|use_time:18.031429052352905
loss: -1.1920295721147118, EarlyStopping counter: 10 out of 300
EPOCH[542/2000] loss-1.191-|Sample:1.88|use_time:18.821268558502197
loss: -1.1908702123455885, EarlyStopping counter: 11 out of 300
EPOCH[543/2000] loss-1.190-|Sample:1.79|use_time:19.665828943252563
loss: -1.1900849778477738, EarlyStopping counter: 12 out of 300
EPOCH[544/2000] loss-1.192-|Sample:2.11|use_time:19.925082206726074
loss: -1.1917427487489654, EarlyStopping counter: 13 out of 300
EPOCH[545/2000] loss-1.190-|Sample:0.95|use_time:19.50915765762329
loss: -1.1898707413091891, EarlyStopping counter: 14 out of 300
EPOCH[546/2000] loss-1.191-|Sample:0.96|use_time:20.037391185760498
loss: -1.1906663789981748, EarlyStopping counter: 15 out of 300
EPOCH[547/2000] loss-1.191-|Sample:0.95|use_time:18.196320295333862
loss: -1.1910435688204881, EarlyStopping counter: 16 out of 300
EPOCH[548/2000] loss-1.192-|Sample:1.80|use_time:19.60788059234619
loss: -1.1918074270574057, EarlyStopping counter: 17 out of 300
EPOCH[549/2000] loss-1.189-|Sample:1.94|use_time:19.801077604293823
loss: -1.1893266933720286, EarlyStopping counter: 18 out of 300
EPOCH[550/2000] loss-1.193-|Sample:2.10|use_time:19.851250410079956
loss: -1.1925988168251225, EarlyStopping counter: 19 out of 300
[TEST]
{'precision': array([0.02548065, 0.01950687, 0.01206991]), 'recall': array([0.10923745, 0.16323735, 0.25070215]), 'ndcg': array([0.07316069, 0.08973008, 0.11118801]), 'coverage': array([23.90287141, 28.0803995 , 32.88227216]), 'Acoverage': array([ 475.40411985,  740.11161049, 1265.77166042]), 'ILD': array([0.72210293, 0.74398055, 0.77287523]), 'F1': array([0.18976748, 0.26773152, 0.37859665])}
test time: 70.33250427246094
reg_loss2: tensor(0.0191, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.1950, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2296, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[551/2000] loss-1.189-|Sample:0.96|use_time:19.635480880737305
loss: -1.1894592599170963, EarlyStopping counter: 20 out of 300
EPOCH[552/2000] loss-1.191-|Sample:0.96|use_time:19.78992748260498
loss: -1.1906108361918752, EarlyStopping counter: 21 out of 300
EPOCH[553/2000] loss-1.190-|Sample:0.95|use_time:18.917096853256226
loss: -1.1896604997355764, EarlyStopping counter: 22 out of 300
EPOCH[554/2000] loss-1.191-|Sample:2.12|use_time:19.841537714004517
loss: -1.1906935994218035, EarlyStopping counter: 23 out of 300
EPOCH[555/2000] loss-1.192-|Sample:1.76|use_time:19.577227115631104
loss: -1.1920572315774314, EarlyStopping counter: 24 out of 300
EPOCH[556/2000] loss-1.194-|Sample:1.95|use_time:19.25783133506775
EPOCH[557/2000] loss-1.192-|Sample:2.13|use_time:20.022666454315186
loss: -1.192384024945701, EarlyStopping counter: 1 out of 300
EPOCH[558/2000] loss-1.192-|Sample:1.77|use_time:19.67637872695923
loss: -1.1924384716080456, EarlyStopping counter: 2 out of 300
EPOCH[559/2000] loss-1.188-|Sample:2.07|use_time:20.17497968673706
loss: -1.1881698399055294, EarlyStopping counter: 3 out of 300
EPOCH[560/2000] loss-1.193-|Sample:0.96|use_time:18.965001106262207
loss: -1.1932891287454745, EarlyStopping counter: 4 out of 300
EPOCH[561/2000] loss-1.191-|Sample:0.96|use_time:19.686206817626953
loss: -1.1908456058036991, EarlyStopping counter: 5 out of 300
EPOCH[562/2000] loss-1.193-|Sample:0.97|use_time:19.113173484802246
loss: -1.1929922016655528, EarlyStopping counter: 6 out of 300
EPOCH[563/2000] loss-1.192-|Sample:2.02|use_time:19.82253861427307
loss: -1.1916355447071354, EarlyStopping counter: 7 out of 300
EPOCH[564/2000] loss-1.192-|Sample:1.78|use_time:19.56310725212097
loss: -1.1923510388630192, EarlyStopping counter: 8 out of 300
EPOCH[565/2000] loss-1.193-|Sample:2.12|use_time:19.598445415496826
loss: -1.1925610071275292, EarlyStopping counter: 9 out of 300
EPOCH[566/2000] loss-1.191-|Sample:0.96|use_time:19.772536516189575
loss: -1.1913130777638132, EarlyStopping counter: 10 out of 300
EPOCH[567/2000] loss-1.192-|Sample:1.31|use_time:22.663065910339355
loss: -1.1919361789052079, EarlyStopping counter: 11 out of 300
EPOCH[568/2000] loss-1.192-|Sample:1.31|use_time:21.44895100593567
loss: -1.1923227222954356, EarlyStopping counter: 12 out of 300
EPOCH[569/2000] loss-1.194-|Sample:2.21|use_time:21.59358859062195
EPOCH[570/2000] loss-1.191-|Sample:2.31|use_time:22.540085077285767
loss: -1.1914786769122612, EarlyStopping counter: 1 out of 300
EPOCH[571/2000] loss-1.192-|Sample:2.42|use_time:22.379844665527344
loss: -1.1918963077591687, EarlyStopping counter: 2 out of 300
EPOCH[572/2000] loss-1.192-|Sample:1.32|use_time:22.400466918945312
loss: -1.1919439362316597, EarlyStopping counter: 3 out of 300
EPOCH[573/2000] loss-1.195-|Sample:1.30|use_time:22.433582067489624
EPOCH[574/2000] loss-1.194-|Sample:1.31|use_time:21.296159744262695
loss: -1.1939537757780494, EarlyStopping counter: 1 out of 300
EPOCH[575/2000] loss-1.194-|Sample:2.25|use_time:22.473095893859863
loss: -1.1936726482903086, EarlyStopping counter: 2 out of 300
EPOCH[576/2000] loss-1.190-|Sample:2.50|use_time:22.613658666610718
loss: -1.1896375359558478, EarlyStopping counter: 3 out of 300
EPOCH[577/2000] loss-1.194-|Sample:2.15|use_time:22.235581636428833
loss: -1.193798550745336, EarlyStopping counter: 4 out of 300
EPOCH[578/2000] loss-1.193-|Sample:1.33|use_time:22.599838495254517
loss: -1.1926725870225487, EarlyStopping counter: 5 out of 300
EPOCH[579/2000] loss-1.192-|Sample:1.31|use_time:21.247971057891846
loss: -1.1917196773901217, EarlyStopping counter: 6 out of 300
EPOCH[580/2000] loss-1.192-|Sample:1.83|use_time:19.87308406829834
loss: -1.191980391013913, EarlyStopping counter: 7 out of 300
EPOCH[581/2000] loss-1.193-|Sample:2.16|use_time:19.19402241706848
loss: -1.193319617248163, EarlyStopping counter: 8 out of 300
EPOCH[582/2000] loss-1.193-|Sample:1.75|use_time:19.48051643371582
loss: -1.1934662708422032, EarlyStopping counter: 9 out of 300
EPOCH[583/2000] loss-1.194-|Sample:1.99|use_time:19.81501793861389
loss: -1.1943578691017338, EarlyStopping counter: 10 out of 300
EPOCH[584/2000] loss-1.191-|Sample:2.04|use_time:19.746619939804077
loss: -1.1912927598488041, EarlyStopping counter: 11 out of 300
EPOCH[585/2000] loss-1.193-|Sample:1.76|use_time:18.892619371414185
loss: -1.1925313472747803, EarlyStopping counter: 12 out of 300
EPOCH[586/2000] loss-1.192-|Sample:2.06|use_time:19.946377515792847
loss: -1.1916128629591407, EarlyStopping counter: 13 out of 300
EPOCH[587/2000] loss-1.196-|Sample:0.96|use_time:19.787190437316895
EPOCH[588/2000] loss-1.194-|Sample:0.96|use_time:18.73188304901123
loss: -1.1938583501955358, EarlyStopping counter: 1 out of 300
EPOCH[589/2000] loss-1.193-|Sample:2.07|use_time:19.828172206878662
loss: -1.1929889771996476, EarlyStopping counter: 2 out of 300
EPOCH[590/2000] loss-1.192-|Sample:1.95|use_time:19.03387427330017
loss: -1.1922519177925297, EarlyStopping counter: 3 out of 300
EPOCH[591/2000] loss-1.193-|Sample:1.77|use_time:19.77759051322937
loss: -1.1934767787049456, EarlyStopping counter: 4 out of 300
EPOCH[592/2000] loss-1.195-|Sample:0.96|use_time:20.13198232650757
loss: -1.1950076963843368, EarlyStopping counter: 5 out of 300
EPOCH[593/2000] loss-1.192-|Sample:0.95|use_time:19.687503337860107
loss: -1.1917507851996072, EarlyStopping counter: 6 out of 300
EPOCH[594/2000] loss-1.194-|Sample:0.95|use_time:18.095625400543213
loss: -1.1938105908835805, EarlyStopping counter: 7 out of 300
EPOCH[595/2000] loss-1.192-|Sample:2.20|use_time:20.054412841796875
loss: -1.1915883552737352, EarlyStopping counter: 8 out of 300
EPOCH[596/2000] loss-1.197-|Sample:1.89|use_time:19.78072237968445
EPOCH[597/2000] loss-1.192-|Sample:1.75|use_time:19.83088207244873
loss: -1.1921008970679305, EarlyStopping counter: 1 out of 300
EPOCH[598/2000] loss-1.193-|Sample:0.97|use_time:20.057453870773315
loss: -1.1928812468924173, EarlyStopping counter: 2 out of 300
EPOCH[599/2000] loss-1.194-|Sample:0.96|use_time:19.154633283615112
loss: -1.1935869949619944, EarlyStopping counter: 3 out of 300
EPOCH[600/2000] loss-1.194-|Sample:0.96|use_time:18.7892906665802
loss: -1.1940663151624726, EarlyStopping counter: 4 out of 300
[TEST]
{'precision': array([0.02600499, 0.0194382 , 0.01213233]), 'recall': array([0.1114591 , 0.16277144, 0.25193609]), 'ndcg': array([0.07474587, 0.09039307, 0.11235485]), 'coverage': array([24.14044944, 28.14569288, 32.94719101]), 'Acoverage': array([ 478.38077403,  746.18726592, 1281.81972534]), 'ILD': array([0.72150645, 0.743242  , 0.77174063]), 'F1': array([0.19308951, 0.2670569 , 0.37986468])}
test time: 70.21824359893799
reg_loss2: tensor(0.0175, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2171, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2277, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[601/2000] loss-1.196-|Sample:2.34|use_time:20.32603144645691
loss: -1.1956690230020663, EarlyStopping counter: 5 out of 300
EPOCH[602/2000] loss-1.196-|Sample:1.78|use_time:19.75617527961731
loss: -1.196211419454435, EarlyStopping counter: 6 out of 300
EPOCH[603/2000] loss-1.194-|Sample:1.99|use_time:19.030681848526
loss: -1.193806497062125, EarlyStopping counter: 7 out of 300
EPOCH[604/2000] loss-1.193-|Sample:2.06|use_time:19.75143551826477
loss: -1.1932375663664283, EarlyStopping counter: 8 out of 300
EPOCH[605/2000] loss-1.193-|Sample:1.76|use_time:19.56266975402832
loss: -1.1928939179676334, EarlyStopping counter: 9 out of 300
EPOCH[606/2000] loss-1.194-|Sample:2.02|use_time:19.88260555267334
loss: -1.1940453197897933, EarlyStopping counter: 10 out of 300
EPOCH[607/2000] loss-1.194-|Sample:0.95|use_time:19.65742802619934
loss: -1.193777264618292, EarlyStopping counter: 11 out of 300
EPOCH[608/2000] loss-1.196-|Sample:0.95|use_time:19.4149386882782
loss: -1.1963806879229661, EarlyStopping counter: 12 out of 300
EPOCH[609/2000] loss-1.195-|Sample:0.95|use_time:18.875885248184204
loss: -1.1952046970041788, EarlyStopping counter: 13 out of 300
EPOCH[610/2000] loss-1.193-|Sample:1.99|use_time:19.680854558944702
loss: -1.1925233573448368, EarlyStopping counter: 14 out of 300
EPOCH[611/2000] loss-1.193-|Sample:1.76|use_time:19.763622045516968
loss: -1.192689119315729, EarlyStopping counter: 15 out of 300
EPOCH[612/2000] loss-1.195-|Sample:2.19|use_time:19.344558000564575
loss: -1.194623185367119, EarlyStopping counter: 16 out of 300
EPOCH[613/2000] loss-1.196-|Sample:0.95|use_time:19.67853617668152
loss: -1.1955594580347946, EarlyStopping counter: 17 out of 300
EPOCH[614/2000] loss-1.195-|Sample:0.96|use_time:20.053475618362427
loss: -1.1945061509202166, EarlyStopping counter: 18 out of 300
EPOCH[615/2000] loss-1.194-|Sample:0.95|use_time:18.828920602798462
loss: -1.1941444728432633, EarlyStopping counter: 19 out of 300
EPOCH[616/2000] loss-1.193-|Sample:1.83|use_time:19.661383867263794
loss: -1.1933702870113094, EarlyStopping counter: 20 out of 300
EPOCH[617/2000] loss-1.195-|Sample:1.81|use_time:19.165759563446045
loss: -1.1954540799303752, EarlyStopping counter: 21 out of 300
EPOCH[618/2000] loss-1.194-|Sample:2.08|use_time:20.07186269760132
loss: -1.1939747595205539, EarlyStopping counter: 22 out of 300
EPOCH[619/2000] loss-1.193-|Sample:0.95|use_time:19.750548839569092
loss: -1.1931334879340194, EarlyStopping counter: 23 out of 300
EPOCH[620/2000] loss-1.195-|Sample:0.97|use_time:20.158623933792114
loss: -1.1948719955072171, EarlyStopping counter: 24 out of 300
EPOCH[621/2000] loss-1.196-|Sample:0.96|use_time:18.12391996383667
loss: -1.1959059994395187, EarlyStopping counter: 25 out of 300
EPOCH[622/2000] loss-1.193-|Sample:1.75|use_time:19.691439390182495
loss: -1.1933077195795572, EarlyStopping counter: 26 out of 300
EPOCH[623/2000] loss-1.195-|Sample:1.94|use_time:19.874627828598022
loss: -1.194824986341523, EarlyStopping counter: 27 out of 300
EPOCH[624/2000] loss-1.194-|Sample:2.02|use_time:19.858105897903442
loss: -1.1943358560887778, EarlyStopping counter: 28 out of 300
EPOCH[625/2000] loss-1.195-|Sample:0.96|use_time:19.866051197052002
loss: -1.1945924817062006, EarlyStopping counter: 29 out of 300
EPOCH[626/2000] loss-1.193-|Sample:0.95|use_time:18.505642652511597
loss: -1.1932326497101202, EarlyStopping counter: 30 out of 300
EPOCH[627/2000] loss-1.196-|Sample:1.99|use_time:19.84930920600891
loss: -1.1959087557908965, EarlyStopping counter: 31 out of 300
EPOCH[628/2000] loss-1.196-|Sample:1.75|use_time:19.68553113937378
loss: -1.195625430200158, EarlyStopping counter: 32 out of 300
EPOCH[629/2000] loss-1.196-|Sample:2.15|use_time:20.033315181732178
loss: -1.1959969590349895, EarlyStopping counter: 33 out of 300
EPOCH[630/2000] loss-1.196-|Sample:1.88|use_time:19.679468870162964
loss: -1.1957954749828432, EarlyStopping counter: 34 out of 300
EPOCH[631/2000] loss-1.197-|Sample:1.75|use_time:18.832062005996704
EPOCH[632/2000] loss-1.195-|Sample:2.13|use_time:19.907443523406982
loss: -1.1952597135450782, EarlyStopping counter: 1 out of 300
EPOCH[633/2000] loss-1.193-|Sample:1.84|use_time:19.495563507080078
loss: -1.193412408596132, EarlyStopping counter: 2 out of 300
EPOCH[634/2000] loss-1.194-|Sample:0.95|use_time:19.799872875213623
loss: -1.1937017295418717, EarlyStopping counter: 3 out of 300
EPOCH[635/2000] loss-1.197-|Sample:0.96|use_time:19.066246509552002
EPOCH[636/2000] loss-1.195-|Sample:1.83|use_time:18.82868218421936
loss: -1.194534115675019, EarlyStopping counter: 1 out of 300
EPOCH[637/2000] loss-1.196-|Sample:1.84|use_time:19.796188354492188
loss: -1.1956267705777797, EarlyStopping counter: 2 out of 300
EPOCH[638/2000] loss-1.195-|Sample:2.14|use_time:19.87707757949829
loss: -1.1954175815349672, EarlyStopping counter: 3 out of 300
EPOCH[639/2000] loss-1.198-|Sample:0.95|use_time:19.70920705795288
EPOCH[640/2000] loss-1.196-|Sample:0.96|use_time:19.284717082977295
loss: -1.1964219052617142, EarlyStopping counter: 1 out of 300
EPOCH[641/2000] loss-1.196-|Sample:0.95|use_time:18.672889471054077
loss: -1.1961892552492095, EarlyStopping counter: 2 out of 300
EPOCH[642/2000] loss-1.197-|Sample:1.75|use_time:19.743573427200317
loss: -1.1967091618514643, EarlyStopping counter: 3 out of 300
EPOCH[643/2000] loss-1.196-|Sample:1.98|use_time:19.970263242721558
loss: -1.1962036941109635, EarlyStopping counter: 4 out of 300
EPOCH[644/2000] loss-1.196-|Sample:2.01|use_time:19.885338306427002
loss: -1.1963301257389347, EarlyStopping counter: 5 out of 300
EPOCH[645/2000] loss-1.197-|Sample:0.95|use_time:18.892885446548462
loss: -1.1970836476581852, EarlyStopping counter: 6 out of 300
EPOCH[646/2000] loss-1.196-|Sample:0.96|use_time:20.051815271377563
loss: -1.195526849932787, EarlyStopping counter: 7 out of 300
EPOCH[647/2000] loss-1.195-|Sample:0.97|use_time:18.871671676635742
loss: -1.1945325107109257, EarlyStopping counter: 8 out of 300
EPOCH[648/2000] loss-1.198-|Sample:1.77|use_time:19.81009078025818
loss: -1.1976443063922044, EarlyStopping counter: 9 out of 300
EPOCH[649/2000] loss-1.197-|Sample:2.10|use_time:19.30454134941101
loss: -1.1966114829226238, EarlyStopping counter: 10 out of 300
EPOCH[650/2000] loss-1.194-|Sample:1.92|use_time:19.893385887145996
loss: -1.194496090819196, EarlyStopping counter: 11 out of 300
[TEST]
{'precision': array([0.02616729, 0.0195568 , 0.01217478]), 'recall': array([0.11256955, 0.1636857 , 0.25211755]), 'ndcg': array([0.07574074, 0.09141597, 0.11314109]), 'coverage': array([24.01510612, 28.18476904, 33.11473159]), 'Acoverage': array([ 481.43270911,  751.56629213, 1297.15530587]), 'ILD': array([0.72240255, 0.74363624, 0.77192499]), 'F1': array([0.19478623, 0.26831186, 0.38009327])}
test time: 70.35877418518066
reg_loss2: tensor(0.0160, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2060, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2261, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[651/2000] loss-1.197-|Sample:0.96|use_time:20.32575225830078
loss: -1.197050870918646, EarlyStopping counter: 12 out of 300
EPOCH[652/2000] loss-1.198-|Sample:0.96|use_time:18.962701082229614
EPOCH[653/2000] loss-1.195-|Sample:2.15|use_time:19.890143871307373
loss: -1.194580383417083, EarlyStopping counter: 1 out of 300
EPOCH[654/2000] loss-1.196-|Sample:1.89|use_time:19.09380602836609
loss: -1.1963074730663765, EarlyStopping counter: 2 out of 300
EPOCH[655/2000] loss-1.198-|Sample:0.95|use_time:19.893848657608032
EPOCH[656/2000] loss-1.199-|Sample:0.95|use_time:20.192578315734863
EPOCH[657/2000] loss-1.197-|Sample:0.96|use_time:18.669011116027832
loss: -1.1969171268184011, EarlyStopping counter: 1 out of 300
EPOCH[658/2000] loss-1.197-|Sample:1.78|use_time:20.08316946029663
loss: -1.1966601261278478, EarlyStopping counter: 2 out of 300
EPOCH[659/2000] loss-1.194-|Sample:0.96|use_time:19.03948402404785
loss: -1.194493069881346, EarlyStopping counter: 3 out of 300
EPOCH[660/2000] loss-1.196-|Sample:1.85|use_time:19.788142681121826
loss: -1.195788299165121, EarlyStopping counter: 4 out of 300
EPOCH[661/2000] loss-1.198-|Sample:1.90|use_time:20.09093737602234
loss: -1.1983568377611113, EarlyStopping counter: 5 out of 300
EPOCH[662/2000] loss-1.199-|Sample:0.96|use_time:19.86946988105774
EPOCH[663/2000] loss-1.197-|Sample:0.96|use_time:19.311408281326294
loss: -1.1966571488031528, EarlyStopping counter: 1 out of 300
EPOCH[664/2000] loss-1.198-|Sample:0.96|use_time:18.891369104385376
loss: -1.1975189331101208, EarlyStopping counter: 2 out of 300
EPOCH[665/2000] loss-1.198-|Sample:2.07|use_time:19.756774187088013
loss: -1.1977971152561466, EarlyStopping counter: 3 out of 300
EPOCH[666/2000] loss-1.197-|Sample:1.76|use_time:19.746819257736206
loss: -1.1967262553005684, EarlyStopping counter: 4 out of 300
EPOCH[667/2000] loss-1.197-|Sample:0.96|use_time:19.291173219680786
loss: -1.1966699303650274, EarlyStopping counter: 5 out of 300
EPOCH[668/2000] loss-1.198-|Sample:0.95|use_time:19.59683871269226
loss: -1.1979238143781337, EarlyStopping counter: 6 out of 300
EPOCH[669/2000] loss-1.197-|Sample:0.95|use_time:18.93853783607483
loss: -1.1974238186347774, EarlyStopping counter: 7 out of 300
EPOCH[670/2000] loss-1.196-|Sample:2.04|use_time:20.017266035079956
loss: -1.1960948473069726, EarlyStopping counter: 8 out of 300
EPOCH[671/2000] loss-1.194-|Sample:1.98|use_time:19.870914459228516
loss: -1.1937915261198835, EarlyStopping counter: 9 out of 300
EPOCH[672/2000] loss-1.197-|Sample:1.77|use_time:19.015381813049316
loss: -1.1969905597407644, EarlyStopping counter: 10 out of 300
EPOCH[673/2000] loss-1.197-|Sample:0.96|use_time:20.210508346557617
loss: -1.196679199614176, EarlyStopping counter: 11 out of 300
EPOCH[674/2000] loss-1.197-|Sample:0.95|use_time:19.678752183914185
loss: -1.1965489183984153, EarlyStopping counter: 12 out of 300
EPOCH[675/2000] loss-1.197-|Sample:0.95|use_time:18.82025694847107
loss: -1.196616216403682, EarlyStopping counter: 13 out of 300
EPOCH[676/2000] loss-1.196-|Sample:2.18|use_time:19.239020586013794
loss: -1.196173452749485, EarlyStopping counter: 14 out of 300
EPOCH[677/2000] loss-1.199-|Sample:1.89|use_time:19.759742498397827
loss: -1.1986929905123827, EarlyStopping counter: 15 out of 300
EPOCH[678/2000] loss-1.197-|Sample:1.76|use_time:19.8524386882782
loss: -1.1965432981165445, EarlyStopping counter: 16 out of 300
EPOCH[679/2000] loss-1.196-|Sample:0.96|use_time:20.087468147277832
loss: -1.1957315061150529, EarlyStopping counter: 17 out of 300
EPOCH[680/2000] loss-1.198-|Sample:0.96|use_time:18.642796754837036
loss: -1.1975137489597971, EarlyStopping counter: 18 out of 300
EPOCH[681/2000] loss-1.198-|Sample:1.78|use_time:19.085222721099854
loss: -1.1983629116197911, EarlyStopping counter: 19 out of 300
EPOCH[682/2000] loss-1.198-|Sample:2.14|use_time:20.04060459136963
loss: -1.1981675682998285, EarlyStopping counter: 20 out of 300
EPOCH[683/2000] loss-1.198-|Sample:1.88|use_time:19.759626865386963
loss: -1.1975833497396329, EarlyStopping counter: 21 out of 300
EPOCH[684/2000] loss-1.197-|Sample:1.80|use_time:19.826739072799683
loss: -1.1974925587816936, EarlyStopping counter: 22 out of 300
EPOCH[685/2000] loss-1.200-|Sample:2.16|use_time:19.23614501953125
EPOCH[686/2000] loss-1.198-|Sample:1.76|use_time:19.70280957221985
loss: -1.1980747013557247, EarlyStopping counter: 1 out of 300
EPOCH[687/2000] loss-1.200-|Sample:1.90|use_time:20.028019666671753
EPOCH[688/2000] loss-1.199-|Sample:0.95|use_time:19.94295072555542
loss: -1.1989012200657914, EarlyStopping counter: 1 out of 300
EPOCH[689/2000] loss-1.199-|Sample:0.95|use_time:18.791757345199585
loss: -1.198797691159132, EarlyStopping counter: 2 out of 300
EPOCH[690/2000] loss-1.198-|Sample:2.03|use_time:19.52263307571411
loss: -1.1980685693461721, EarlyStopping counter: 3 out of 300
EPOCH[691/2000] loss-1.196-|Sample:2.04|use_time:19.92383599281311
loss: -1.1959365315553618, EarlyStopping counter: 4 out of 300
EPOCH[692/2000] loss-1.200-|Sample:1.77|use_time:19.73991322517395
loss: -1.199951320159726, EarlyStopping counter: 5 out of 300
EPOCH[693/2000] loss-1.198-|Sample:0.95|use_time:20.130791664123535
loss: -1.1980904020914218, EarlyStopping counter: 6 out of 300
EPOCH[694/2000] loss-1.200-|Sample:0.95|use_time:18.902036905288696
loss: -1.1995219660968315, EarlyStopping counter: 7 out of 300
EPOCH[695/2000] loss-1.196-|Sample:0.95|use_time:18.95085597038269
loss: -1.1960317274419272, EarlyStopping counter: 8 out of 300
EPOCH[696/2000] loss-1.199-|Sample:2.09|use_time:20.120808362960815
loss: -1.198848875557504, EarlyStopping counter: 9 out of 300
EPOCH[697/2000] loss-1.198-|Sample:1.91|use_time:19.846914768218994
loss: -1.1978138888754495, EarlyStopping counter: 10 out of 300
EPOCH[698/2000] loss-1.200-|Sample:1.77|use_time:19.840341567993164
loss: -1.1998273570363114, EarlyStopping counter: 11 out of 300
EPOCH[699/2000] loss-1.199-|Sample:0.95|use_time:19.748232126235962
loss: -1.1985816577585733, EarlyStopping counter: 12 out of 300
EPOCH[700/2000] loss-1.199-|Sample:0.95|use_time:19.710086345672607
loss: -1.199169487487979, EarlyStopping counter: 13 out of 300
[TEST]
{'precision': array([0.02646692, 0.01980025, 0.01206242]), 'recall': array([0.11335614, 0.16633041, 0.25121007]), 'ndcg': array([0.076058  , 0.09211545, 0.112969  ]), 'coverage': array([23.8866417 , 28.14194757, 33.14169788]), 'Acoverage': array([ 489.15280899,  763.00761548, 1311.67790262]), 'ILD': array([0.71990567, 0.73980222, 0.76992351]), 'F1': array([0.19587056, 0.27159734, 0.37881927])}
test time: 70.6968686580658
reg_loss2: tensor(0.0147, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2543, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2249, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[701/2000] loss-1.200-|Sample:0.96|use_time:19.594666481018066
loss: -1.1995179391488797, EarlyStopping counter: 14 out of 300
EPOCH[702/2000] loss-1.198-|Sample:1.97|use_time:19.90577244758606
loss: -1.1978396584347981, EarlyStopping counter: 15 out of 300
EPOCH[703/2000] loss-1.199-|Sample:2.10|use_time:19.13571548461914
loss: -1.199449047809694, EarlyStopping counter: 16 out of 300
EPOCH[704/2000] loss-1.197-|Sample:1.76|use_time:19.73383665084839
loss: -1.1969051593687476, EarlyStopping counter: 17 out of 300
EPOCH[705/2000] loss-1.197-|Sample:2.03|use_time:20.008328199386597
loss: -1.1972153419401588, EarlyStopping counter: 18 out of 300
EPOCH[706/2000] loss-1.198-|Sample:1.99|use_time:19.908811569213867
loss: -1.1979264893182895, EarlyStopping counter: 19 out of 300
EPOCH[707/2000] loss-1.200-|Sample:1.77|use_time:19.7200129032135
loss: -1.1997806996833988, EarlyStopping counter: 20 out of 300
EPOCH[708/2000] loss-1.200-|Sample:0.97|use_time:19.721020698547363
loss: -1.1997939726201499, EarlyStopping counter: 21 out of 300
EPOCH[709/2000] loss-1.200-|Sample:0.95|use_time:19.76862621307373
loss: -1.1997103952780002, EarlyStopping counter: 22 out of 300
EPOCH[710/2000] loss-1.198-|Sample:0.96|use_time:18.806941270828247
loss: -1.1982985240657156, EarlyStopping counter: 23 out of 300
EPOCH[711/2000] loss-1.198-|Sample:2.12|use_time:19.85163187980652
loss: -1.1982828436828241, EarlyStopping counter: 24 out of 300
EPOCH[712/2000] loss-1.199-|Sample:1.89|use_time:18.896116971969604
loss: -1.1987265435660757, EarlyStopping counter: 25 out of 300
EPOCH[713/2000] loss-1.201-|Sample:1.79|use_time:19.872135639190674
EPOCH[714/2000] loss-1.197-|Sample:0.95|use_time:20.099119186401367
loss: -1.1971559524536133, EarlyStopping counter: 1 out of 300
EPOCH[715/2000] loss-1.198-|Sample:0.96|use_time:19.702361822128296
loss: -1.1979439462103494, EarlyStopping counter: 2 out of 300
EPOCH[716/2000] loss-1.200-|Sample:0.96|use_time:18.78732180595398
loss: -1.19982037311647, EarlyStopping counter: 3 out of 300
EPOCH[717/2000] loss-1.198-|Sample:2.18|use_time:19.448366165161133
loss: -1.1981294707554142, EarlyStopping counter: 4 out of 300
EPOCH[718/2000] loss-1.200-|Sample:1.86|use_time:19.74677586555481
loss: -1.1998729822112293, EarlyStopping counter: 5 out of 300
EPOCH[719/2000] loss-1.199-|Sample:1.81|use_time:20.0085711479187
loss: -1.1985390128158941, EarlyStopping counter: 6 out of 300
EPOCH[720/2000] loss-1.198-|Sample:0.95|use_time:20.094674110412598
loss: -1.1977215045835914, EarlyStopping counter: 7 out of 300
EPOCH[721/2000] loss-1.198-|Sample:0.96|use_time:18.890968084335327
loss: -1.1978868711285475, EarlyStopping counter: 8 out of 300
EPOCH[722/2000] loss-1.200-|Sample:0.96|use_time:19.05751919746399
loss: -1.200045571094606, EarlyStopping counter: 9 out of 300
EPOCH[723/2000] loss-1.200-|Sample:2.14|use_time:20.07800054550171
loss: -1.1996785954731266, EarlyStopping counter: 10 out of 300
EPOCH[724/2000] loss-1.200-|Sample:1.77|use_time:19.76904797554016
loss: -1.2002464707304792, EarlyStopping counter: 11 out of 300
EPOCH[725/2000] loss-1.198-|Sample:1.99|use_time:19.97113037109375
loss: -1.198109144117774, EarlyStopping counter: 12 out of 300
EPOCH[726/2000] loss-1.200-|Sample:0.97|use_time:19.449589490890503
loss: -1.199791018555804, EarlyStopping counter: 13 out of 300
EPOCH[727/2000] loss-1.197-|Sample:0.96|use_time:18.789934635162354
loss: -1.1968994402303927, EarlyStopping counter: 14 out of 300
EPOCH[728/2000] loss-1.200-|Sample:2.00|use_time:19.802974939346313
loss: -1.2003464378961703, EarlyStopping counter: 15 out of 300
EPOCH[729/2000] loss-1.199-|Sample:2.08|use_time:19.7998468875885
loss: -1.1993173418975458, EarlyStopping counter: 16 out of 300
EPOCH[730/2000] loss-1.198-|Sample:1.77|use_time:18.87169337272644
loss: -1.1982233088190963, EarlyStopping counter: 17 out of 300
EPOCH[731/2000] loss-1.199-|Sample:2.04|use_time:20.063331604003906
loss: -1.1994026259678165, EarlyStopping counter: 18 out of 300
EPOCH[732/2000] loss-1.199-|Sample:2.01|use_time:19.913223266601562
loss: -1.198681874973018, EarlyStopping counter: 19 out of 300
EPOCH[733/2000] loss-1.199-|Sample:1.78|use_time:19.816606760025024
loss: -1.198518660010361, EarlyStopping counter: 20 out of 300
EPOCH[734/2000] loss-1.199-|Sample:2.15|use_time:20.066574811935425
loss: -1.1990403373066971, EarlyStopping counter: 21 out of 300
EPOCH[735/2000] loss-1.199-|Sample:0.96|use_time:19.309123992919922
loss: -1.1985483896441576, EarlyStopping counter: 22 out of 300
EPOCH[736/2000] loss-1.199-|Sample:0.97|use_time:18.958316802978516
loss: -1.1988108274413318, EarlyStopping counter: 23 out of 300
EPOCH[737/2000] loss-1.198-|Sample:2.18|use_time:20.146202564239502
loss: -1.1980140674404982, EarlyStopping counter: 24 out of 300
EPOCH[738/2000] loss-1.199-|Sample:1.89|use_time:19.801355361938477
loss: -1.1990757686335867, EarlyStopping counter: 25 out of 300
EPOCH[739/2000] loss-1.200-|Sample:1.77|use_time:19.70833659172058
loss: -1.2004181989809362, EarlyStopping counter: 26 out of 300
EPOCH[740/2000] loss-1.199-|Sample:0.95|use_time:19.118571043014526
loss: -1.199376676140762, EarlyStopping counter: 27 out of 300
EPOCH[741/2000] loss-1.200-|Sample:0.96|use_time:19.60779356956482
loss: -1.1998379434027322, EarlyStopping counter: 28 out of 300
EPOCH[742/2000] loss-1.199-|Sample:0.95|use_time:18.79369807243347
loss: -1.1993986804310868, EarlyStopping counter: 29 out of 300
EPOCH[743/2000] loss-1.201-|Sample:2.14|use_time:19.841896295547485
loss: -1.2006339881478287, EarlyStopping counter: 30 out of 300
EPOCH[744/2000] loss-1.201-|Sample:1.79|use_time:19.478172063827515
EPOCH[745/2000] loss-1.202-|Sample:1.90|use_time:19.269585609436035
EPOCH[746/2000] loss-1.198-|Sample:0.95|use_time:19.69206929206848
loss: -1.1984236880046566, EarlyStopping counter: 1 out of 300
EPOCH[747/2000] loss-1.200-|Sample:0.96|use_time:19.82577657699585
loss: -1.2003952497389259, EarlyStopping counter: 2 out of 300
EPOCH[748/2000] loss-1.200-|Sample:0.95|use_time:18.827135801315308
loss: -1.1998394436952544, EarlyStopping counter: 3 out of 300
EPOCH[749/2000] loss-1.201-|Sample:2.04|use_time:19.67617893218994
loss: -1.2006627495695905, EarlyStopping counter: 4 out of 300
EPOCH[750/2000] loss-1.200-|Sample:1.74|use_time:19.57682704925537
loss: -1.1997206298316396, EarlyStopping counter: 5 out of 300
[TEST]
{'precision': array([0.02641698, 0.01962547, 0.01218976]), 'recall': array([0.11315491, 0.16428849, 0.25198257]), 'ndcg': array([0.07650415, 0.0921013 , 0.11378589]), 'coverage': array([24.05617978, 28.18339576, 33.14469413]), 'Acoverage': array([ 488.7545568 ,  766.69363296, 1323.86479401]), 'ILD': array([0.72090165, 0.74093239, 0.76998364]), 'F1': array([0.19560678, 0.26894356, 0.37970425])}
test time: 70.47538757324219
reg_loss2: tensor(0.0139, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2094, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2159, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[751/2000] loss-1.199-|Sample:2.34|use_time:20.114028215408325
loss: -1.1993832326516873, EarlyStopping counter: 6 out of 300
EPOCH[752/2000] loss-1.201-|Sample:0.95|use_time:19.422650814056396
loss: -1.2011281688038895, EarlyStopping counter: 7 out of 300
EPOCH[753/2000] loss-1.199-|Sample:0.96|use_time:18.76407217979431
loss: -1.1986766966377818, EarlyStopping counter: 8 out of 300
EPOCH[754/2000] loss-1.199-|Sample:2.10|use_time:19.047803163528442
loss: -1.1985716587159692, EarlyStopping counter: 9 out of 300
EPOCH[755/2000] loss-1.200-|Sample:1.76|use_time:18.744466304779053
loss: -1.2003767025179979, EarlyStopping counter: 10 out of 300
EPOCH[756/2000] loss-1.201-|Sample:0.96|use_time:19.029139518737793
loss: -1.2006240792390777, EarlyStopping counter: 11 out of 300
EPOCH[757/2000] loss-1.201-|Sample:0.95|use_time:18.91005039215088
loss: -1.2005971437547265, EarlyStopping counter: 12 out of 300
EPOCH[758/2000] loss-1.200-|Sample:0.96|use_time:18.6517276763916
loss: -1.1997476292819511, EarlyStopping counter: 13 out of 300
EPOCH[759/2000] loss-1.200-|Sample:1.92|use_time:20.859325408935547
loss: -1.2002331280126803, EarlyStopping counter: 14 out of 300
EPOCH[760/2000] loss-1.200-|Sample:0.95|use_time:18.828664541244507
loss: -1.2001576772550258, EarlyStopping counter: 15 out of 300
EPOCH[761/2000] loss-1.199-|Sample:1.75|use_time:19.598976850509644
loss: -1.1990183097560232, EarlyStopping counter: 16 out of 300
EPOCH[762/2000] loss-1.199-|Sample:2.05|use_time:20.053943634033203
loss: -1.19928471925782, EarlyStopping counter: 17 out of 300
EPOCH[763/2000] loss-1.201-|Sample:0.99|use_time:18.863546133041382
loss: -1.2008577090937917, EarlyStopping counter: 18 out of 300
EPOCH[764/2000] loss-1.201-|Sample:0.95|use_time:19.74789547920227
loss: -1.2007820170100143, EarlyStopping counter: 19 out of 300
EPOCH[765/2000] loss-1.199-|Sample:0.97|use_time:19.059649229049683
loss: -1.1992949276435665, EarlyStopping counter: 20 out of 300
EPOCH[766/2000] loss-1.199-|Sample:1.94|use_time:19.761810779571533
loss: -1.1992583856350039, EarlyStopping counter: 21 out of 300
EPOCH[767/2000] loss-1.203-|Sample:1.76|use_time:19.658427476882935
EPOCH[768/2000] loss-1.202-|Sample:0.96|use_time:19.200711488723755
loss: -1.20176643569295, EarlyStopping counter: 1 out of 300
EPOCH[769/2000] loss-1.200-|Sample:0.96|use_time:19.564331531524658
loss: -1.1995086669921875, EarlyStopping counter: 2 out of 300
EPOCH[770/2000] loss-1.200-|Sample:0.95|use_time:18.853577375411987
loss: -1.2000997444478476, EarlyStopping counter: 3 out of 300
EPOCH[771/2000] loss-1.200-|Sample:2.20|use_time:20.060022354125977
loss: -1.199651308175994, EarlyStopping counter: 4 out of 300
EPOCH[772/2000] loss-1.199-|Sample:1.84|use_time:19.723585605621338
loss: -1.1988366987647079, EarlyStopping counter: 5 out of 300
EPOCH[773/2000] loss-1.199-|Sample:1.80|use_time:19.75227403640747
loss: -1.1986344965492808, EarlyStopping counter: 6 out of 300
EPOCH[774/2000] loss-1.199-|Sample:0.95|use_time:19.424811124801636
loss: -1.1991302763543479, EarlyStopping counter: 7 out of 300
EPOCH[775/2000] loss-1.200-|Sample:0.95|use_time:19.640925645828247
loss: -1.19984535473149, EarlyStopping counter: 8 out of 300
EPOCH[776/2000] loss-1.199-|Sample:0.97|use_time:18.83108615875244
loss: -1.1990170362519055, EarlyStopping counter: 9 out of 300
EPOCH[777/2000] loss-1.200-|Sample:2.14|use_time:19.776768684387207
loss: -1.1997758179176143, EarlyStopping counter: 10 out of 300
EPOCH[778/2000] loss-1.199-|Sample:1.76|use_time:19.453533172607422
loss: -1.199064155904258, EarlyStopping counter: 11 out of 300
EPOCH[779/2000] loss-1.200-|Sample:1.95|use_time:19.15515398979187
loss: -1.2004130933342911, EarlyStopping counter: 12 out of 300
EPOCH[780/2000] loss-1.200-|Sample:0.95|use_time:19.703104257583618
loss: -1.200327768558409, EarlyStopping counter: 13 out of 300
EPOCH[781/2000] loss-1.201-|Sample:0.96|use_time:18.895451307296753
loss: -1.2006419170193556, EarlyStopping counter: 14 out of 300
EPOCH[782/2000] loss-1.202-|Sample:1.98|use_time:19.919249773025513
loss: -1.2021995782852173, EarlyStopping counter: 15 out of 300
EPOCH[783/2000] loss-1.200-|Sample:2.04|use_time:19.892271995544434
loss: -1.19960759907234, EarlyStopping counter: 16 out of 300
EPOCH[784/2000] loss-1.201-|Sample:1.77|use_time:19.042084217071533
loss: -1.2005985626360265, EarlyStopping counter: 17 out of 300
EPOCH[785/2000] loss-1.201-|Sample:2.04|use_time:19.969860076904297
loss: -1.2010019668718663, EarlyStopping counter: 18 out of 300
EPOCH[786/2000] loss-1.202-|Sample:2.02|use_time:19.87907648086548
loss: -1.201913577754323, EarlyStopping counter: 19 out of 300
EPOCH[787/2000] loss-1.202-|Sample:1.77|use_time:19.781790733337402
loss: -1.2015292033916567, EarlyStopping counter: 20 out of 300
EPOCH[788/2000] loss-1.200-|Sample:2.15|use_time:19.310229063034058
loss: -1.200025514858525, EarlyStopping counter: 21 out of 300
EPOCH[789/2000] loss-1.200-|Sample:0.96|use_time:19.640462398529053
loss: -1.2002871181906722, EarlyStopping counter: 22 out of 300
EPOCH[790/2000] loss-1.197-|Sample:0.95|use_time:18.83887267112732
loss: -1.1970095837988504, EarlyStopping counter: 23 out of 300
EPOCH[791/2000] loss-1.200-|Sample:2.16|use_time:19.79292392730713
loss: -1.1996506103655187, EarlyStopping counter: 24 out of 300
EPOCH[792/2000] loss-1.201-|Sample:1.88|use_time:19.518484115600586
loss: -1.2008719327973156, EarlyStopping counter: 25 out of 300
EPOCH[793/2000] loss-1.198-|Sample:1.77|use_time:19.339263677597046
loss: -1.1977790390572898, EarlyStopping counter: 26 out of 300
EPOCH[794/2000] loss-1.198-|Sample:0.96|use_time:20.10014295578003
loss: -1.198024621823939, EarlyStopping counter: 27 out of 300
EPOCH[795/2000] loss-1.201-|Sample:0.96|use_time:19.72084617614746
loss: -1.2010933131706425, EarlyStopping counter: 28 out of 300
EPOCH[796/2000] loss-1.200-|Sample:1.31|use_time:21.43787145614624
loss: -1.2001132209126542, EarlyStopping counter: 29 out of 300
EPOCH[797/2000] loss-1.200-|Sample:2.54|use_time:21.8206307888031
loss: -1.2001575493231051, EarlyStopping counter: 30 out of 300
EPOCH[798/2000] loss-1.201-|Sample:2.13|use_time:22.351145267486572
loss: -1.2013170137637998, EarlyStopping counter: 31 out of 300
EPOCH[799/2000] loss-1.202-|Sample:2.46|use_time:22.53845453262329
loss: -1.2019384227147916, EarlyStopping counter: 32 out of 300
EPOCH[800/2000] loss-1.201-|Sample:1.32|use_time:22.45028281211853
loss: -1.2012668993414901, EarlyStopping counter: 33 out of 300
[TEST]
{'precision': array([0.02661673, 0.01996255, 0.0121623 ]), 'recall': array([0.11427221, 0.16699219, 0.25152445]), 'ndcg': array([0.07695673, 0.09310559, 0.11391097]), 'coverage': array([24.07915106, 28.28014981, 33.22634207]), 'Acoverage': array([ 494.49225968,  772.55805243, 1334.07977528]), 'ILD': array([0.72215286, 0.74038307, 0.77088578]), 'F1': array([0.19732073, 0.27251832, 0.37929319])}
test time: 70.56556010246277
reg_loss2: tensor(0.0133, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2019, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2238, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[801/2000] loss-1.201-|Sample:0.95|use_time:19.930542945861816
loss: -1.2008098392951778, EarlyStopping counter: 34 out of 300
EPOCH[802/2000] loss-1.203-|Sample:0.95|use_time:18.846714973449707
loss: -1.2026423564771327, EarlyStopping counter: 35 out of 300
EPOCH[803/2000] loss-1.199-|Sample:2.01|use_time:19.745206356048584
loss: -1.1992741735970103, EarlyStopping counter: 36 out of 300
EPOCH[804/2000] loss-1.204-|Sample:1.77|use_time:19.72315287590027
EPOCH[805/2000] loss-1.200-|Sample:2.09|use_time:19.106725215911865
loss: -1.1998555573021494, EarlyStopping counter: 1 out of 300
EPOCH[806/2000] loss-1.201-|Sample:1.98|use_time:19.824517250061035
loss: -1.201273813480284, EarlyStopping counter: 2 out of 300
EPOCH[807/2000] loss-1.199-|Sample:1.76|use_time:19.72953772544861
loss: -1.1990914373863033, EarlyStopping counter: 3 out of 300
EPOCH[808/2000] loss-1.202-|Sample:2.17|use_time:20.128047943115234
loss: -1.2015299855208978, EarlyStopping counter: 4 out of 300
EPOCH[809/2000] loss-1.203-|Sample:0.96|use_time:19.746249437332153
loss: -1.2025846097527482, EarlyStopping counter: 5 out of 300
EPOCH[810/2000] loss-1.201-|Sample:0.97|use_time:18.291621685028076
loss: -1.2005065883078225, EarlyStopping counter: 6 out of 300
EPOCH[811/2000] loss-1.201-|Sample:2.18|use_time:21.004751682281494
loss: -1.2014038417397477, EarlyStopping counter: 7 out of 300
EPOCH[812/2000] loss-1.200-|Sample:0.96|use_time:18.815343379974365
loss: -1.1998181488455795, EarlyStopping counter: 8 out of 300
EPOCH[813/2000] loss-1.200-|Sample:1.77|use_time:20.916786909103394
loss: -1.2003472142103242, EarlyStopping counter: 9 out of 300
EPOCH[814/2000] loss-1.202-|Sample:0.96|use_time:18.18258285522461
loss: -1.201575904357724, EarlyStopping counter: 10 out of 300
EPOCH[815/2000] loss-1.200-|Sample:1.87|use_time:19.55833125114441
loss: -1.2001165267897815, EarlyStopping counter: 11 out of 300
EPOCH[816/2000] loss-1.200-|Sample:1.79|use_time:20.018890857696533
loss: -1.2000822642954385, EarlyStopping counter: 12 out of 300
EPOCH[817/2000] loss-1.201-|Sample:0.96|use_time:19.994182348251343
loss: -1.2007753412897995, EarlyStopping counter: 13 out of 300
EPOCH[818/2000] loss-1.203-|Sample:0.95|use_time:18.797330379486084
loss: -1.2028526387563565, EarlyStopping counter: 14 out of 300
EPOCH[819/2000] loss-1.200-|Sample:1.82|use_time:20.521836042404175
loss: -1.1997609661846627, EarlyStopping counter: 15 out of 300
EPOCH[820/2000] loss-1.202-|Sample:0.97|use_time:18.78253483772278
loss: -1.2022240888781663, EarlyStopping counter: 16 out of 300
EPOCH[821/2000] loss-1.200-|Sample:1.80|use_time:19.672101974487305
loss: -1.2001359637190656, EarlyStopping counter: 17 out of 300
EPOCH[822/2000] loss-1.201-|Sample:1.93|use_time:19.97737979888916
loss: -1.2008427875797922, EarlyStopping counter: 18 out of 300
EPOCH[823/2000] loss-1.200-|Sample:0.96|use_time:19.070334911346436
loss: -1.2000983662721587, EarlyStopping counter: 19 out of 300
EPOCH[824/2000] loss-1.201-|Sample:0.95|use_time:19.564069509506226
loss: -1.2006838786892775, EarlyStopping counter: 20 out of 300
EPOCH[825/2000] loss-1.202-|Sample:0.96|use_time:19.13309621810913
loss: -1.2020087096749283, EarlyStopping counter: 21 out of 300
EPOCH[826/2000] loss-1.202-|Sample:2.07|use_time:20.012051820755005
loss: -1.2022155581451044, EarlyStopping counter: 22 out of 300
EPOCH[827/2000] loss-1.202-|Sample:1.76|use_time:19.720294952392578
loss: -1.2021350715218522, EarlyStopping counter: 23 out of 300
EPOCH[828/2000] loss-1.203-|Sample:0.95|use_time:19.320980548858643
loss: -1.2033587461564599, EarlyStopping counter: 24 out of 300
EPOCH[829/2000] loss-1.201-|Sample:0.97|use_time:19.609700679779053
loss: -1.2013746063883712, EarlyStopping counter: 25 out of 300
EPOCH[830/2000] loss-1.201-|Sample:0.97|use_time:18.926151275634766
loss: -1.2008930299340226, EarlyStopping counter: 26 out of 300
EPOCH[831/2000] loss-1.200-|Sample:2.08|use_time:19.93272829055786
loss: -1.2002495323739402, EarlyStopping counter: 27 out of 300
EPOCH[832/2000] loss-1.203-|Sample:1.96|use_time:18.891475677490234
loss: -1.2025313493682117, EarlyStopping counter: 28 out of 300
EPOCH[833/2000] loss-1.200-|Sample:1.78|use_time:19.675241947174072
loss: -1.2000408608738968, EarlyStopping counter: 29 out of 300
EPOCH[834/2000] loss-1.200-|Sample:0.96|use_time:19.93398666381836
loss: -1.1996968693849517, EarlyStopping counter: 30 out of 300
EPOCH[835/2000] loss-1.201-|Sample:0.97|use_time:19.631866455078125
loss: -1.201300405874485, EarlyStopping counter: 31 out of 300
EPOCH[836/2000] loss-1.199-|Sample:0.96|use_time:18.67102074623108
loss: -1.1986726580596552, EarlyStopping counter: 32 out of 300
EPOCH[837/2000] loss-1.202-|Sample:2.20|use_time:19.2785861492157
loss: -1.2017527004567587, EarlyStopping counter: 33 out of 300
EPOCH[838/2000] loss-1.200-|Sample:1.83|use_time:19.508896827697754
loss: -1.199582163880511, EarlyStopping counter: 34 out of 300
EPOCH[839/2000] loss-1.199-|Sample:1.80|use_time:19.946001291275024
loss: -1.199326811767206, EarlyStopping counter: 35 out of 300
EPOCH[840/2000] loss-1.200-|Sample:0.96|use_time:20.00877094268799
loss: -1.200459212791629, EarlyStopping counter: 36 out of 300
EPOCH[841/2000] loss-1.200-|Sample:0.99|use_time:18.030436754226685
loss: -1.2000243576561533, EarlyStopping counter: 37 out of 300
EPOCH[842/2000] loss-1.202-|Sample:1.89|use_time:19.591182231903076
loss: -1.2020101169260538, EarlyStopping counter: 38 out of 300
EPOCH[843/2000] loss-1.201-|Sample:2.16|use_time:19.83348798751831
loss: -1.2011130786523587, EarlyStopping counter: 39 out of 300
EPOCH[844/2000] loss-1.201-|Sample:1.79|use_time:19.46595311164856
loss: -1.201171578430548, EarlyStopping counter: 40 out of 300
EPOCH[845/2000] loss-1.204-|Sample:2.01|use_time:19.775804042816162
EPOCH[846/2000] loss-1.200-|Sample:1.98|use_time:19.191516637802124
loss: -1.2000519531529124, EarlyStopping counter: 1 out of 300
EPOCH[847/2000] loss-1.203-|Sample:1.78|use_time:19.799610376358032
loss: -1.2025901021026983, EarlyStopping counter: 2 out of 300
EPOCH[848/2000] loss-1.202-|Sample:2.14|use_time:20.20456838607788
loss: -1.2017405033111572, EarlyStopping counter: 3 out of 300
EPOCH[849/2000] loss-1.200-|Sample:0.96|use_time:19.813669443130493
loss: -1.2001885757213686, EarlyStopping counter: 4 out of 300
EPOCH[850/2000] loss-1.201-|Sample:0.96|use_time:18.111011505126953
loss: -1.2012296740601702, EarlyStopping counter: 5 out of 300
[TEST]
{'precision': array([0.02697878, 0.02000624, 0.01218477]), 'recall': array([0.11587941, 0.16790945, 0.25298651]), 'ndcg': array([0.07760926, 0.09349168, 0.11442414]), 'coverage': array([24.16204744, 28.47153558, 33.42097378]), 'Acoverage': array([ 498.96616729,  779.86579276, 1346.70124844]), 'ILD': array([0.72170065, 0.73962744, 0.76938246]), 'F1': array([0.19969493, 0.2736868 , 0.38076935])}
test time: 70.29796695709229
reg_loss2: tensor(0.0128, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2064, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2272, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[851/2000] loss-1.202-|Sample:2.35|use_time:20.29999852180481
loss: -1.2018010383698998, EarlyStopping counter: 6 out of 300
EPOCH[852/2000] loss-1.201-|Sample:1.90|use_time:19.771608352661133
loss: -1.2009419871539604, EarlyStopping counter: 7 out of 300
EPOCH[853/2000] loss-1.200-|Sample:1.77|use_time:19.76063323020935
loss: -1.199656771450508, EarlyStopping counter: 8 out of 300
EPOCH[854/2000] loss-1.203-|Sample:2.57|use_time:22.01622176170349
loss: -1.2028482599956234, EarlyStopping counter: 9 out of 300
EPOCH[855/2000] loss-1.203-|Sample:1.32|use_time:22.340745449066162
loss: -1.2031363714032057, EarlyStopping counter: 10 out of 300
EPOCH[856/2000] loss-1.201-|Sample:1.34|use_time:22.848702430725098
loss: -1.2005557752237088, EarlyStopping counter: 11 out of 300
EPOCH[857/2000] loss-1.202-|Sample:1.32|use_time:21.393542528152466
loss: -1.2015942422355093, EarlyStopping counter: 12 out of 300
EPOCH[858/2000] loss-1.201-|Sample:2.15|use_time:21.556726932525635
loss: -1.2007012716153773, EarlyStopping counter: 13 out of 300
EPOCH[859/2000] loss-1.201-|Sample:2.49|use_time:22.759927988052368
loss: -1.2006116843805081, EarlyStopping counter: 14 out of 300
EPOCH[860/2000] loss-1.202-|Sample:2.25|use_time:22.530441999435425
loss: -1.2017611846691225, EarlyStopping counter: 15 out of 300
EPOCH[861/2000] loss-1.201-|Sample:1.34|use_time:22.788144826889038
loss: -1.200781796036697, EarlyStopping counter: 16 out of 300
EPOCH[862/2000] loss-1.202-|Sample:1.32|use_time:20.792767763137817
loss: -1.2015763055987474, EarlyStopping counter: 17 out of 300
EPOCH[863/2000] loss-1.201-|Sample:2.14|use_time:22.35430669784546
loss: -1.2007681945475137, EarlyStopping counter: 18 out of 300
EPOCH[864/2000] loss-1.201-|Sample:2.47|use_time:22.712214708328247
loss: -1.2013880537777413, EarlyStopping counter: 19 out of 300
EPOCH[865/2000] loss-1.201-|Sample:2.28|use_time:22.439903497695923
loss: -1.2008489108667142, EarlyStopping counter: 20 out of 300
EPOCH[866/2000] loss-1.201-|Sample:2.21|use_time:22.359304189682007
loss: -1.2013718994652354, EarlyStopping counter: 21 out of 300
EPOCH[867/2000] loss-1.204-|Sample:2.57|use_time:22.541180849075317
loss: -1.2035497688665622, EarlyStopping counter: 22 out of 300
EPOCH[868/2000] loss-1.201-|Sample:2.16|use_time:22.35843062400818
loss: -1.2007563056015387, EarlyStopping counter: 23 out of 300
EPOCH[869/2000] loss-1.202-|Sample:2.51|use_time:22.626283645629883
loss: -1.2023419839579885, EarlyStopping counter: 24 out of 300
EPOCH[870/2000] loss-1.201-|Sample:1.32|use_time:22.329214334487915
loss: -1.2005229694087332, EarlyStopping counter: 25 out of 300
EPOCH[871/2000] loss-1.201-|Sample:1.32|use_time:21.555927991867065
loss: -1.2007358888300455, EarlyStopping counter: 26 out of 300
EPOCH[872/2000] loss-1.203-|Sample:2.63|use_time:22.77083683013916
loss: -1.2029493174901822, EarlyStopping counter: 27 out of 300
EPOCH[873/2000] loss-1.201-|Sample:2.15|use_time:22.39902091026306
loss: -1.2009979253861962, EarlyStopping counter: 28 out of 300
EPOCH[874/2000] loss-1.204-|Sample:2.52|use_time:22.583693742752075
loss: -1.2037065523426707, EarlyStopping counter: 29 out of 300
EPOCH[875/2000] loss-1.202-|Sample:1.33|use_time:22.233792304992676
loss: -1.2015876799094967, EarlyStopping counter: 30 out of 300
EPOCH[876/2000] loss-1.201-|Sample:1.33|use_time:22.58339023590088
loss: -1.2012220708335317, EarlyStopping counter: 31 out of 300
EPOCH[877/2000] loss-1.201-|Sample:0.96|use_time:18.989712715148926
loss: -1.2010661945110415, EarlyStopping counter: 32 out of 300
EPOCH[878/2000] loss-1.202-|Sample:1.76|use_time:18.803595304489136
loss: -1.202239554102828, EarlyStopping counter: 33 out of 300
EPOCH[879/2000] loss-1.200-|Sample:1.91|use_time:19.762698888778687
loss: -1.2000120878219604, EarlyStopping counter: 34 out of 300
EPOCH[880/2000] loss-1.202-|Sample:2.09|use_time:19.76645827293396
loss: -1.2017621005453714, EarlyStopping counter: 35 out of 300
EPOCH[881/2000] loss-1.202-|Sample:0.96|use_time:19.51602077484131
loss: -1.2016905226358554, EarlyStopping counter: 36 out of 300
EPOCH[882/2000] loss-1.203-|Sample:0.97|use_time:19.4155113697052
loss: -1.2025249178816633, EarlyStopping counter: 37 out of 300
EPOCH[883/2000] loss-1.202-|Sample:0.95|use_time:18.683738946914673
loss: -1.202134617945043, EarlyStopping counter: 38 out of 300
EPOCH[884/2000] loss-1.204-|Sample:1.75|use_time:19.51014232635498
loss: -1.2037878588932316, EarlyStopping counter: 39 out of 300
EPOCH[885/2000] loss-1.202-|Sample:2.03|use_time:19.84256863594055
loss: -1.2020419458063638, EarlyStopping counter: 40 out of 300
EPOCH[886/2000] loss-1.203-|Sample:1.97|use_time:19.798182725906372
loss: -1.2030532883434761, EarlyStopping counter: 41 out of 300
EPOCH[887/2000] loss-1.201-|Sample:0.98|use_time:19.191277980804443
loss: -1.20109384525113, EarlyStopping counter: 42 out of 300
EPOCH[888/2000] loss-1.200-|Sample:0.96|use_time:19.0432391166687
loss: -1.200328009884532, EarlyStopping counter: 43 out of 300
EPOCH[889/2000] loss-1.202-|Sample:1.99|use_time:19.825414896011353
loss: -1.201880891148637, EarlyStopping counter: 44 out of 300
EPOCH[890/2000] loss-1.202-|Sample:1.77|use_time:19.731979370117188
loss: -1.2024548489873002, EarlyStopping counter: 45 out of 300
EPOCH[891/2000] loss-1.203-|Sample:2.19|use_time:19.16309404373169
loss: -1.2028613846476486, EarlyStopping counter: 46 out of 300
EPOCH[892/2000] loss-1.203-|Sample:1.87|use_time:19.74742889404297
loss: -1.2033794246068814, EarlyStopping counter: 47 out of 300
EPOCH[893/2000] loss-1.203-|Sample:1.78|use_time:19.878684997558594
loss: -1.2027417392265507, EarlyStopping counter: 48 out of 300
EPOCH[894/2000] loss-1.202-|Sample:2.10|use_time:20.09791898727417
loss: -1.2022494077682495, EarlyStopping counter: 49 out of 300
EPOCH[895/2000] loss-1.199-|Sample:1.78|use_time:19.665194511413574
loss: -1.1992023020255855, EarlyStopping counter: 50 out of 300
EPOCH[896/2000] loss-1.203-|Sample:0.97|use_time:19.682913064956665
loss: -1.203313897295696, EarlyStopping counter: 51 out of 300
EPOCH[897/2000] loss-1.205-|Sample:0.96|use_time:18.819971799850464
EPOCH[898/2000] loss-1.202-|Sample:1.80|use_time:19.716769456863403
loss: -1.2023463714413527, EarlyStopping counter: 1 out of 300
EPOCH[899/2000] loss-1.204-|Sample:1.92|use_time:19.879371643066406
loss: -1.2041235609752377, EarlyStopping counter: 2 out of 300
EPOCH[900/2000] loss-1.204-|Sample:2.10|use_time:19.084351539611816
loss: -1.203952431678772, EarlyStopping counter: 3 out of 300
[TEST]
{'precision': array([0.0270412 , 0.01993134, 0.01209988]), 'recall': array([0.11605152, 0.16800953, 0.25055928]), 'ndcg': array([0.07871158, 0.09444064, 0.11489185]), 'coverage': array([24.49637953, 28.57677903, 33.41835206]), 'Acoverage': array([ 506.07602996,  790.58639201, 1363.23882647]), 'ILD': array([0.72091275, 0.73792628, 0.76811445]), 'F1': array([0.19992017, 0.27370295, 0.37786035])}
test time: 70.12912917137146
reg_loss2: tensor(0.0125, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.1824, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2220, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[901/2000] loss-1.200-|Sample:0.95|use_time:20.281790733337402
loss: -1.2000122768122976, EarlyStopping counter: 4 out of 300
EPOCH[902/2000] loss-1.202-|Sample:0.95|use_time:19.73888349533081
loss: -1.2017484438128587, EarlyStopping counter: 5 out of 300
EPOCH[903/2000] loss-1.203-|Sample:0.96|use_time:18.861945867538452
loss: -1.2032359111599806, EarlyStopping counter: 6 out of 300
EPOCH[904/2000] loss-1.204-|Sample:2.14|use_time:19.88924765586853
loss: -1.2036053262105801, EarlyStopping counter: 7 out of 300
EPOCH[905/2000] loss-1.200-|Sample:1.76|use_time:19.09826636314392
loss: -1.1995618634107637, EarlyStopping counter: 8 out of 300
EPOCH[906/2000] loss-1.200-|Sample:1.98|use_time:21.337262630462646
loss: -1.2002774825910243, EarlyStopping counter: 9 out of 300
EPOCH[907/2000] loss-1.203-|Sample:4.51|use_time:25.134649515151978
loss: -1.2025960480294577, EarlyStopping counter: 10 out of 300
EPOCH[908/2000] loss-1.203-|Sample:0.98|use_time:21.234596490859985
loss: -1.2030603769348889, EarlyStopping counter: 11 out of 300
EPOCH[909/2000] loss-1.204-|Sample:0.96|use_time:18.256495475769043
loss: -1.2036159474675248, EarlyStopping counter: 12 out of 300
EPOCH[910/2000] loss-1.200-|Sample:2.35|use_time:20.44147515296936
loss: -1.2001502950017044, EarlyStopping counter: 13 out of 300
EPOCH[911/2000] loss-1.203-|Sample:2.74|use_time:22.35156011581421
loss: -1.2026478633648012, EarlyStopping counter: 14 out of 300
EPOCH[912/2000] loss-1.202-|Sample:4.27|use_time:22.28196120262146
loss: -1.2022588776379097, EarlyStopping counter: 15 out of 300
EPOCH[913/2000] loss-1.203-|Sample:2.17|use_time:19.295954942703247
loss: -1.2028385778752768, EarlyStopping counter: 16 out of 300
EPOCH[914/2000] loss-1.203-|Sample:1.89|use_time:19.83835005760193
loss: -1.203130329527506, EarlyStopping counter: 17 out of 300
EPOCH[915/2000] loss-1.205-|Sample:1.90|use_time:20.08841323852539
loss: -1.2046859322524652, EarlyStopping counter: 18 out of 300
EPOCH[916/2000] loss-1.201-|Sample:2.04|use_time:19.883254766464233
loss: -1.201444247873818, EarlyStopping counter: 19 out of 300
EPOCH[917/2000] loss-1.201-|Sample:0.95|use_time:18.90646505355835
loss: -1.2014776817182216, EarlyStopping counter: 20 out of 300
EPOCH[918/2000] loss-1.201-|Sample:0.96|use_time:19.093813180923462
loss: -1.2009788984205665, EarlyStopping counter: 21 out of 300
EPOCH[919/2000] loss-1.202-|Sample:2.08|use_time:19.952880382537842
loss: -1.2015802802109137, EarlyStopping counter: 22 out of 300
EPOCH[920/2000] loss-1.205-|Sample:1.75|use_time:19.707674980163574
loss: -1.205141468745906, EarlyStopping counter: 23 out of 300
EPOCH[921/2000] loss-1.201-|Sample:2.01|use_time:19.86583375930786
loss: -1.2011588375742843, EarlyStopping counter: 24 out of 300
EPOCH[922/2000] loss-1.203-|Sample:0.97|use_time:19.322009086608887
loss: -1.202917532223027, EarlyStopping counter: 25 out of 300
EPOCH[923/2000] loss-1.199-|Sample:0.96|use_time:19.86151146888733
loss: -1.198872051587919, EarlyStopping counter: 26 out of 300
EPOCH[924/2000] loss-1.202-|Sample:0.97|use_time:18.932114362716675
loss: -1.2018526123791207, EarlyStopping counter: 27 out of 300
EPOCH[925/2000] loss-1.203-|Sample:2.09|use_time:19.774948358535767
loss: -1.2030335839201765, EarlyStopping counter: 28 out of 300
EPOCH[926/2000] loss-1.202-|Sample:1.79|use_time:18.921905755996704
loss: -1.202192882212197, EarlyStopping counter: 29 out of 300
EPOCH[927/2000] loss-1.203-|Sample:2.07|use_time:20.419483423233032
loss: -1.2032506407760992, EarlyStopping counter: 30 out of 300
EPOCH[928/2000] loss-1.205-|Sample:0.96|use_time:21.271581411361694
loss: -1.2049981995326717, EarlyStopping counter: 31 out of 300
EPOCH[929/2000] loss-1.202-|Sample:0.95|use_time:20.330845832824707
loss: -1.2015195677920085, EarlyStopping counter: 32 out of 300
EPOCH[930/2000] loss-1.204-|Sample:0.97|use_time:19.24502921104431
loss: -1.2035898464482004, EarlyStopping counter: 33 out of 300
EPOCH[931/2000] loss-1.202-|Sample:2.06|use_time:19.66929602622986
loss: -1.2024821391919764, EarlyStopping counter: 34 out of 300
EPOCH[932/2000] loss-1.201-|Sample:1.75|use_time:19.883397579193115
loss: -1.2014298875157425, EarlyStopping counter: 35 out of 300
EPOCH[933/2000] loss-1.204-|Sample:3.36|use_time:22.819215059280396
loss: -1.2035909832977667, EarlyStopping counter: 36 out of 300
EPOCH[934/2000] loss-1.202-|Sample:0.98|use_time:23.4518404006958
loss: -1.202466112811391, EarlyStopping counter: 37 out of 300
EPOCH[935/2000] loss-1.202-|Sample:0.96|use_time:18.50128936767578
loss: -1.2016707804144882, EarlyStopping counter: 38 out of 300
EPOCH[936/2000] loss-1.202-|Sample:2.25|use_time:20.2686505317688
loss: -1.2024107764406902, EarlyStopping counter: 39 out of 300
EPOCH[937/2000] loss-1.202-|Sample:1.86|use_time:21.933345079421997
loss: -1.2020174671963948, EarlyStopping counter: 40 out of 300
EPOCH[938/2000] loss-1.201-|Sample:2.36|use_time:20.331617832183838
loss: -1.2010940342414669, EarlyStopping counter: 41 out of 300
EPOCH[939/2000] loss-1.203-|Sample:2.33|use_time:19.466201305389404
loss: -1.2029380652962662, EarlyStopping counter: 42 out of 300
EPOCH[940/2000] loss-1.204-|Sample:2.22|use_time:20.030126810073853
loss: -1.203736604713812, EarlyStopping counter: 43 out of 300
EPOCH[941/2000] loss-1.204-|Sample:1.78|use_time:19.88462471961975
loss: -1.2037343484599416, EarlyStopping counter: 44 out of 300
EPOCH[942/2000] loss-1.203-|Sample:2.41|use_time:21.095330953598022
loss: -1.202585979205806, EarlyStopping counter: 45 out of 300
EPOCH[943/2000] loss-1.204-|Sample:0.95|use_time:19.462401151657104
loss: -1.2039735375381098, EarlyStopping counter: 46 out of 300
EPOCH[944/2000] loss-1.203-|Sample:0.95|use_time:19.259812831878662
loss: -1.2032791172585837, EarlyStopping counter: 47 out of 300
EPOCH[945/2000] loss-1.203-|Sample:2.02|use_time:19.94286561012268
loss: -1.202701327277393, EarlyStopping counter: 48 out of 300
EPOCH[946/2000] loss-1.200-|Sample:1.79|use_time:19.734543561935425
loss: -1.200298457610898, EarlyStopping counter: 49 out of 300
EPOCH[947/2000] loss-1.203-|Sample:2.15|use_time:20.148509740829468
loss: -1.2026111876092307, EarlyStopping counter: 50 out of 300
EPOCH[948/2000] loss-1.202-|Sample:0.96|use_time:19.07386803627014
loss: -1.202143183568629, EarlyStopping counter: 51 out of 300
EPOCH[949/2000] loss-1.203-|Sample:0.96|use_time:20.197921991348267
loss: -1.2026080619998094, EarlyStopping counter: 52 out of 300
EPOCH[950/2000] loss-1.202-|Sample:0.97|use_time:18.845311641693115
loss: -1.2021690781523542, EarlyStopping counter: 53 out of 300
[TEST]
{'precision': array([0.02659176, 0.01998752, 0.01216479]), 'recall': array([0.11480958, 0.16729093, 0.2520148 ]), 'ndcg': array([0.07757338, 0.09369961, 0.11453772]), 'coverage': array([24.29250936, 28.55505618, 33.33670412]), 'Acoverage': array([ 512.62009988,  799.46828964, 1372.58888889]), 'ILD': array([0.72055764, 0.73735988, 0.76820118]), 'F1': array([0.1980612 , 0.27270991, 0.37952369])}
test time: 70.2964596748352
reg_loss2: tensor(0.0122, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2221, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2089, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[951/2000] loss-1.203-|Sample:2.31|use_time:20.343921661376953
loss: -1.2025462330841437, EarlyStopping counter: 54 out of 300
EPOCH[952/2000] loss-1.203-|Sample:2.16|use_time:19.169282913208008
loss: -1.2029329800024264, EarlyStopping counter: 55 out of 300
EPOCH[953/2000] loss-1.201-|Sample:1.84|use_time:19.5007004737854
loss: -1.2012274585119107, EarlyStopping counter: 56 out of 300
EPOCH[954/2000] loss-1.201-|Sample:1.85|use_time:19.894479274749756
loss: -1.2012703535033435, EarlyStopping counter: 57 out of 300
EPOCH[955/2000] loss-1.204-|Sample:0.95|use_time:20.004720449447632
loss: -1.20401434200566, EarlyStopping counter: 58 out of 300
EPOCH[956/2000] loss-1.204-|Sample:0.96|use_time:18.920517444610596
loss: -1.2042666092151548, EarlyStopping counter: 59 out of 300
EPOCH[957/2000] loss-1.201-|Sample:1.93|use_time:18.948595762252808
loss: -1.2009901215390462, EarlyStopping counter: 60 out of 300
EPOCH[958/2000] loss-1.203-|Sample:2.10|use_time:19.988581657409668
loss: -1.2025903928570632, EarlyStopping counter: 61 out of 300
EPOCH[959/2000] loss-1.200-|Sample:1.76|use_time:19.560981512069702
loss: -1.2002667624775956, EarlyStopping counter: 62 out of 300
EPOCH[960/2000] loss-1.205-|Sample:2.07|use_time:19.985193967819214
EPOCH[961/2000] loss-1.202-|Sample:1.97|use_time:19.687036991119385
loss: -1.2022528473923846, EarlyStopping counter: 1 out of 300
EPOCH[962/2000] loss-1.202-|Sample:1.77|use_time:19.583917379379272
loss: -1.2024016380310059, EarlyStopping counter: 2 out of 300
EPOCH[963/2000] loss-1.205-|Sample:2.14|use_time:19.937880992889404
loss: -1.2050164327388857, EarlyStopping counter: 3 out of 300
EPOCH[964/2000] loss-1.204-|Sample:0.96|use_time:19.43774437904358
loss: -1.2036284557202968, EarlyStopping counter: 4 out of 300
EPOCH[965/2000] loss-1.203-|Sample:0.97|use_time:18.780338764190674
loss: -1.2027606062772798, EarlyStopping counter: 5 out of 300
EPOCH[966/2000] loss-1.202-|Sample:2.17|use_time:19.89060068130493
loss: -1.201677604419429, EarlyStopping counter: 6 out of 300
EPOCH[967/2000] loss-1.205-|Sample:1.81|use_time:19.449066400527954
loss: -1.2046781516656644, EarlyStopping counter: 7 out of 300
EPOCH[968/2000] loss-1.200-|Sample:1.89|use_time:18.994027853012085
loss: -1.200265884399414, EarlyStopping counter: 8 out of 300
EPOCH[969/2000] loss-1.202-|Sample:0.97|use_time:19.031965494155884
loss: -1.202214290456074, EarlyStopping counter: 9 out of 300
EPOCH[970/2000] loss-1.201-|Sample:0.96|use_time:18.915969133377075
loss: -1.2007542615983544, EarlyStopping counter: 10 out of 300
EPOCH[971/2000] loss-1.201-|Sample:0.96|use_time:18.151450872421265
loss: -1.200957847804558, EarlyStopping counter: 11 out of 300
EPOCH[972/2000] loss-1.202-|Sample:2.04|use_time:19.93562412261963
loss: -1.2018725290531065, EarlyStopping counter: 12 out of 300
EPOCH[973/2000] loss-1.206-|Sample:1.77|use_time:19.75719714164734
EPOCH[974/2000] loss-1.202-|Sample:2.03|use_time:20.107598781585693
loss: -1.2021839153475877, EarlyStopping counter: 1 out of 300
EPOCH[975/2000] loss-1.202-|Sample:0.95|use_time:19.80478596687317
loss: -1.201894594401848, EarlyStopping counter: 2 out of 300
EPOCH[976/2000] loss-1.202-|Sample:0.97|use_time:19.405997037887573
loss: -1.2024984185288592, EarlyStopping counter: 3 out of 300
EPOCH[977/2000] loss-1.201-|Sample:0.97|use_time:18.91181993484497
loss: -1.201158203729769, EarlyStopping counter: 4 out of 300
EPOCH[978/2000] loss-1.204-|Sample:1.90|use_time:19.838740825653076
loss: -1.204309312308707, EarlyStopping counter: 5 out of 300
EPOCH[979/2000] loss-1.204-|Sample:1.78|use_time:19.872140645980835
loss: -1.203978419303894, EarlyStopping counter: 6 out of 300
EPOCH[980/2000] loss-1.201-|Sample:2.11|use_time:19.25401782989502
loss: -1.2013271843514792, EarlyStopping counter: 7 out of 300
EPOCH[981/2000] loss-1.203-|Sample:0.95|use_time:19.72393012046814
loss: -1.2025464075367625, EarlyStopping counter: 8 out of 300
EPOCH[982/2000] loss-1.205-|Sample:0.96|use_time:19.06897521018982
loss: -1.2047703324294672, EarlyStopping counter: 9 out of 300
EPOCH[983/2000] loss-1.201-|Sample:2.17|use_time:20.1263267993927
loss: -1.2014464488843593, EarlyStopping counter: 10 out of 300
EPOCH[984/2000] loss-1.201-|Sample:1.79|use_time:19.749485969543457
loss: -1.2013274780133876, EarlyStopping counter: 11 out of 300
EPOCH[985/2000] loss-1.203-|Sample:1.96|use_time:19.181260347366333
loss: -1.2030976690897128, EarlyStopping counter: 12 out of 300
EPOCH[986/2000] loss-1.204-|Sample:2.07|use_time:19.953206300735474
loss: -1.2041284078504981, EarlyStopping counter: 13 out of 300
EPOCH[987/2000] loss-1.203-|Sample:1.78|use_time:19.710257530212402
loss: -1.202966992448016, EarlyStopping counter: 14 out of 300
EPOCH[988/2000] loss-1.201-|Sample:2.12|use_time:20.092793941497803
loss: -1.2011898959555276, EarlyStopping counter: 15 out of 300
EPOCH[989/2000] loss-1.203-|Sample:1.87|use_time:18.885229349136353
loss: -1.2028392989461014, EarlyStopping counter: 16 out of 300
EPOCH[990/2000] loss-1.205-|Sample:0.96|use_time:19.992811918258667
loss: -1.2047146907666835, EarlyStopping counter: 17 out of 300
EPOCH[991/2000] loss-1.202-|Sample:0.96|use_time:18.877787828445435
loss: -1.2022755262328357, EarlyStopping counter: 18 out of 300
EPOCH[992/2000] loss-1.203-|Sample:1.89|use_time:19.540698766708374
loss: -1.202974176988369, EarlyStopping counter: 19 out of 300
EPOCH[993/2000] loss-1.203-|Sample:1.77|use_time:19.829127073287964
loss: -1.203051663026577, EarlyStopping counter: 20 out of 300
EPOCH[994/2000] loss-1.204-|Sample:2.12|use_time:19.530142545700073
loss: -1.2040164325295426, EarlyStopping counter: 21 out of 300
EPOCH[995/2000] loss-1.205-|Sample:0.97|use_time:19.720335960388184
loss: -1.2046189511694558, EarlyStopping counter: 22 out of 300
EPOCH[996/2000] loss-1.200-|Sample:0.96|use_time:20.135661363601685
loss: -1.200037880641658, EarlyStopping counter: 23 out of 300
EPOCH[997/2000] loss-1.204-|Sample:0.96|use_time:18.83521866798401
loss: -1.204213840205495, EarlyStopping counter: 24 out of 300
EPOCH[998/2000] loss-1.203-|Sample:1.76|use_time:18.854341745376587
loss: -1.2033627004158207, EarlyStopping counter: 25 out of 300
EPOCH[999/2000] loss-1.201-|Sample:1.91|use_time:19.88845944404602
loss: -1.2005676554470528, EarlyStopping counter: 26 out of 300
EPOCH[1000/2000] loss-1.201-|Sample:2.06|use_time:19.79241180419922
loss: -1.2006530616341569, EarlyStopping counter: 27 out of 300
[TEST]
{'precision': array([0.02719101, 0.02003745, 0.01214482]), 'recall': array([0.11712027, 0.16765861, 0.25330632]), 'ndcg': array([0.07883469, 0.09426919, 0.1151416 ]), 'coverage': array([24.52309613, 28.60411985, 33.68614232]), 'Acoverage': array([ 514.02209738,  800.17915106, 1379.42059925]), 'ILD': array([0.71972812, 0.73685656, 0.76722505]), 'F1': array([0.20145764, 0.27316368, 0.3808662 ])}
test time: 70.32443404197693
reg_loss2: tensor(0.0120, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2206, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2037, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[1001/2000] loss-1.202-|Sample:0.96|use_time:20.414162158966064
loss: -1.2022977544040214, EarlyStopping counter: 28 out of 300
EPOCH[1002/2000] loss-1.203-|Sample:0.95|use_time:19.805266857147217
loss: -1.2029799484625094, EarlyStopping counter: 29 out of 300
EPOCH[1003/2000] loss-1.204-|Sample:0.96|use_time:18.62087917327881
loss: -1.2038262966202526, EarlyStopping counter: 30 out of 300
EPOCH[1004/2000] loss-1.204-|Sample:2.04|use_time:19.945274829864502
loss: -1.2035042832537395, EarlyStopping counter: 31 out of 300
EPOCH[1005/2000] loss-1.205-|Sample:1.79|use_time:19.73922610282898
loss: -1.2051211595535278, EarlyStopping counter: 32 out of 300
EPOCH[1006/2000] loss-1.201-|Sample:2.05|use_time:19.844547748565674
loss: -1.2010040195976817, EarlyStopping counter: 33 out of 300
EPOCH[1007/2000] loss-1.201-|Sample:1.98|use_time:18.9961416721344
loss: -1.2011471172658408, EarlyStopping counter: 34 out of 300
EPOCH[1008/2000] loss-1.203-|Sample:1.77|use_time:19.776124238967896
loss: -1.2033720656139095, EarlyStopping counter: 35 out of 300
EPOCH[1009/2000] loss-1.205-|Sample:2.12|use_time:20.106184720993042
loss: -1.2049936230589704, EarlyStopping counter: 36 out of 300
EPOCH[1010/2000] loss-1.204-|Sample:0.95|use_time:19.733079195022583
loss: -1.2039163054489508, EarlyStopping counter: 37 out of 300
EPOCH[1011/2000] loss-1.203-|Sample:0.95|use_time:18.795416593551636
loss: -1.2025100341657313, EarlyStopping counter: 38 out of 300
EPOCH[1012/2000] loss-1.203-|Sample:2.17|use_time:19.643613815307617
loss: -1.2025737297244188, EarlyStopping counter: 39 out of 300
EPOCH[1013/2000] loss-1.201-|Sample:1.88|use_time:19.74624252319336
loss: -1.2005937593739207, EarlyStopping counter: 40 out of 300
EPOCH[1014/2000] loss-1.200-|Sample:1.78|use_time:19.945427179336548
loss: -1.1995733569308025, EarlyStopping counter: 41 out of 300
EPOCH[1015/2000] loss-1.201-|Sample:0.95|use_time:19.887574672698975
loss: -1.2013712946961566, EarlyStopping counter: 42 out of 300
EPOCH[1016/2000] loss-1.205-|Sample:0.95|use_time:18.035524368286133
loss: -1.2047335839853055, EarlyStopping counter: 43 out of 300
EPOCH[1017/2000] loss-1.203-|Sample:1.89|use_time:19.75455641746521
loss: -1.2032320005137747, EarlyStopping counter: 44 out of 300
EPOCH[1018/2000] loss-1.205-|Sample:2.15|use_time:19.952736616134644
loss: -1.2049996067837971, EarlyStopping counter: 45 out of 300
EPOCH[1019/2000] loss-1.202-|Sample:1.77|use_time:19.626378059387207
loss: -1.2024604808993455, EarlyStopping counter: 46 out of 300
EPOCH[1020/2000] loss-1.202-|Sample:2.01|use_time:19.825206756591797
loss: -1.2024326120934836, EarlyStopping counter: 47 out of 300
EPOCH[1021/2000] loss-1.203-|Sample:2.07|use_time:19.581342458724976
loss: -1.2029032968893283, EarlyStopping counter: 48 out of 300
EPOCH[1022/2000] loss-1.205-|Sample:1.77|use_time:19.831618070602417
loss: -1.204978809124086, EarlyStopping counter: 49 out of 300
EPOCH[1023/2000] loss-1.203-|Sample:2.10|use_time:20.04765224456787
loss: -1.2027277481265184, EarlyStopping counter: 50 out of 300
EPOCH[1024/2000] loss-1.202-|Sample:0.95|use_time:19.570472240447998
loss: -1.201755305615867, EarlyStopping counter: 51 out of 300
EPOCH[1025/2000] loss-1.204-|Sample:0.93|use_time:18.02359938621521
loss: -1.2038442681475383, EarlyStopping counter: 52 out of 300
EPOCH[1026/2000] loss-1.203-|Sample:2.12|use_time:20.101231336593628
loss: -1.203256592517946, EarlyStopping counter: 53 out of 300
EPOCH[1027/2000] loss-1.202-|Sample:1.87|use_time:19.77360963821411
loss: -1.2017005391237212, EarlyStopping counter: 54 out of 300
EPOCH[1028/2000] loss-1.203-|Sample:1.78|use_time:19.90366268157959
loss: -1.2031741694706242, EarlyStopping counter: 55 out of 300
EPOCH[1029/2000] loss-1.202-|Sample:0.96|use_time:19.960905075073242
loss: -1.2020587979293451, EarlyStopping counter: 56 out of 300
EPOCH[1030/2000] loss-1.204-|Sample:0.94|use_time:19.275709629058838
loss: -1.204111735995223, EarlyStopping counter: 57 out of 300
EPOCH[1031/2000] loss-1.204-|Sample:0.94|use_time:18.872613191604614
loss: -1.2042244352945468, EarlyStopping counter: 58 out of 300
EPOCH[1032/2000] loss-1.204-|Sample:2.13|use_time:19.86720108985901
loss: -1.2044117886845658, EarlyStopping counter: 59 out of 300
EPOCH[1033/2000] loss-1.202-|Sample:1.78|use_time:19.51302695274353
loss: -1.201959580909915, EarlyStopping counter: 60 out of 300
EPOCH[1034/2000] loss-1.203-|Sample:1.92|use_time:19.136647701263428
loss: -1.2031457918446238, EarlyStopping counter: 61 out of 300
EPOCH[1035/2000] loss-1.203-|Sample:0.94|use_time:19.72044825553894
loss: -1.2032347510500652, EarlyStopping counter: 62 out of 300
EPOCH[1036/2000] loss-1.204-|Sample:0.95|use_time:19.640066385269165
loss: -1.2044567480319883, EarlyStopping counter: 63 out of 300
EPOCH[1037/2000] loss-1.204-|Sample:0.95|use_time:19.115864038467407
loss: -1.2035495682460506, EarlyStopping counter: 64 out of 300
EPOCH[1038/2000] loss-1.200-|Sample:2.04|use_time:19.96560263633728
loss: -1.1999579319139806, EarlyStopping counter: 65 out of 300
EPOCH[1039/2000] loss-1.205-|Sample:1.76|use_time:19.229368209838867
loss: -1.2048193070946671, EarlyStopping counter: 66 out of 300
EPOCH[1040/2000] loss-1.203-|Sample:2.05|use_time:20.12198781967163
loss: -1.2028728229243582, EarlyStopping counter: 67 out of 300
EPOCH[1041/2000] loss-1.203-|Sample:0.96|use_time:19.724251747131348
loss: -1.202798151388401, EarlyStopping counter: 68 out of 300
EPOCH[1042/2000] loss-1.205-|Sample:0.93|use_time:18.719979524612427
loss: -1.2053796808894088, EarlyStopping counter: 69 out of 300
EPOCH[1043/2000] loss-1.203-|Sample:2.10|use_time:19.111647129058838
loss: -1.2028569390134114, EarlyStopping counter: 70 out of 300
EPOCH[1044/2000] loss-1.204-|Sample:1.94|use_time:19.552324771881104
loss: -1.2037631098817034, EarlyStopping counter: 71 out of 300
EPOCH[1045/2000] loss-1.203-|Sample:1.75|use_time:19.64147400856018
loss: -1.2026428274992036, EarlyStopping counter: 72 out of 300
EPOCH[1046/2000] loss-1.203-|Sample:2.16|use_time:19.800899267196655
loss: -1.2028500190595302, EarlyStopping counter: 73 out of 300
EPOCH[1047/2000] loss-1.202-|Sample:1.87|use_time:19.839675426483154
loss: -1.2019525475618316, EarlyStopping counter: 74 out of 300
EPOCH[1048/2000] loss-1.203-|Sample:1.84|use_time:19.478657722473145
loss: -1.203287008332043, EarlyStopping counter: 75 out of 300
EPOCH[1049/2000] loss-1.206-|Sample:2.08|use_time:19.868998527526855
EPOCH[1050/2000] loss-1.206-|Sample:0.94|use_time:19.589920043945312
[TEST]
{'precision': array([0.02729089, 0.0202372 , 0.01214232]), 'recall': array([0.11623448, 0.1695863 , 0.25153187]), 'ndcg': array([0.07961698, 0.0958859 , 0.11608615]), 'coverage': array([24.67390762, 28.77490637, 33.76217228]), 'Acoverage': array([ 518.44843945,  810.61498127, 1389.49612984]), 'ILD': array([0.7183798 , 0.73661082, 0.76716553]), 'F1': array([0.20009363, 0.27569963, 0.37884965])}
test time: 70.3493287563324
reg_loss2: tensor(0.0118, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2044, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2113, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[1051/2000] loss-1.202-|Sample:0.95|use_time:19.66690945625305
loss: -1.202103399648899, EarlyStopping counter: 1 out of 300
EPOCH[1052/2000] loss-1.203-|Sample:2.09|use_time:19.08094549179077
loss: -1.20286315534173, EarlyStopping counter: 2 out of 300
EPOCH[1053/2000] loss-1.202-|Sample:1.93|use_time:19.64425039291382
loss: -1.2024569656790756, EarlyStopping counter: 3 out of 300
EPOCH[1054/2000] loss-1.201-|Sample:1.77|use_time:19.467095136642456
loss: -1.201347900599968, EarlyStopping counter: 4 out of 300
EPOCH[1055/2000] loss-1.205-|Sample:2.09|use_time:19.801754236221313
loss: -1.204923722802139, EarlyStopping counter: 5 out of 300
EPOCH[1056/2000] loss-1.204-|Sample:1.87|use_time:19.4894757270813
loss: -1.2038739512606365, EarlyStopping counter: 6 out of 300
EPOCH[1057/2000] loss-1.202-|Sample:1.75|use_time:19.365758419036865
loss: -1.2017948220415813, EarlyStopping counter: 7 out of 300
EPOCH[1058/2000] loss-1.204-|Sample:0.95|use_time:19.943294763565063
loss: -1.2037746789978772, EarlyStopping counter: 8 out of 300
EPOCH[1059/2000] loss-1.204-|Sample:0.94|use_time:18.622761011123657
loss: -1.2040014005288846, EarlyStopping counter: 9 out of 300
EPOCH[1060/2000] loss-1.204-|Sample:1.76|use_time:19.558807134628296
loss: -1.2041475394876993, EarlyStopping counter: 10 out of 300
EPOCH[1061/2000] loss-1.203-|Sample:2.16|use_time:19.20395255088806
loss: -1.2032386355283784, EarlyStopping counter: 11 out of 300
EPOCH[1062/2000] loss-1.200-|Sample:1.83|use_time:19.727581024169922
loss: -1.1998976323662736, EarlyStopping counter: 12 out of 300
EPOCH[1063/2000] loss-1.203-|Sample:0.96|use_time:20.044600248336792
loss: -1.2030631332862667, EarlyStopping counter: 13 out of 300
EPOCH[1064/2000] loss-1.205-|Sample:0.94|use_time:19.76039409637451
loss: -1.2049585842504733, EarlyStopping counter: 14 out of 300
EPOCH[1065/2000] loss-1.205-|Sample:0.94|use_time:18.71449565887451
loss: -1.205442347177645, EarlyStopping counter: 15 out of 300
EPOCH[1066/2000] loss-1.202-|Sample:1.94|use_time:19.32826566696167
loss: -1.202442087778231, EarlyStopping counter: 16 out of 300
EPOCH[1067/2000] loss-1.202-|Sample:2.05|use_time:19.94501566886902
loss: -1.202004290208584, EarlyStopping counter: 17 out of 300
EPOCH[1068/2000] loss-1.203-|Sample:1.76|use_time:19.73929190635681
loss: -1.2032013346509236, EarlyStopping counter: 18 out of 300
EPOCH[1069/2000] loss-1.203-|Sample:0.94|use_time:20.059672355651855
loss: -1.202909266076437, EarlyStopping counter: 19 out of 300
EPOCH[1070/2000] loss-1.204-|Sample:0.96|use_time:18.833519458770752
loss: -1.2041670461980307, EarlyStopping counter: 20 out of 300
EPOCH[1071/2000] loss-1.204-|Sample:0.94|use_time:18.876799821853638
loss: -1.2043197358526834, EarlyStopping counter: 21 out of 300
EPOCH[1072/2000] loss-1.201-|Sample:2.10|use_time:19.895812273025513
loss: -1.2006657588772658, EarlyStopping counter: 22 out of 300
EPOCH[1073/2000] loss-1.202-|Sample:1.87|use_time:19.762330293655396
loss: -1.202315818972704, EarlyStopping counter: 23 out of 300
EPOCH[1074/2000] loss-1.203-|Sample:1.77|use_time:19.72182846069336
loss: -1.2026068582767393, EarlyStopping counter: 24 out of 300
EPOCH[1075/2000] loss-1.205-|Sample:0.95|use_time:19.620399475097656
loss: -1.2049117960580966, EarlyStopping counter: 25 out of 300
EPOCH[1076/2000] loss-1.203-|Sample:0.94|use_time:18.69069266319275
loss: -1.2029602295014916, EarlyStopping counter: 26 out of 300
EPOCH[1077/2000] loss-1.203-|Sample:1.76|use_time:19.740792989730835
loss: -1.2029701529479608, EarlyStopping counter: 27 out of 300
EPOCH[1078/2000] loss-1.203-|Sample:2.17|use_time:19.862236976623535
loss: -1.2026878595352173, EarlyStopping counter: 28 out of 300
EPOCH[1079/2000] loss-1.202-|Sample:1.84|use_time:18.781681299209595
loss: -1.2015330995001443, EarlyStopping counter: 29 out of 300
EPOCH[1080/2000] loss-1.203-|Sample:1.78|use_time:19.755088806152344
loss: -1.2031160040599544, EarlyStopping counter: 30 out of 300
EPOCH[1081/2000] loss-1.201-|Sample:2.21|use_time:20.127816915512085
loss: -1.2013469236653025, EarlyStopping counter: 31 out of 300
EPOCH[1082/2000] loss-1.204-|Sample:1.77|use_time:19.687527894973755
loss: -1.2043549549288866, EarlyStopping counter: 32 out of 300
EPOCH[1083/2000] loss-1.205-|Sample:1.94|use_time:20.2208993434906
loss: -1.2047254922913342, EarlyStopping counter: 33 out of 300
EPOCH[1084/2000] loss-1.202-|Sample:0.94|use_time:19.474819660186768
loss: -1.2023959421530002, EarlyStopping counter: 34 out of 300
EPOCH[1085/2000] loss-1.203-|Sample:0.95|use_time:18.850202560424805
loss: -1.203060086180524, EarlyStopping counter: 35 out of 300
EPOCH[1086/2000] loss-1.203-|Sample:2.09|use_time:19.972896575927734
loss: -1.2030015573268984, EarlyStopping counter: 36 out of 300
EPOCH[1087/2000] loss-1.205-|Sample:1.95|use_time:19.764905214309692
loss: -1.2051409366654187, EarlyStopping counter: 37 out of 300
EPOCH[1088/2000] loss-1.202-|Sample:1.75|use_time:18.921252965927124
loss: -1.2024279338557546, EarlyStopping counter: 38 out of 300
EPOCH[1089/2000] loss-1.203-|Sample:0.94|use_time:20.10960292816162
loss: -1.203341254373876, EarlyStopping counter: 39 out of 300
EPOCH[1090/2000] loss-1.205-|Sample:0.94|use_time:19.624953746795654
loss: -1.2048345891440786, EarlyStopping counter: 40 out of 300
EPOCH[1091/2000] loss-1.204-|Sample:0.95|use_time:18.71921443939209
loss: -1.2038005764891462, EarlyStopping counter: 41 out of 300
EPOCH[1092/2000] loss-1.203-|Sample:2.14|use_time:19.808138847351074
loss: -1.2027107186433745, EarlyStopping counter: 42 out of 300
EPOCH[1093/2000] loss-1.203-|Sample:1.87|use_time:19.073256015777588
loss: -1.202720136177249, EarlyStopping counter: 43 out of 300
EPOCH[1094/2000] loss-1.202-|Sample:1.80|use_time:19.93556809425354
loss: -1.2018283518349253, EarlyStopping counter: 44 out of 300
EPOCH[1095/2000] loss-1.201-|Sample:0.95|use_time:20.075802087783813
loss: -1.200697198146727, EarlyStopping counter: 45 out of 300
EPOCH[1096/2000] loss-1.205-|Sample:0.94|use_time:19.75480842590332
loss: -1.2050097046828852, EarlyStopping counter: 46 out of 300
EPOCH[1097/2000] loss-1.204-|Sample:0.94|use_time:18.202322959899902
loss: -1.2035214755593278, EarlyStopping counter: 47 out of 300
EPOCH[1098/2000] loss-1.202-|Sample:2.07|use_time:19.819483518600464
loss: -1.2015278339385986, EarlyStopping counter: 48 out of 300
EPOCH[1099/2000] loss-1.203-|Sample:1.76|use_time:19.533885955810547
loss: -1.2033505817738974, EarlyStopping counter: 49 out of 300
EPOCH[1100/2000] loss-1.202-|Sample:1.96|use_time:19.85997176170349
loss: -1.202086469022239, EarlyStopping counter: 50 out of 300
[TEST]
{'precision': array([0.02712859, 0.02006242, 0.01210487]), 'recall': array([0.1175658 , 0.16843334, 0.25150345]), 'ndcg': array([0.07919752, 0.094802  , 0.11526109]), 'coverage': array([24.54644195, 28.87066167, 33.68876404]), 'Acoverage': array([ 524.6380774 ,  817.44307116, 1401.81248439]), 'ILD': array([0.71590789, 0.73508575, 0.76703315]), 'F1': array([0.20196506, 0.27406826, 0.37880127])}
test time: 70.40162992477417
reg_loss2: tensor(0.0116, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2240, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2146, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[1101/2000] loss-1.203-|Sample:0.95|use_time:20.528868198394775
loss: -1.203023424962672, EarlyStopping counter: 51 out of 300
EPOCH[1102/2000] loss-1.204-|Sample:0.95|use_time:18.483444213867188
loss: -1.2038634782884179, EarlyStopping counter: 52 out of 300
EPOCH[1103/2000] loss-1.204-|Sample:1.81|use_time:19.7457172870636
loss: -1.2036036456503518, EarlyStopping counter: 53 out of 300
EPOCH[1104/2000] loss-1.205-|Sample:1.87|use_time:19.98958730697632
loss: -1.2046705862370932, EarlyStopping counter: 54 out of 300
EPOCH[1105/2000] loss-1.203-|Sample:0.94|use_time:19.830333471298218
loss: -1.203262250597884, EarlyStopping counter: 55 out of 300
EPOCH[1106/2000] loss-1.204-|Sample:0.95|use_time:18.849342107772827
loss: -1.2035587822518699, EarlyStopping counter: 56 out of 300
EPOCH[1107/2000] loss-1.202-|Sample:0.95|use_time:18.94853401184082
loss: -1.2021351151350068, EarlyStopping counter: 57 out of 300
EPOCH[1108/2000] loss-1.201-|Sample:2.06|use_time:20.81346297264099
loss: -1.201296858671235, EarlyStopping counter: 58 out of 300
EPOCH[1109/2000] loss-1.203-|Sample:0.95|use_time:18.762383460998535
loss: -1.2030613887600783, EarlyStopping counter: 59 out of 300
EPOCH[1110/2000] loss-1.203-|Sample:2.09|use_time:19.889001846313477
loss: -1.203426148833298, EarlyStopping counter: 60 out of 300
EPOCH[1111/2000] loss-1.204-|Sample:1.92|use_time:19.31951904296875
loss: -1.204104458413473, EarlyStopping counter: 61 out of 300
EPOCH[1112/2000] loss-1.202-|Sample:0.94|use_time:19.877037525177002
loss: -1.2016024415085955, EarlyStopping counter: 62 out of 300
EPOCH[1113/2000] loss-1.203-|Sample:0.94|use_time:19.98386788368225
loss: -1.2026362302826672, EarlyStopping counter: 63 out of 300
EPOCH[1114/2000] loss-1.204-|Sample:0.94|use_time:18.714759826660156
loss: -1.2038492836603305, EarlyStopping counter: 64 out of 300
EPOCH[1115/2000] loss-1.202-|Sample:1.77|use_time:18.92786693572998
loss: -1.202152827890908, EarlyStopping counter: 65 out of 300
EPOCH[1116/2000] loss-1.201-|Sample:2.13|use_time:19.975599765777588
loss: -1.2011687871886463, EarlyStopping counter: 66 out of 300
EPOCH[1117/2000] loss-1.203-|Sample:0.93|use_time:19.54172706604004
loss: -1.2030024819257783, EarlyStopping counter: 67 out of 300
EPOCH[1118/2000] loss-1.205-|Sample:0.96|use_time:19.946322441101074
loss: -1.2053012760674082, EarlyStopping counter: 68 out of 300
EPOCH[1119/2000] loss-1.205-|Sample:0.95|use_time:18.961897373199463
loss: -1.2049645214546016, EarlyStopping counter: 69 out of 300
EPOCH[1120/2000] loss-1.201-|Sample:1.79|use_time:19.169641256332397
loss: -1.2014748352329905, EarlyStopping counter: 70 out of 300
EPOCH[1121/2000] loss-1.204-|Sample:1.91|use_time:19.88308048248291
loss: -1.203881635898497, EarlyStopping counter: 71 out of 300
EPOCH[1122/2000] loss-1.205-|Sample:2.05|use_time:19.907154321670532
loss: -1.2053465407069137, EarlyStopping counter: 72 out of 300
EPOCH[1123/2000] loss-1.202-|Sample:0.94|use_time:19.713886737823486
loss: -1.2022830335105337, EarlyStopping counter: 73 out of 300
EPOCH[1124/2000] loss-1.206-|Sample:0.95|use_time:19.357391834259033
loss: -1.2061285856293469, EarlyStopping counter: 74 out of 300
EPOCH[1125/2000] loss-1.203-|Sample:0.94|use_time:18.883561611175537
loss: -1.2027656973862066, EarlyStopping counter: 75 out of 300
EPOCH[1126/2000] loss-1.204-|Sample:1.74|use_time:19.688724756240845
loss: -1.203599066269107, EarlyStopping counter: 76 out of 300
EPOCH[1127/2000] loss-1.202-|Sample:2.07|use_time:20.026928424835205
loss: -1.201658193658038, EarlyStopping counter: 77 out of 300
EPOCH[1128/2000] loss-1.203-|Sample:1.88|use_time:19.791337251663208
loss: -1.2028504348382718, EarlyStopping counter: 78 out of 300
EPOCH[1129/2000] loss-1.204-|Sample:0.95|use_time:19.42177391052246
loss: -1.2035678915861177, EarlyStopping counter: 79 out of 300
EPOCH[1130/2000] loss-1.205-|Sample:0.95|use_time:18.943533182144165
loss: -1.205021041195567, EarlyStopping counter: 80 out of 300
EPOCH[1131/2000] loss-1.203-|Sample:1.89|use_time:19.70342254638672
loss: -1.2032458549592553, EarlyStopping counter: 81 out of 300
EPOCH[1132/2000] loss-1.206-|Sample:1.75|use_time:19.757073402404785
loss: -1.2057429261323882, EarlyStopping counter: 82 out of 300
EPOCH[1133/2000] loss-1.205-|Sample:2.17|use_time:19.18367338180542
loss: -1.205078456459976, EarlyStopping counter: 83 out of 300
EPOCH[1134/2000] loss-1.204-|Sample:1.87|use_time:19.761026620864868
loss: -1.2037784064688333, EarlyStopping counter: 84 out of 300
EPOCH[1135/2000] loss-1.204-|Sample:1.77|use_time:19.842670440673828
loss: -1.2035365308203347, EarlyStopping counter: 85 out of 300
EPOCH[1136/2000] loss-1.200-|Sample:2.12|use_time:20.15893244743347
loss: -1.2004069351568454, EarlyStopping counter: 86 out of 300
EPOCH[1137/2000] loss-1.202-|Sample:1.76|use_time:19.701066493988037
loss: -1.2021167539968722, EarlyStopping counter: 87 out of 300
EPOCH[1138/2000] loss-1.205-|Sample:0.95|use_time:19.62525773048401
loss: -1.2054321736824223, EarlyStopping counter: 88 out of 300
EPOCH[1139/2000] loss-1.204-|Sample:0.94|use_time:18.773619890213013
loss: -1.204371420348563, EarlyStopping counter: 89 out of 300
EPOCH[1140/2000] loss-1.204-|Sample:1.78|use_time:19.759076833724976
loss: -1.2035362400659702, EarlyStopping counter: 90 out of 300
EPOCH[1141/2000] loss-1.201-|Sample:1.98|use_time:19.970104455947876
loss: -1.2014274073810112, EarlyStopping counter: 91 out of 300
EPOCH[1142/2000] loss-1.203-|Sample:2.03|use_time:19.110640287399292
loss: -1.2028624110105561, EarlyStopping counter: 92 out of 300
EPOCH[1143/2000] loss-1.203-|Sample:0.94|use_time:19.81925129890442
loss: -1.2032384552606723, EarlyStopping counter: 93 out of 300
EPOCH[1144/2000] loss-1.205-|Sample:1.34|use_time:24.75570797920227
loss: -1.205171114060937, EarlyStopping counter: 94 out of 300
EPOCH[1145/2000] loss-1.205-|Sample:1.33|use_time:22.264281272888184
loss: -1.2045041177330948, EarlyStopping counter: 95 out of 300
EPOCH[1146/2000] loss-1.202-|Sample:3.01|use_time:23.085909366607666
loss: -1.2022470381201766, EarlyStopping counter: 96 out of 300
EPOCH[1147/2000] loss-1.203-|Sample:2.45|use_time:23.30365252494812
loss: -1.20343794764542, EarlyStopping counter: 97 out of 300
EPOCH[1148/2000] loss-1.204-|Sample:2.91|use_time:23.743236780166626
loss: -1.2035590671911471, EarlyStopping counter: 98 out of 300
EPOCH[1149/2000] loss-1.207-|Sample:0.95|use_time:20.78165054321289
EPOCH[1150/2000] loss-1.208-|Sample:0.95|use_time:20.828518867492676
[TEST]
{'precision': array([0.02730337, 0.02007491, 0.01210487]), 'recall': array([0.11712117, 0.16791749, 0.24918052]), 'ndcg': array([0.07987305, 0.0953465 , 0.11550861]), 'coverage': array([24.8741573 , 28.82184769, 33.74531835]), 'Acoverage': array([ 531.22372035,  824.38027466, 1409.65430712]), 'ILD': array([0.71896518, 0.73525133, 0.76627094]), 'F1': array([0.20142906, 0.27339641, 0.37606877])}
test time: 70.50655150413513
reg_loss2: tensor(0.0115, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2257, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2074, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[1151/2000] loss-1.202-|Sample:0.97|use_time:20.213961839675903
loss: -1.2021365020333268, EarlyStopping counter: 1 out of 300
EPOCH[1152/2000] loss-1.202-|Sample:2.52|use_time:21.05523943901062
loss: -1.202112020515814, EarlyStopping counter: 2 out of 300
EPOCH[1153/2000] loss-1.205-|Sample:1.88|use_time:19.825902223587036
loss: -1.2052925708817273, EarlyStopping counter: 3 out of 300
EPOCH[1154/2000] loss-1.204-|Sample:1.84|use_time:18.990826845169067
loss: -1.2037034529011423, EarlyStopping counter: 4 out of 300
EPOCH[1155/2000] loss-1.203-|Sample:2.11|use_time:22.497997283935547
loss: -1.2029985422041358, EarlyStopping counter: 5 out of 300
EPOCH[1156/2000] loss-1.203-|Sample:2.37|use_time:20.580132722854614
loss: -1.20339479969769, EarlyStopping counter: 6 out of 300
EPOCH[1157/2000] loss-1.205-|Sample:2.04|use_time:20.26872944831848
loss: -1.2048338797034286, EarlyStopping counter: 7 out of 300
EPOCH[1158/2000] loss-1.203-|Sample:0.96|use_time:19.249154329299927
loss: -1.2034378778643724, EarlyStopping counter: 8 out of 300
EPOCH[1159/2000] loss-1.203-|Sample:0.94|use_time:19.043592929840088
loss: -1.2032773669173078, EarlyStopping counter: 9 out of 300
EPOCH[1160/2000] loss-1.204-|Sample:2.01|use_time:20.05238628387451
loss: -1.2041968659656803, EarlyStopping counter: 10 out of 300
EPOCH[1161/2000] loss-1.203-|Sample:2.42|use_time:22.187299966812134
loss: -1.2028266540387782, EarlyStopping counter: 11 out of 300
EPOCH[1162/2000] loss-1.204-|Sample:2.79|use_time:21.019030570983887
loss: -1.2039214634313815, EarlyStopping counter: 12 out of 300
EPOCH[1163/2000] loss-1.202-|Sample:0.96|use_time:21.187612533569336
loss: -1.2024833370999592, EarlyStopping counter: 13 out of 300
EPOCH[1164/2000] loss-1.203-|Sample:0.94|use_time:18.75831151008606
loss: -1.2025036695526867, EarlyStopping counter: 14 out of 300
EPOCH[1165/2000] loss-1.202-|Sample:1.76|use_time:19.633065462112427
loss: -1.2020987737469557, EarlyStopping counter: 15 out of 300
EPOCH[1166/2000] loss-1.203-|Sample:2.15|use_time:19.90411877632141
loss: -1.2025944081748403, EarlyStopping counter: 16 out of 300
EPOCH[1167/2000] loss-1.203-|Sample:1.92|use_time:19.200685501098633
loss: -1.2034779380007488, EarlyStopping counter: 17 out of 300
EPOCH[1168/2000] loss-1.205-|Sample:1.76|use_time:19.73568367958069
loss: -1.2051961654570045, EarlyStopping counter: 18 out of 300
EPOCH[1169/2000] loss-1.204-|Sample:2.20|use_time:20.110645294189453
loss: -1.2036115687067916, EarlyStopping counter: 19 out of 300
EPOCH[1170/2000] loss-1.202-|Sample:1.81|use_time:19.70952868461609
loss: -1.2022394639689749, EarlyStopping counter: 20 out of 300
EPOCH[1171/2000] loss-1.205-|Sample:1.89|use_time:19.207277297973633
loss: -1.2047788166418307, EarlyStopping counter: 21 out of 300
EPOCH[1172/2000] loss-1.204-|Sample:0.95|use_time:19.684850931167603
loss: -1.2044068923810634, EarlyStopping counter: 22 out of 300
EPOCH[1173/2000] loss-1.204-|Sample:0.94|use_time:18.9221510887146
loss: -1.2035208969581417, EarlyStopping counter: 23 out of 300
EPOCH[1174/2000] loss-1.204-|Sample:1.97|use_time:19.954622268676758
loss: -1.2043424873817257, EarlyStopping counter: 24 out of 300
EPOCH[1175/2000] loss-1.203-|Sample:2.01|use_time:19.89636731147766
loss: -1.2031967988828334, EarlyStopping counter: 25 out of 300
EPOCH[1176/2000] loss-1.204-|Sample:1.77|use_time:19.557081937789917
loss: -1.2036434877209548, EarlyStopping counter: 26 out of 300
EPOCH[1177/2000] loss-1.202-|Sample:0.94|use_time:19.988327026367188
loss: -1.2018355770808895, EarlyStopping counter: 27 out of 300
EPOCH[1178/2000] loss-1.203-|Sample:0.94|use_time:19.47012162208557
loss: -1.2032741220985972, EarlyStopping counter: 28 out of 300
EPOCH[1179/2000] loss-1.205-|Sample:0.95|use_time:18.68176794052124
loss: -1.2053508322413375, EarlyStopping counter: 29 out of 300
EPOCH[1180/2000] loss-1.203-|Sample:2.16|use_time:19.8629469871521
loss: -1.2032743925001563, EarlyStopping counter: 30 out of 300
EPOCH[1181/2000] loss-1.206-|Sample:1.87|use_time:19.55907106399536
loss: -1.2055515632396792, EarlyStopping counter: 31 out of 300
EPOCH[1182/2000] loss-1.204-|Sample:1.76|use_time:19.004799127578735
loss: -1.2044730215537838, EarlyStopping counter: 32 out of 300
EPOCH[1183/2000] loss-1.203-|Sample:0.94|use_time:19.085036754608154
loss: -1.2031742276214972, EarlyStopping counter: 33 out of 300
EPOCH[1184/2000] loss-1.206-|Sample:0.98|use_time:18.708028554916382
loss: -1.2057504624855229, EarlyStopping counter: 34 out of 300
EPOCH[1185/2000] loss-1.203-|Sample:0.95|use_time:18.05433416366577
loss: -1.2029137873068088, EarlyStopping counter: 35 out of 300
EPOCH[1186/2000] loss-1.202-|Sample:2.18|use_time:19.876644134521484
loss: -1.2019007031510516, EarlyStopping counter: 36 out of 300
EPOCH[1187/2000] loss-1.205-|Sample:1.85|use_time:19.73900008201599
loss: -1.2052080922010469, EarlyStopping counter: 37 out of 300
EPOCH[1188/2000] loss-1.205-|Sample:1.89|use_time:19.831759452819824
loss: -1.2046539841628656, EarlyStopping counter: 38 out of 300
EPOCH[1189/2000] loss-1.203-|Sample:0.95|use_time:19.746521949768066
loss: -1.2033552861795194, EarlyStopping counter: 39 out of 300
EPOCH[1190/2000] loss-1.204-|Sample:0.94|use_time:18.096118450164795
loss: -1.204399042013215, EarlyStopping counter: 40 out of 300
EPOCH[1191/2000] loss-1.201-|Sample:1.93|use_time:19.840983867645264
loss: -1.2011906868073998, EarlyStopping counter: 41 out of 300
EPOCH[1192/2000] loss-1.206-|Sample:2.10|use_time:19.968559741973877
loss: -1.2061192843972184, EarlyStopping counter: 42 out of 300
EPOCH[1193/2000] loss-1.205-|Sample:1.75|use_time:19.67962145805359
loss: -1.2046331254447378, EarlyStopping counter: 43 out of 300
EPOCH[1194/2000] loss-1.203-|Sample:2.04|use_time:19.05713176727295
loss: -1.203114556103218, EarlyStopping counter: 44 out of 300
EPOCH[1195/2000] loss-1.205-|Sample:1.98|use_time:19.611753940582275
loss: -1.2054437457061395, EarlyStopping counter: 45 out of 300
EPOCH[1196/2000] loss-1.203-|Sample:1.76|use_time:19.71792221069336
loss: -1.202856726762725, EarlyStopping counter: 46 out of 300
EPOCH[1197/2000] loss-1.201-|Sample:2.11|use_time:20.099413633346558
loss: -1.2007139979339227, EarlyStopping counter: 47 out of 300
EPOCH[1198/2000] loss-1.203-|Sample:0.95|use_time:19.8387508392334
loss: -1.203261558602496, EarlyStopping counter: 48 out of 300
EPOCH[1199/2000] loss-1.202-|Sample:0.96|use_time:18.306196451187134
loss: -1.2024566778322545, EarlyStopping counter: 49 out of 300
EPOCH[1200/2000] loss-1.202-|Sample:2.18|use_time:20.081648349761963
loss: -1.2022293864226923, EarlyStopping counter: 50 out of 300
[TEST]
{'precision': array([0.02742821, 0.0200437 , 0.01205993]), 'recall': array([0.1172919 , 0.16715256, 0.24817965]), 'ndcg': array([0.07951226, 0.0947532 , 0.11477908]), 'coverage': array([24.83695381, 29.11922597, 33.86966292]), 'Acoverage': array([ 534.50424469,  828.52209738, 1417.11598002]), 'ILD': array([0.71578582, 0.73376503, 0.76601524]), 'F1': array([0.20155594, 0.27227952, 0.37489717])}
test time: 70.18777298927307
reg_loss2: tensor(0.0114, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.1855, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2058, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[1201/2000] loss-1.203-|Sample:2.37|use_time:20.373798608779907
loss: -1.2027558669811342, EarlyStopping counter: 51 out of 300
EPOCH[1202/2000] loss-1.205-|Sample:2.03|use_time:20.054887294769287
loss: -1.2048973310284499, EarlyStopping counter: 52 out of 300
EPOCH[1203/2000] loss-1.205-|Sample:0.94|use_time:18.775554418563843
loss: -1.2047451821769155, EarlyStopping counter: 53 out of 300
EPOCH[1204/2000] loss-1.204-|Sample:0.94|use_time:18.89408302307129
loss: -1.2037220728106615, EarlyStopping counter: 54 out of 300
EPOCH[1205/2000] loss-1.203-|Sample:2.15|use_time:20.10196876525879
loss: -1.2032537634779767, EarlyStopping counter: 55 out of 300
EPOCH[1206/2000] loss-1.204-|Sample:1.83|use_time:19.74982500076294
loss: -1.2038267531046054, EarlyStopping counter: 56 out of 300
EPOCH[1207/2000] loss-1.205-|Sample:1.83|use_time:19.82599902153015
loss: -1.2049816934073843, EarlyStopping counter: 57 out of 300
EPOCH[1208/2000] loss-1.203-|Sample:2.13|use_time:19.541719436645508
loss: -1.202942397536301, EarlyStopping counter: 58 out of 300
EPOCH[1209/2000] loss-1.203-|Sample:1.76|use_time:19.777137756347656
loss: -1.2026537656784058, EarlyStopping counter: 59 out of 300
EPOCH[1210/2000] loss-1.203-|Sample:2.01|use_time:20.085973739624023
loss: -1.2025725550767852, EarlyStopping counter: 60 out of 300
EPOCH[1211/2000] loss-1.207-|Sample:1.92|use_time:19.59922194480896
loss: -1.207057740630173, EarlyStopping counter: 61 out of 300
EPOCH[1212/2000] loss-1.204-|Sample:0.94|use_time:19.051188707351685
loss: -1.2035719185340694, EarlyStopping counter: 62 out of 300
EPOCH[1213/2000] loss-1.202-|Sample:0.95|use_time:18.924607753753662
loss: -1.2021634578704834, EarlyStopping counter: 63 out of 300
EPOCH[1214/2000] loss-1.202-|Sample:1.95|use_time:19.58872079849243
loss: -1.201638465974389, EarlyStopping counter: 64 out of 300
EPOCH[1215/2000] loss-1.203-|Sample:1.74|use_time:19.492865324020386
loss: -1.2026621859248092, EarlyStopping counter: 65 out of 300
EPOCH[1216/2000] loss-1.201-|Sample:2.12|use_time:19.964745044708252
loss: -1.2011363593543447, EarlyStopping counter: 66 out of 300
EPOCH[1217/2000] loss-1.205-|Sample:0.95|use_time:18.961562633514404
loss: -1.2049173756343563, EarlyStopping counter: 67 out of 300
EPOCH[1218/2000] loss-1.205-|Sample:0.94|use_time:20.035972833633423
loss: -1.2045179634559444, EarlyStopping counter: 68 out of 300
EPOCH[1219/2000] loss-1.204-|Sample:0.96|use_time:18.887189865112305
loss: -1.2036927182499955, EarlyStopping counter: 69 out of 300
EPOCH[1220/2000] loss-1.205-|Sample:1.87|use_time:19.780362844467163
loss: -1.2050899354422964, EarlyStopping counter: 70 out of 300
EPOCH[1221/2000] loss-1.204-|Sample:1.80|use_time:18.952399492263794
loss: -1.20439517207262, EarlyStopping counter: 71 out of 300
EPOCH[1222/2000] loss-1.203-|Sample:2.12|use_time:20.09456777572632
loss: -1.2025186026968606, EarlyStopping counter: 72 out of 300
EPOCH[1223/2000] loss-1.204-|Sample:0.93|use_time:19.679636478424072
loss: -1.2039689494342338, EarlyStopping counter: 73 out of 300
EPOCH[1224/2000] loss-1.204-|Sample:0.95|use_time:18.997518062591553
loss: -1.204022698286103, EarlyStopping counter: 74 out of 300
EPOCH[1225/2000] loss-1.203-|Sample:2.12|use_time:19.90728449821472
loss: -1.2027707361593478, EarlyStopping counter: 75 out of 300
EPOCH[1226/2000] loss-1.204-|Sample:1.75|use_time:18.92090106010437
loss: -1.2037969624123923, EarlyStopping counter: 76 out of 300
EPOCH[1227/2000] loss-1.204-|Sample:1.94|use_time:19.81285572052002
loss: -1.2043886504522183, EarlyStopping counter: 77 out of 300
EPOCH[1228/2000] loss-1.202-|Sample:2.06|use_time:19.94269847869873
loss: -1.2024613822378762, EarlyStopping counter: 78 out of 300
EPOCH[1229/2000] loss-1.204-|Sample:1.76|use_time:19.699402570724487
loss: -1.203808944399764, EarlyStopping counter: 79 out of 300
EPOCH[1230/2000] loss-1.204-|Sample:2.04|use_time:19.178642511367798
loss: -1.2042713775867369, EarlyStopping counter: 80 out of 300
EPOCH[1231/2000] loss-1.203-|Sample:1.88|use_time:19.580894947052002
loss: -1.2028587591357347, EarlyStopping counter: 81 out of 300
EPOCH[1232/2000] loss-1.203-|Sample:0.94|use_time:19.619696378707886
loss: -1.203288683077184, EarlyStopping counter: 82 out of 300
EPOCH[1233/2000] loss-1.208-|Sample:0.95|use_time:19.146250009536743
EPOCH[1234/2000] loss-1.206-|Sample:1.96|use_time:19.898439168930054
loss: -1.2064168656744607, EarlyStopping counter: 1 out of 300
EPOCH[1235/2000] loss-1.204-|Sample:1.76|use_time:19.249282360076904
loss: -1.2044909116698475, EarlyStopping counter: 2 out of 300
EPOCH[1236/2000] loss-1.205-|Sample:2.13|use_time:20.08017325401306
loss: -1.2047758276869611, EarlyStopping counter: 3 out of 300
EPOCH[1237/2000] loss-1.206-|Sample:0.95|use_time:19.682825565338135
loss: -1.2062564855668603, EarlyStopping counter: 4 out of 300
EPOCH[1238/2000] loss-1.202-|Sample:0.93|use_time:19.956716299057007
loss: -1.2020746876553792, EarlyStopping counter: 5 out of 300
EPOCH[1239/2000] loss-1.205-|Sample:0.94|use_time:18.138439893722534
loss: -1.205013682202595, EarlyStopping counter: 6 out of 300
EPOCH[1240/2000] loss-1.204-|Sample:1.78|use_time:19.587026357650757
loss: -1.2038174286121275, EarlyStopping counter: 7 out of 300
EPOCH[1241/2000] loss-1.205-|Sample:2.13|use_time:23.78290104866028
loss: -1.2047726788171909, EarlyStopping counter: 8 out of 300
EPOCH[1242/2000] loss-1.203-|Sample:3.04|use_time:23.918931484222412
loss: -1.2032548567143881, EarlyStopping counter: 9 out of 300
EPOCH[1243/2000] loss-1.203-|Sample:1.31|use_time:23.188023567199707
loss: -1.2030820846557617, EarlyStopping counter: 10 out of 300
EPOCH[1244/2000] loss-1.203-|Sample:1.30|use_time:23.60078263282776
loss: -1.2034007659772548, EarlyStopping counter: 11 out of 300
EPOCH[1245/2000] loss-1.207-|Sample:1.32|use_time:22.580232858657837
loss: -1.2072891287687348, EarlyStopping counter: 12 out of 300
EPOCH[1246/2000] loss-1.204-|Sample:2.67|use_time:23.474571466445923
loss: -1.204473399534458, EarlyStopping counter: 13 out of 300
EPOCH[1247/2000] loss-1.204-|Sample:2.10|use_time:20.773558139801025
loss: -1.2038565118138382, EarlyStopping counter: 14 out of 300
EPOCH[1248/2000] loss-1.205-|Sample:2.49|use_time:21.259707927703857
loss: -1.2053047244141741, EarlyStopping counter: 15 out of 300
EPOCH[1249/2000] loss-1.203-|Sample:0.97|use_time:21.113428831100464
loss: -1.2031339465118036, EarlyStopping counter: 16 out of 300
EPOCH[1250/2000] loss-1.204-|Sample:0.95|use_time:18.95674443244934
loss: -1.204361328264562, EarlyStopping counter: 17 out of 300
[TEST]
{'precision': array([0.02709114, 0.02006242, 0.01213733]), 'recall': array([0.1166812 , 0.16874355, 0.25046586]), 'ndcg': array([0.07969513, 0.09557809, 0.11583022]), 'coverage': array([24.87940075, 28.94556804, 33.7650437 ]), 'Acoverage': array([ 534.62958801,  829.96729089, 1414.7360799 ]), 'ILD': array([0.71708697, 0.73491754, 0.76733175]), 'F1': array([0.20070463, 0.27446704, 0.37765938])}
test time: 70.61213278770447
reg_loss2: tensor(0.0113, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2125, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2149, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[1251/2000] loss-1.203-|Sample:2.33|use_time:19.46247625350952
loss: -1.2030932467158248, EarlyStopping counter: 18 out of 300
EPOCH[1252/2000] loss-1.202-|Sample:1.77|use_time:19.76403498649597
loss: -1.2022514314186283, EarlyStopping counter: 19 out of 300
EPOCH[1253/2000] loss-1.202-|Sample:2.08|use_time:20.97854447364807
loss: -1.2020654707420162, EarlyStopping counter: 20 out of 300
EPOCH[1254/2000] loss-1.204-|Sample:0.95|use_time:18.816756010055542
loss: -1.2035718865510894, EarlyStopping counter: 21 out of 300
EPOCH[1255/2000] loss-1.203-|Sample:1.79|use_time:19.98124933242798
loss: -1.2032485880502841, EarlyStopping counter: 22 out of 300
EPOCH[1256/2000] loss-1.205-|Sample:0.94|use_time:19.079201698303223
loss: -1.204769765458456, EarlyStopping counter: 23 out of 300
EPOCH[1257/2000] loss-1.204-|Sample:1.88|use_time:20.58100652694702
loss: -1.2035845052905199, EarlyStopping counter: 24 out of 300
EPOCH[1258/2000] loss-1.203-|Sample:0.94|use_time:18.970662593841553
loss: -1.203347467794651, EarlyStopping counter: 25 out of 300
EPOCH[1259/2000] loss-1.204-|Sample:2.18|use_time:19.953160524368286
loss: -1.2038262384693796, EarlyStopping counter: 26 out of 300
EPOCH[1260/2000] loss-1.205-|Sample:1.85|use_time:18.83020544052124
loss: -1.2050336657500849, EarlyStopping counter: 27 out of 300
EPOCH[1261/2000] loss-1.204-|Sample:1.78|use_time:19.66740393638611
loss: -1.2037454523691318, EarlyStopping counter: 28 out of 300
EPOCH[1262/2000] loss-1.205-|Sample:2.09|use_time:20.161179780960083
loss: -1.2052449104262561, EarlyStopping counter: 29 out of 300
EPOCH[1263/2000] loss-1.201-|Sample:0.96|use_time:19.695353984832764
loss: -1.201357504216636, EarlyStopping counter: 30 out of 300
EPOCH[1264/2000] loss-1.205-|Sample:0.95|use_time:18.10265803337097
loss: -1.2051351157630361, EarlyStopping counter: 31 out of 300
EPOCH[1265/2000] loss-1.202-|Sample:2.15|use_time:20.030301332473755
loss: -1.2021390199661255, EarlyStopping counter: 32 out of 300
EPOCH[1266/2000] loss-1.205-|Sample:1.74|use_time:19.708053827285767
loss: -1.2046059777097005, EarlyStopping counter: 33 out of 300
EPOCH[1267/2000] loss-1.205-|Sample:1.96|use_time:19.900462865829468
loss: -1.2050403269325816, EarlyStopping counter: 34 out of 300
EPOCH[1268/2000] loss-1.204-|Sample:2.01|use_time:19.89156413078308
loss: -1.2040235123983243, EarlyStopping counter: 35 out of 300
EPOCH[1269/2000] loss-1.203-|Sample:1.75|use_time:19.20192837715149
loss: -1.2030540879179792, EarlyStopping counter: 36 out of 300
EPOCH[1270/2000] loss-1.204-|Sample:2.07|use_time:20.18584132194519
loss: -1.204278224852027, EarlyStopping counter: 37 out of 300
EPOCH[1271/2000] loss-1.205-|Sample:1.88|use_time:19.862093925476074
loss: -1.2048377205685872, EarlyStopping counter: 38 out of 300
EPOCH[1272/2000] loss-1.202-|Sample:0.94|use_time:19.878055095672607
loss: -1.201959886201998, EarlyStopping counter: 39 out of 300
EPOCH[1273/2000] loss-1.204-|Sample:0.95|use_time:18.26515531539917
loss: -1.2043155053766763, EarlyStopping counter: 40 out of 300
EPOCH[1274/2000] loss-1.205-|Sample:1.88|use_time:19.834028005599976
loss: -1.204890646585604, EarlyStopping counter: 41 out of 300
EPOCH[1275/2000] loss-1.204-|Sample:1.76|use_time:19.8062527179718
loss: -1.2037386952376947, EarlyStopping counter: 42 out of 300
EPOCH[1276/2000] loss-1.204-|Sample:2.11|use_time:20.16598391532898
loss: -1.2039502074078816, EarlyStopping counter: 43 out of 300
EPOCH[1277/2000] loss-1.205-|Sample:0.95|use_time:19.679576635360718
loss: -1.205179734927852, EarlyStopping counter: 44 out of 300
EPOCH[1278/2000] loss-1.204-|Sample:0.96|use_time:19.771669387817383
loss: -1.2038465476617581, EarlyStopping counter: 45 out of 300
EPOCH[1279/2000] loss-1.204-|Sample:0.98|use_time:20.716912508010864
loss: -1.203808531528566, EarlyStopping counter: 46 out of 300
EPOCH[1280/2000] loss-1.203-|Sample:2.70|use_time:20.794643878936768
loss: -1.2031353770232782, EarlyStopping counter: 47 out of 300
EPOCH[1281/2000] loss-1.204-|Sample:2.33|use_time:20.28023934364319
loss: -1.2040686229380166, EarlyStopping counter: 48 out of 300
EPOCH[1282/2000] loss-1.207-|Sample:2.19|use_time:19.31079649925232
loss: -1.2069976678708705, EarlyStopping counter: 49 out of 300
EPOCH[1283/2000] loss-1.203-|Sample:0.95|use_time:19.46073055267334
loss: -1.2027235845240152, EarlyStopping counter: 50 out of 300
EPOCH[1284/2000] loss-1.204-|Sample:0.95|use_time:19.970319509506226
loss: -1.2037477813115933, EarlyStopping counter: 51 out of 300
EPOCH[1285/2000] loss-1.203-|Sample:0.96|use_time:18.974759101867676
loss: -1.2029855338538564, EarlyStopping counter: 52 out of 300
EPOCH[1286/2000] loss-1.206-|Sample:1.76|use_time:19.584273099899292
loss: -1.205604893405263, EarlyStopping counter: 53 out of 300
EPOCH[1287/2000] loss-1.206-|Sample:1.93|use_time:19.763100624084473
loss: -1.2064361514114752, EarlyStopping counter: 54 out of 300
EPOCH[1288/2000] loss-1.205-|Sample:2.00|use_time:19.81191873550415
loss: -1.2048377787194602, EarlyStopping counter: 55 out of 300
EPOCH[1289/2000] loss-1.204-|Sample:0.96|use_time:19.852141857147217
loss: -1.2041833168122826, EarlyStopping counter: 56 out of 300
EPOCH[1290/2000] loss-1.203-|Sample:0.94|use_time:18.90486741065979
loss: -1.203075903217967, EarlyStopping counter: 57 out of 300
EPOCH[1291/2000] loss-1.204-|Sample:1.97|use_time:18.95705556869507
loss: -1.2037746848129645, EarlyStopping counter: 58 out of 300
EPOCH[1292/2000] loss-1.206-|Sample:1.75|use_time:19.66205334663391
loss: -1.206400868369312, EarlyStopping counter: 59 out of 300
EPOCH[1293/2000] loss-1.203-|Sample:2.14|use_time:19.83213520050049
loss: -1.2025130551035812, EarlyStopping counter: 60 out of 300
EPOCH[1294/2000] loss-1.204-|Sample:1.90|use_time:19.76212453842163
loss: -1.20385859361509, EarlyStopping counter: 61 out of 300
EPOCH[1295/2000] loss-1.203-|Sample:1.76|use_time:19.724477767944336
loss: -1.2025057833369186, EarlyStopping counter: 62 out of 300
EPOCH[1296/2000] loss-1.203-|Sample:2.18|use_time:19.72869300842285
loss: -1.2033921567405141, EarlyStopping counter: 63 out of 300
EPOCH[1297/2000] loss-1.205-|Sample:1.80|use_time:19.68760395050049
loss: -1.2049106301330939, EarlyStopping counter: 64 out of 300
EPOCH[1298/2000] loss-1.202-|Sample:0.94|use_time:20.10900640487671
loss: -1.2020197147276344, EarlyStopping counter: 65 out of 300
EPOCH[1299/2000] loss-1.203-|Sample:0.94|use_time:18.731251001358032
loss: -1.2032568018610885, EarlyStopping counter: 66 out of 300
EPOCH[1300/2000] loss-1.202-|Sample:1.88|use_time:18.917309522628784
loss: -1.2019677191245846, EarlyStopping counter: 67 out of 300
[TEST]
{'precision': array([0.02750312, 0.01988764, 0.01216979]), 'recall': array([0.11759489, 0.16685757, 0.25227697]), 'ndcg': array([0.07988843, 0.09482031, 0.11593069]), 'coverage': array([25.06691635, 29.08314607, 33.81523096]), 'Acoverage': array([ 539.22621723,  834.86916355, 1422.56404494]), 'ILD': array([0.71437925, 0.73163348, 0.76451303]), 'F1': array([0.20194703, 0.27174135, 0.37936847])}
test time: 69.82265067100525
reg_loss2: tensor(0.0112, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2112, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2270, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[1301/2000] loss-1.204-|Sample:2.31|use_time:20.152469635009766
loss: -1.2039662396035544, EarlyStopping counter: 68 out of 300
EPOCH[1302/2000] loss-1.204-|Sample:1.99|use_time:19.828898191452026
loss: -1.2042083594857194, EarlyStopping counter: 69 out of 300
EPOCH[1303/2000] loss-1.202-|Sample:0.94|use_time:19.57476282119751
loss: -1.2017524649457234, EarlyStopping counter: 70 out of 300
EPOCH[1304/2000] loss-1.208-|Sample:0.94|use_time:18.703602075576782
loss: -1.2075648365951166, EarlyStopping counter: 71 out of 300
EPOCH[1305/2000] loss-1.206-|Sample:2.05|use_time:19.333338737487793
loss: -1.2060472238354567, EarlyStopping counter: 72 out of 300
EPOCH[1306/2000] loss-1.204-|Sample:1.97|use_time:19.79383373260498
loss: -1.2040287169014536, EarlyStopping counter: 73 out of 300
EPOCH[1307/2000] loss-1.202-|Sample:1.78|use_time:19.78627848625183
loss: -1.20184372401819, EarlyStopping counter: 74 out of 300
EPOCH[1308/2000] loss-1.205-|Sample:2.10|use_time:20.01915192604065
loss: -1.2054768684433728, EarlyStopping counter: 75 out of 300
EPOCH[1309/2000] loss-1.204-|Sample:1.90|use_time:18.865675687789917
loss: -1.203958255488698, EarlyStopping counter: 76 out of 300
EPOCH[1310/2000] loss-1.205-|Sample:1.75|use_time:19.825388431549072
loss: -1.2046883455136927, EarlyStopping counter: 77 out of 300
EPOCH[1311/2000] loss-1.207-|Sample:2.10|use_time:19.90605092048645
loss: -1.206686397878135, EarlyStopping counter: 78 out of 300
EPOCH[1312/2000] loss-1.203-|Sample:0.94|use_time:19.580570459365845
loss: -1.2029653380556804, EarlyStopping counter: 79 out of 300
EPOCH[1313/2000] loss-1.204-|Sample:0.95|use_time:18.738690853118896
loss: -1.2041250699903907, EarlyStopping counter: 80 out of 300
EPOCH[1314/2000] loss-1.202-|Sample:2.13|use_time:19.444288969039917
loss: -1.2022699146735958, EarlyStopping counter: 81 out of 300
EPOCH[1315/2000] loss-1.203-|Sample:1.80|use_time:19.628089427947998
loss: -1.2030028337385597, EarlyStopping counter: 82 out of 300
EPOCH[1316/2000] loss-1.203-|Sample:1.81|use_time:19.987104415893555
loss: -1.2033221198291313, EarlyStopping counter: 83 out of 300
EPOCH[1317/2000] loss-1.203-|Sample:0.95|use_time:19.994109392166138
loss: -1.20300811093028, EarlyStopping counter: 84 out of 300
EPOCH[1318/2000] loss-1.204-|Sample:0.94|use_time:18.795625925064087
loss: -1.203812631165109, EarlyStopping counter: 85 out of 300
EPOCH[1319/2000] loss-1.205-|Sample:0.94|use_time:18.98876976966858
loss: -1.2048428901811925, EarlyStopping counter: 86 out of 300
EPOCH[1320/2000] loss-1.205-|Sample:2.08|use_time:19.83240246772766
loss: -1.2045924198336717, EarlyStopping counter: 87 out of 300
EPOCH[1321/2000] loss-1.205-|Sample:1.76|use_time:19.729126453399658
loss: -1.2045106800591074, EarlyStopping counter: 88 out of 300
EPOCH[1322/2000] loss-1.205-|Sample:1.97|use_time:19.838912963867188
loss: -1.204630566806328, EarlyStopping counter: 89 out of 300
EPOCH[1323/2000] loss-1.203-|Sample:0.94|use_time:19.25146746635437
loss: -1.2028292184922753, EarlyStopping counter: 90 out of 300
EPOCH[1324/2000] loss-1.204-|Sample:0.95|use_time:18.674410581588745
loss: -1.2038135615790762, EarlyStopping counter: 91 out of 300
EPOCH[1325/2000] loss-1.202-|Sample:2.00|use_time:19.779901266098022
loss: -1.201893067941433, EarlyStopping counter: 92 out of 300
EPOCH[1326/2000] loss-1.203-|Sample:2.01|use_time:19.81496572494507
loss: -1.2030212762879162, EarlyStopping counter: 93 out of 300
EPOCH[1327/2000] loss-1.205-|Sample:1.76|use_time:18.802123069763184
loss: -1.2048339145939524, EarlyStopping counter: 94 out of 300
EPOCH[1328/2000] loss-1.203-|Sample:2.07|use_time:20.013153314590454
loss: -1.202992427639845, EarlyStopping counter: 95 out of 300
EPOCH[1329/2000] loss-1.205-|Sample:1.91|use_time:19.68319797515869
loss: -1.204565391307924, EarlyStopping counter: 96 out of 300
EPOCH[1330/2000] loss-1.204-|Sample:1.76|use_time:19.763603687286377
loss: -1.2042772566399924, EarlyStopping counter: 97 out of 300
EPOCH[1331/2000] loss-1.202-|Sample:2.13|use_time:19.85154104232788
loss: -1.2024579716891777, EarlyStopping counter: 98 out of 300
EPOCH[1332/2000] loss-1.204-|Sample:0.93|use_time:19.56123161315918
loss: -1.2040893624468547, EarlyStopping counter: 99 out of 300
EPOCH[1333/2000] loss-1.204-|Sample:0.93|use_time:18.026907920837402
loss: -1.2040325112459136, EarlyStopping counter: 100 out of 300
EPOCH[1334/2000] loss-1.203-|Sample:2.18|use_time:20.060332775115967
loss: -1.2033455139253197, EarlyStopping counter: 101 out of 300
EPOCH[1335/2000] loss-1.205-|Sample:1.83|use_time:19.599159479141235
loss: -1.2053751538439494, EarlyStopping counter: 102 out of 300
EPOCH[1336/2000] loss-1.205-|Sample:1.83|use_time:19.865094661712646
loss: -1.204501088072614, EarlyStopping counter: 103 out of 300
EPOCH[1337/2000] loss-1.202-|Sample:0.94|use_time:19.72538185119629
loss: -1.2015219287174503, EarlyStopping counter: 104 out of 300
EPOCH[1338/2000] loss-1.204-|Sample:0.94|use_time:18.820799589157104
loss: -1.2042086967607823, EarlyStopping counter: 105 out of 300
EPOCH[1339/2000] loss-1.204-|Sample:0.95|use_time:18.962857961654663
loss: -1.2039101501790488, EarlyStopping counter: 106 out of 300
EPOCH[1340/2000] loss-1.203-|Sample:2.07|use_time:19.850274801254272
loss: -1.2032137091566877, EarlyStopping counter: 107 out of 300
EPOCH[1341/2000] loss-1.206-|Sample:1.74|use_time:19.470956087112427
loss: -1.2062182106622836, EarlyStopping counter: 108 out of 300
EPOCH[1342/2000] loss-1.202-|Sample:1.99|use_time:19.820929288864136
loss: -1.2024189902514946, EarlyStopping counter: 109 out of 300
EPOCH[1343/2000] loss-1.206-|Sample:0.95|use_time:18.859328031539917
loss: -1.2056746715452613, EarlyStopping counter: 110 out of 300
EPOCH[1344/2000] loss-1.203-|Sample:0.94|use_time:19.799999475479126
loss: -1.2029707024737102, EarlyStopping counter: 111 out of 300
EPOCH[1345/2000] loss-1.205-|Sample:0.93|use_time:18.779906511306763
loss: -1.2049070683921255, EarlyStopping counter: 112 out of 300
EPOCH[1346/2000] loss-1.202-|Sample:1.94|use_time:19.604875564575195
loss: -1.2023102597492497, EarlyStopping counter: 113 out of 300
EPOCH[1347/2000] loss-1.204-|Sample:1.76|use_time:19.611974716186523
loss: -1.2036498261661064, EarlyStopping counter: 114 out of 300
EPOCH[1348/2000] loss-1.204-|Sample:2.12|use_time:19.96117925643921
loss: -1.204015199731036, EarlyStopping counter: 115 out of 300
EPOCH[1349/2000] loss-1.201-|Sample:0.93|use_time:19.60248351097107
loss: -1.2013013333809086, EarlyStopping counter: 116 out of 300
EPOCH[1350/2000] loss-1.205-|Sample:0.95|use_time:18.893762350082397
loss: -1.2046800241237734, EarlyStopping counter: 117 out of 300
[TEST]
{'precision': array([0.02759051, 0.01992509, 0.01210237]), 'recall': array([0.11816891, 0.16728149, 0.24914611]), 'ndcg': array([0.08089653, 0.09581112, 0.11615036]), 'coverage': array([25.15780275, 29.08576779, 33.8803995 ]), 'Acoverage': array([ 539.65430712,  837.70187266, 1425.83570537]), 'ILD': array([0.71472881, 0.73176161, 0.76520044]), 'F1': array([0.20280696, 0.27231214, 0.37590055])}
test time: 69.76352262496948
reg_loss2: tensor(0.0112, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2504, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2151, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[1351/2000] loss-1.204-|Sample:2.32|use_time:20.226757764816284
loss: -1.2041200719228604, EarlyStopping counter: 118 out of 300
EPOCH[1352/2000] loss-1.203-|Sample:1.74|use_time:18.82234287261963
loss: -1.203203936902488, EarlyStopping counter: 119 out of 300
EPOCH[1353/2000] loss-1.205-|Sample:1.95|use_time:20.647639513015747
loss: -1.205023739396072, EarlyStopping counter: 120 out of 300
EPOCH[1354/2000] loss-1.204-|Sample:0.95|use_time:18.706051349639893
loss: -1.20408719051175, EarlyStopping counter: 121 out of 300
EPOCH[1355/2000] loss-1.205-|Sample:1.74|use_time:20.552722930908203
loss: -1.2045903322173328, EarlyStopping counter: 122 out of 300
EPOCH[1356/2000] loss-1.201-|Sample:0.95|use_time:18.88301730155945
loss: -1.2010529913553378, EarlyStopping counter: 123 out of 300
EPOCH[1357/2000] loss-1.202-|Sample:2.01|use_time:18.993401765823364
loss: -1.202263552968095, EarlyStopping counter: 124 out of 300
EPOCH[1358/2000] loss-1.204-|Sample:1.75|use_time:19.497286319732666
loss: -1.2039617503561624, EarlyStopping counter: 125 out of 300
EPOCH[1359/2000] loss-1.204-|Sample:2.08|use_time:20.763923168182373
loss: -1.2041630366953409, EarlyStopping counter: 126 out of 300
EPOCH[1360/2000] loss-1.203-|Sample:0.94|use_time:18.56856942176819
loss: -1.2031122969418038, EarlyStopping counter: 127 out of 300
EPOCH[1361/2000] loss-1.204-|Sample:1.76|use_time:19.79808235168457
loss: -1.2040034561622432, EarlyStopping counter: 128 out of 300
EPOCH[1362/2000] loss-1.203-|Sample:0.94|use_time:18.75397515296936
loss: -1.2030734085455173, EarlyStopping counter: 129 out of 300
EPOCH[1363/2000] loss-1.203-|Sample:1.87|use_time:19.55271077156067
loss: -1.2027921909239234, EarlyStopping counter: 130 out of 300
EPOCH[1364/2000] loss-1.205-|Sample:1.78|use_time:19.776920557022095
loss: -1.204912633430667, EarlyStopping counter: 131 out of 300
EPOCH[1365/2000] loss-1.202-|Sample:2.14|use_time:20.979875326156616
loss: -1.2024043333239671, EarlyStopping counter: 132 out of 300
EPOCH[1366/2000] loss-1.203-|Sample:0.93|use_time:18.23664665222168
loss: -1.2029234985025918, EarlyStopping counter: 133 out of 300
EPOCH[1367/2000] loss-1.203-|Sample:1.83|use_time:20.964627981185913
loss: -1.2028429595435537, EarlyStopping counter: 134 out of 300
EPOCH[1368/2000] loss-1.206-|Sample:0.95|use_time:18.90399408340454
loss: -1.2056931344474233, EarlyStopping counter: 135 out of 300
EPOCH[1369/2000] loss-1.202-|Sample:1.77|use_time:19.674896240234375
loss: -1.2019443163057653, EarlyStopping counter: 136 out of 300
EPOCH[1370/2000] loss-1.202-|Sample:2.01|use_time:19.031516551971436
loss: -1.2018380048798352, EarlyStopping counter: 137 out of 300
EPOCH[1371/2000] loss-1.203-|Sample:2.01|use_time:20.705446004867554
loss: -1.2031794902754993, EarlyStopping counter: 138 out of 300
EPOCH[1372/2000] loss-1.203-|Sample:0.95|use_time:18.878100872039795
loss: -1.2030915894159457, EarlyStopping counter: 139 out of 300
EPOCH[1373/2000] loss-1.206-|Sample:2.07|use_time:20.991652965545654
loss: -1.2060679807895567, EarlyStopping counter: 140 out of 300
EPOCH[1374/2000] loss-1.203-|Sample:0.94|use_time:18.58922553062439
loss: -1.2028901925901088, EarlyStopping counter: 141 out of 300
EPOCH[1375/2000] loss-1.205-|Sample:1.76|use_time:19.427481651306152
loss: -1.2054516803927537, EarlyStopping counter: 142 out of 300
EPOCH[1376/2000] loss-1.204-|Sample:2.21|use_time:19.858380794525146
loss: -1.20382556101171, EarlyStopping counter: 143 out of 300
EPOCH[1377/2000] loss-1.205-|Sample:1.87|use_time:20.58355689048767
loss: -1.2046699553001217, EarlyStopping counter: 144 out of 300
EPOCH[1378/2000] loss-1.204-|Sample:0.94|use_time:18.781052827835083
loss: -1.2037133385495442, EarlyStopping counter: 145 out of 300
EPOCH[1379/2000] loss-1.204-|Sample:2.16|use_time:20.10701560974121
loss: -1.2039998566232077, EarlyStopping counter: 146 out of 300
EPOCH[1380/2000] loss-1.203-|Sample:0.94|use_time:18.815245866775513
loss: -1.2032628495518753, EarlyStopping counter: 147 out of 300
EPOCH[1381/2000] loss-1.205-|Sample:1.83|use_time:19.729487657546997
loss: -1.2052383335625254, EarlyStopping counter: 148 out of 300
EPOCH[1382/2000] loss-1.205-|Sample:2.16|use_time:19.88623332977295
loss: -1.2054870564763138, EarlyStopping counter: 149 out of 300
EPOCH[1383/2000] loss-1.203-|Sample:1.74|use_time:20.086771488189697
loss: -1.2033502096083106, EarlyStopping counter: 150 out of 300
EPOCH[1384/2000] loss-1.204-|Sample:0.95|use_time:19.056888580322266
loss: -1.204051442262603, EarlyStopping counter: 151 out of 300
EPOCH[1385/2000] loss-1.205-|Sample:2.04|use_time:20.748960733413696
loss: -1.2046546121922934, EarlyStopping counter: 152 out of 300
EPOCH[1386/2000] loss-1.205-|Sample:0.98|use_time:18.766393184661865
loss: -1.2051999161883098, EarlyStopping counter: 153 out of 300
EPOCH[1387/2000] loss-1.203-|Sample:2.07|use_time:19.786634922027588
loss: -1.203368867315897, EarlyStopping counter: 154 out of 300
EPOCH[1388/2000] loss-1.202-|Sample:1.96|use_time:18.875633001327515
loss: -1.202494691057903, EarlyStopping counter: 155 out of 300
EPOCH[1389/2000] loss-1.201-|Sample:1.75|use_time:20.54436945915222
loss: -1.201236120084437, EarlyStopping counter: 156 out of 300
EPOCH[1390/2000] loss-1.206-|Sample:0.94|use_time:19.08233404159546
loss: -1.206059034277753, EarlyStopping counter: 157 out of 300
EPOCH[1391/2000] loss-1.205-|Sample:1.88|use_time:20.383924961090088
loss: -1.2046947886304158, EarlyStopping counter: 158 out of 300
EPOCH[1392/2000] loss-1.206-|Sample:0.97|use_time:18.692735195159912
loss: -1.2063301830756954, EarlyStopping counter: 159 out of 300
EPOCH[1393/2000] loss-1.206-|Sample:2.18|use_time:19.77211880683899
loss: -1.206159975470566, EarlyStopping counter: 160 out of 300
EPOCH[1394/2000] loss-1.206-|Sample:1.86|use_time:19.40509581565857
loss: -1.2059676589035406, EarlyStopping counter: 161 out of 300
EPOCH[1395/2000] loss-1.204-|Sample:1.77|use_time:20.500151872634888
loss: -1.204209673695448, EarlyStopping counter: 162 out of 300
EPOCH[1396/2000] loss-1.202-|Sample:0.94|use_time:18.704516649246216
loss: -1.2024808860406644, EarlyStopping counter: 163 out of 300
EPOCH[1397/2000] loss-1.206-|Sample:1.78|use_time:20.210283756256104
loss: -1.205626278388791, EarlyStopping counter: 164 out of 300
EPOCH[1398/2000] loss-1.204-|Sample:0.94|use_time:17.99051547050476
loss: -1.2037918451355725, EarlyStopping counter: 165 out of 300
EPOCH[1399/2000] loss-1.202-|Sample:2.12|use_time:18.9507954120636
loss: -1.202497520097872, EarlyStopping counter: 166 out of 300
EPOCH[1400/2000] loss-1.205-|Sample:1.75|use_time:18.629171133041382
loss: -1.2051114570803758, EarlyStopping counter: 167 out of 300
[TEST]
{'precision': array([0.02719101, 0.02003745, 0.01214232]), 'recall': array([0.11714497, 0.16822659, 0.24973745]), 'ndcg': array([0.07984661, 0.09541609, 0.11564538]), 'coverage': array([25.01273408, 28.9937578 , 33.86179775]), 'Acoverage': array([ 542.53071161,  840.96579276, 1429.9732834 ]), 'ILD': array([0.71516438, 0.73290229, 0.76559484]), 'F1': array([0.20131436, 0.27364266, 0.37662094])}
test time: 69.26267528533936
reg_loss2: tensor(0.0111, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2217, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2019, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[1401/2000] loss-1.204-|Sample:2.30|use_time:21.05246138572693
loss: -1.2035472683790254, EarlyStopping counter: 168 out of 300
EPOCH[1402/2000] loss-1.205-|Sample:0.95|use_time:18.037957191467285
loss: -1.2049196086278775, EarlyStopping counter: 169 out of 300
EPOCH[1403/2000] loss-1.203-|Sample:1.93|use_time:19.519799947738647
loss: -1.2029629771302386, EarlyStopping counter: 170 out of 300
EPOCH[1404/2000] loss-1.206-|Sample:1.73|use_time:19.560395002365112
loss: -1.2064856697873372, EarlyStopping counter: 171 out of 300
EPOCH[1405/2000] loss-1.202-|Sample:2.11|use_time:19.831755876541138
loss: -1.2020379537489356, EarlyStopping counter: 172 out of 300
EPOCH[1406/2000] loss-1.205-|Sample:1.91|use_time:18.890333890914917
loss: -1.2052770765816294, EarlyStopping counter: 173 out of 300
EPOCH[1407/2000] loss-1.205-|Sample:1.75|use_time:19.713470220565796
loss: -1.204893542499077, EarlyStopping counter: 174 out of 300
EPOCH[1408/2000] loss-1.205-|Sample:2.12|use_time:20.160091400146484
loss: -1.204709884597034, EarlyStopping counter: 175 out of 300
EPOCH[1409/2000] loss-1.208-|Sample:0.94|use_time:19.626246213912964
loss: -1.2076043472057436, EarlyStopping counter: 176 out of 300
EPOCH[1410/2000] loss-1.205-|Sample:0.97|use_time:18.90537405014038
loss: -1.2047767726386465, EarlyStopping counter: 177 out of 300
EPOCH[1411/2000] loss-1.204-|Sample:2.12|use_time:19.23184847831726
loss: -1.2037382503835166, EarlyStopping counter: 178 out of 300
EPOCH[1412/2000] loss-1.206-|Sample:1.78|use_time:19.428143978118896
loss: -1.205599505726884, EarlyStopping counter: 179 out of 300
EPOCH[1413/2000] loss-1.204-|Sample:1.83|use_time:19.944393157958984
loss: -1.2042293286905057, EarlyStopping counter: 180 out of 300
EPOCH[1414/2000] loss-1.205-|Sample:0.95|use_time:19.98157811164856
loss: -1.2045671329265688, EarlyStopping counter: 181 out of 300
EPOCH[1415/2000] loss-1.205-|Sample:0.93|use_time:18.794002771377563
loss: -1.2045402614081777, EarlyStopping counter: 182 out of 300
EPOCH[1416/2000] loss-1.205-|Sample:0.94|use_time:18.973320722579956
loss: -1.2049933904554786, EarlyStopping counter: 183 out of 300
EPOCH[1417/2000] loss-1.204-|Sample:2.09|use_time:19.93646478652954
loss: -1.20358197863509, EarlyStopping counter: 184 out of 300
EPOCH[1418/2000] loss-1.202-|Sample:1.76|use_time:19.735501527786255
loss: -1.2017747338225202, EarlyStopping counter: 185 out of 300
EPOCH[1419/2000] loss-1.202-|Sample:1.97|use_time:19.988094806671143
loss: -1.2019559086822882, EarlyStopping counter: 186 out of 300
EPOCH[1420/2000] loss-1.205-|Sample:0.93|use_time:19.694233179092407
loss: -1.20477014343913, EarlyStopping counter: 187 out of 300
EPOCH[1421/2000] loss-1.205-|Sample:0.94|use_time:19.022042274475098
loss: -1.205399495799367, EarlyStopping counter: 188 out of 300
EPOCH[1422/2000] loss-1.203-|Sample:0.96|use_time:18.885115385055542
loss: -1.203014751759971, EarlyStopping counter: 189 out of 300
EPOCH[1423/2000] loss-1.203-|Sample:1.94|use_time:19.592267990112305
loss: -1.2027998930070458, EarlyStopping counter: 190 out of 300
EPOCH[1424/2000] loss-1.205-|Sample:1.75|use_time:19.525617599487305
loss: -1.2054016037685116, EarlyStopping counter: 191 out of 300
EPOCH[1425/2000] loss-1.203-|Sample:2.15|use_time:19.964125871658325
loss: -1.2029474159566367, EarlyStopping counter: 192 out of 300
EPOCH[1426/2000] loss-1.202-|Sample:1.00|use_time:18.815274000167847
loss: -1.2024339553786487, EarlyStopping counter: 193 out of 300
EPOCH[1427/2000] loss-1.206-|Sample:0.96|use_time:19.031601428985596
loss: -1.2055962957986972, EarlyStopping counter: 194 out of 300
EPOCH[1428/2000] loss-1.204-|Sample:2.19|use_time:20.21282386779785
loss: -1.2041082353126713, EarlyStopping counter: 195 out of 300
EPOCH[1429/2000] loss-1.204-|Sample:1.85|use_time:19.770986318588257
loss: -1.2042369609925805, EarlyStopping counter: 196 out of 300
EPOCH[1430/2000] loss-1.202-|Sample:1.81|use_time:19.77389693260193
loss: -1.202191634875972, EarlyStopping counter: 197 out of 300
EPOCH[1431/2000] loss-1.206-|Sample:2.13|use_time:19.234548330307007
loss: -1.2063434763652523, EarlyStopping counter: 198 out of 300
EPOCH[1432/2000] loss-1.204-|Sample:1.78|use_time:19.634201049804688
loss: -1.2037877803895531, EarlyStopping counter: 199 out of 300
EPOCH[1433/2000] loss-1.205-|Sample:1.91|use_time:19.90494418144226
loss: -1.2054000220647672, EarlyStopping counter: 200 out of 300
EPOCH[1434/2000] loss-1.203-|Sample:2.03|use_time:19.87988781929016
loss: -1.2029848593037302, EarlyStopping counter: 201 out of 300
EPOCH[1435/2000] loss-1.204-|Sample:0.94|use_time:19.708765029907227
loss: -1.2035293288347197, EarlyStopping counter: 202 out of 300
EPOCH[1436/2000] loss-1.206-|Sample:0.94|use_time:18.148147106170654
loss: -1.205541474063222, EarlyStopping counter: 203 out of 300
EPOCH[1437/2000] loss-1.203-|Sample:2.03|use_time:19.94380235671997
loss: -1.2029996557933529, EarlyStopping counter: 204 out of 300
EPOCH[1438/2000] loss-1.205-|Sample:1.78|use_time:19.781821727752686
loss: -1.2047457026272286, EarlyStopping counter: 205 out of 300
EPOCH[1439/2000] loss-1.205-|Sample:2.06|use_time:20.02588725090027
loss: -1.204925420807629, EarlyStopping counter: 206 out of 300
EPOCH[1440/2000] loss-1.205-|Sample:0.94|use_time:18.865645170211792
loss: -1.2054945608464682, EarlyStopping counter: 207 out of 300
EPOCH[1441/2000] loss-1.203-|Sample:0.95|use_time:20.003024339675903
loss: -1.2028878171269486, EarlyStopping counter: 208 out of 300
EPOCH[1442/2000] loss-1.205-|Sample:0.94|use_time:18.86218285560608
loss: -1.2050550943467675, EarlyStopping counter: 209 out of 300
EPOCH[1443/2000] loss-1.204-|Sample:1.87|use_time:19.54833745956421
loss: -1.2040961631914464, EarlyStopping counter: 210 out of 300
EPOCH[1444/2000] loss-1.203-|Sample:1.76|use_time:19.777557611465454
loss: -1.2027195953741305, EarlyStopping counter: 211 out of 300
EPOCH[1445/2000] loss-1.202-|Sample:2.15|use_time:19.671783924102783
loss: -1.202151153145767, EarlyStopping counter: 212 out of 300
EPOCH[1446/2000] loss-1.202-|Sample:0.95|use_time:19.72128129005432
loss: -1.2024297975912326, EarlyStopping counter: 213 out of 300
EPOCH[1447/2000] loss-1.204-|Sample:0.95|use_time:20.05776309967041
loss: -1.2036213031629237, EarlyStopping counter: 214 out of 300
EPOCH[1448/2000] loss-1.205-|Sample:0.94|use_time:18.81986927986145
loss: -1.205429155652116, EarlyStopping counter: 215 out of 300
EPOCH[1449/2000] loss-1.203-|Sample:1.75|use_time:18.733202934265137
loss: -1.2029868771390217, EarlyStopping counter: 216 out of 300
EPOCH[1450/2000] loss-1.203-|Sample:1.90|use_time:19.797519207000732
loss: -1.2034189875532941, EarlyStopping counter: 217 out of 300
[TEST]
{'precision': array([0.02749064, 0.01993758, 0.01211985]), 'recall': array([0.11878763, 0.16713685, 0.25059324]), 'ndcg': array([0.08034418, 0.09515721, 0.11576598]), 'coverage': array([25.04706617, 29.17378277, 33.98364544]), 'Acoverage': array([ 545.49325843,  843.71348315, 1430.41223471]), 'ILD': array([0.71281176, 0.73198436, 0.76534006]), 'F1': array([0.20363944, 0.27213586, 0.37756228])}
test time: 69.74942445755005
reg_loss2: tensor(0.0111, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2395, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2237, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[1451/2000] loss-1.203-|Sample:2.29|use_time:23.0059175491333
loss: -1.20349000721443, EarlyStopping counter: 218 out of 300
EPOCH[1452/2000] loss-1.203-|Sample:1.35|use_time:23.743669748306274
loss: -1.2025296164721977, EarlyStopping counter: 219 out of 300
EPOCH[1453/2000] loss-1.204-|Sample:0.96|use_time:18.72727656364441
loss: -1.2039871913630789, EarlyStopping counter: 220 out of 300
EPOCH[1454/2000] loss-1.203-|Sample:2.34|use_time:20.095916271209717
loss: -1.2034295361216476, EarlyStopping counter: 221 out of 300
EPOCH[1455/2000] loss-1.204-|Sample:2.19|use_time:20.21042776107788
loss: -1.204260552801737, EarlyStopping counter: 222 out of 300
EPOCH[1456/2000] loss-1.206-|Sample:0.94|use_time:19.66279625892639
loss: -1.2056039804365577, EarlyStopping counter: 223 out of 300
EPOCH[1457/2000] loss-1.205-|Sample:0.95|use_time:20.100932836532593
loss: -1.2046439008014957, EarlyStopping counter: 224 out of 300
EPOCH[1458/2000] loss-1.204-|Sample:0.96|use_time:18.72047710418701
loss: -1.2044179962902535, EarlyStopping counter: 225 out of 300
EPOCH[1459/2000] loss-1.205-|Sample:1.75|use_time:20.632259607315063
loss: -1.2048829503175689, EarlyStopping counter: 226 out of 300
EPOCH[1460/2000] loss-1.205-|Sample:0.94|use_time:19.01868748664856
loss: -1.2053456858890812, EarlyStopping counter: 227 out of 300
EPOCH[1461/2000] loss-1.205-|Sample:2.02|use_time:19.723171710968018
loss: -1.2045515165096377, EarlyStopping counter: 228 out of 300
EPOCH[1462/2000] loss-1.206-|Sample:1.77|use_time:18.850539922714233
loss: -1.205667481189821, EarlyStopping counter: 229 out of 300
EPOCH[1463/2000] loss-1.204-|Sample:0.94|use_time:20.079253911972046
loss: -1.2038357083390399, EarlyStopping counter: 230 out of 300
EPOCH[1464/2000] loss-1.203-|Sample:0.95|use_time:19.755144834518433
loss: -1.203053916372904, EarlyStopping counter: 231 out of 300
EPOCH[1465/2000] loss-1.203-|Sample:0.94|use_time:18.712952613830566
loss: -1.2032501552163102, EarlyStopping counter: 232 out of 300
EPOCH[1466/2000] loss-1.204-|Sample:2.17|use_time:19.873538494110107
loss: -1.2040512300119168, EarlyStopping counter: 233 out of 300
EPOCH[1467/2000] loss-1.204-|Sample:1.87|use_time:19.31934142112732
loss: -1.203982553830961, EarlyStopping counter: 234 out of 300
EPOCH[1468/2000] loss-1.207-|Sample:0.96|use_time:19.934128284454346
loss: -1.2070296973716923, EarlyStopping counter: 235 out of 300
EPOCH[1469/2000] loss-1.203-|Sample:0.94|use_time:19.831064701080322
loss: -1.2029901306803634, EarlyStopping counter: 236 out of 300
EPOCH[1470/2000] loss-1.205-|Sample:0.95|use_time:18.60177516937256
loss: -1.2049824464611891, EarlyStopping counter: 237 out of 300
EPOCH[1471/2000] loss-1.201-|Sample:1.76|use_time:18.888152837753296
loss: -1.2013807413054676, EarlyStopping counter: 238 out of 300
EPOCH[1472/2000] loss-1.203-|Sample:2.14|use_time:20.07097864151001
loss: -1.2030238872621117, EarlyStopping counter: 239 out of 300
EPOCH[1473/2000] loss-1.205-|Sample:1.81|use_time:19.68736171722412
loss: -1.2050973409559669, EarlyStopping counter: 240 out of 300
EPOCH[1474/2000] loss-1.202-|Sample:0.95|use_time:19.925877571105957
loss: -1.2019016422876498, EarlyStopping counter: 241 out of 300
EPOCH[1475/2000] loss-1.203-|Sample:0.95|use_time:19.850244522094727
loss: -1.2025408366831338, EarlyStopping counter: 242 out of 300
EPOCH[1476/2000] loss-1.204-|Sample:0.95|use_time:18.271851062774658
loss: -1.2038757597527854, EarlyStopping counter: 243 out of 300
EPOCH[1477/2000] loss-1.204-|Sample:1.84|use_time:19.822128534317017
loss: -1.204473812405656, EarlyStopping counter: 244 out of 300
EPOCH[1478/2000] loss-1.204-|Sample:2.15|use_time:22.467226266860962
loss: -1.2038465592919327, EarlyStopping counter: 245 out of 300
EPOCH[1479/2000] loss-1.203-|Sample:2.67|use_time:21.926101684570312
loss: -1.2029701558555044, EarlyStopping counter: 246 out of 300
EPOCH[1480/2000] loss-1.204-|Sample:0.95|use_time:20.45714783668518
loss: -1.2043418477221233, EarlyStopping counter: 247 out of 300
EPOCH[1481/2000] loss-1.204-|Sample:0.94|use_time:19.24459743499756
loss: -1.203804926174443, EarlyStopping counter: 248 out of 300
EPOCH[1482/2000] loss-1.203-|Sample:1.75|use_time:19.67273759841919
loss: -1.2033718940688343, EarlyStopping counter: 249 out of 300
EPOCH[1483/2000] loss-1.205-|Sample:1.99|use_time:19.91139841079712
loss: -1.205114771680134, EarlyStopping counter: 250 out of 300
EPOCH[1484/2000] loss-1.202-|Sample:2.00|use_time:18.924315214157104
loss: -1.2024525316750132, EarlyStopping counter: 251 out of 300
EPOCH[1485/2000] loss-1.204-|Sample:1.76|use_time:19.524166345596313
loss: -1.2035005732280453, EarlyStopping counter: 252 out of 300
EPOCH[1486/2000] loss-1.202-|Sample:2.09|use_time:19.83088183403015
loss: -1.2024022893207829, EarlyStopping counter: 253 out of 300
EPOCH[1487/2000] loss-1.204-|Sample:1.88|use_time:19.76502227783203
loss: -1.2041623854055636, EarlyStopping counter: 254 out of 300
EPOCH[1488/2000] loss-1.206-|Sample:1.76|use_time:19.800649881362915
loss: -1.2056269994596156, EarlyStopping counter: 255 out of 300
EPOCH[1489/2000] loss-1.203-|Sample:0.94|use_time:19.379870653152466
loss: -1.2033027962940495, EarlyStopping counter: 256 out of 300
EPOCH[1490/2000] loss-1.205-|Sample:0.94|use_time:18.728276014328003
loss: -1.2047607200901682, EarlyStopping counter: 257 out of 300
EPOCH[1491/2000] loss-1.204-|Sample:1.74|use_time:19.73755168914795
loss: -1.204144504012131, EarlyStopping counter: 258 out of 300
EPOCH[1492/2000] loss-1.202-|Sample:2.14|use_time:20.090924501419067
loss: -1.2020883618331537, EarlyStopping counter: 259 out of 300
EPOCH[1493/2000] loss-1.205-|Sample:1.78|use_time:18.78361988067627
loss: -1.204550894295297, EarlyStopping counter: 260 out of 300
EPOCH[1494/2000] loss-1.202-|Sample:0.94|use_time:19.8197340965271
loss: -1.2017991862645963, EarlyStopping counter: 261 out of 300
EPOCH[1495/2000] loss-1.204-|Sample:0.95|use_time:19.843869924545288
loss: -1.2038551307306058, EarlyStopping counter: 262 out of 300
EPOCH[1496/2000] loss-1.203-|Sample:0.96|use_time:18.744444131851196
loss: -1.2034481269557302, EarlyStopping counter: 263 out of 300
EPOCH[1497/2000] loss-1.204-|Sample:1.92|use_time:19.680249214172363
loss: -1.2042132179911544, EarlyStopping counter: 264 out of 300
EPOCH[1498/2000] loss-1.206-|Sample:2.06|use_time:19.132763385772705
loss: -1.205796645908821, EarlyStopping counter: 265 out of 300
EPOCH[1499/2000] loss-1.204-|Sample:1.77|use_time:19.547838926315308
loss: -1.2036086815159495, EarlyStopping counter: 266 out of 300
EPOCH[1500/2000] loss-1.204-|Sample:0.96|use_time:20.04659128189087
loss: -1.2043361024158756, EarlyStopping counter: 267 out of 300
[TEST]
{'precision': array([0.0272035 , 0.02009363, 0.01212484]), 'recall': array([0.11610501, 0.1676086 , 0.24912893]), 'ndcg': array([0.07911233, 0.09479456, 0.11495395]), 'coverage': array([25.21997503, 29.19200999, 33.8619226 ]), 'Acoverage': array([ 545.60349563,  845.6803995 , 1432.26479401]), 'ILD': array([0.71354696, 0.73193705, 0.76499712]), 'F1': array([0.19971357, 0.27275757, 0.37585646])}
test time: 69.84547710418701
reg_loss2: tensor(0.0111, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2163, device='cuda:0', grad_fn=<AddBackward0>) cl_loss: tensor(0.2222, device='cuda:0', grad_fn=<MulBackward0>)
EPOCH[1501/2000] loss-1.203-|Sample:0.94|use_time:20.614996194839478
loss: -1.2025191638527848, EarlyStopping counter: 268 out of 300
EPOCH[1502/2000] loss-1.206-|Sample:0.94|use_time:17.997913360595703
loss: -1.2056530161601742, EarlyStopping counter: 269 out of 300
EPOCH[1503/2000] loss-1.203-|Sample:1.83|use_time:19.604694366455078
loss: -1.2031394417692975, EarlyStopping counter: 270 out of 300
EPOCH[1504/2000] loss-1.204-|Sample:1.75|use_time:19.78586483001709
loss: -1.2040664946160666, EarlyStopping counter: 271 out of 300
EPOCH[1505/2000] loss-1.206-|Sample:2.13|use_time:19.898163080215454
loss: -1.2061465484340017, EarlyStopping counter: 272 out of 300
EPOCH[1506/2000] loss-1.204-|Sample:1.83|use_time:19.707175254821777
loss: -1.2044872394422206, EarlyStopping counter: 273 out of 300
EPOCH[1507/2000] loss-1.202-|Sample:1.83|use_time:19.297790050506592
loss: -1.2020285245848865, EarlyStopping counter: 274 out of 300
EPOCH[1508/2000] loss-1.204-|Sample:2.06|use_time:20.00312089920044
loss: -1.204193115234375, EarlyStopping counter: 275 out of 300
EPOCH[1509/2000] loss-1.205-|Sample:0.94|use_time:19.73656964302063
loss: -1.2053919914292126, EarlyStopping counter: 276 out of 300
EPOCH[1510/2000] loss-1.203-|Sample:0.94|use_time:18.88387107849121
loss: -1.2025318378355445, EarlyStopping counter: 277 out of 300
EPOCH[1511/2000] loss-1.205-|Sample:2.05|use_time:19.060165643692017
loss: -1.2045013933646969, EarlyStopping counter: 278 out of 300
EPOCH[1512/2000] loss-1.204-|Sample:1.75|use_time:19.731243133544922
loss: -1.2038605213165283, EarlyStopping counter: 279 out of 300
EPOCH[1513/2000] loss-1.202-|Sample:2.00|use_time:20.11976909637451
loss: -1.2015679144277804, EarlyStopping counter: 280 out of 300
EPOCH[1514/2000] loss-1.206-|Sample:0.94|use_time:19.76390814781189
loss: -1.2064999312889286, EarlyStopping counter: 281 out of 300
EPOCH[1515/2000] loss-1.203-|Sample:0.94|use_time:18.757856845855713
loss: -1.2026775726457921, EarlyStopping counter: 282 out of 300
EPOCH[1516/2000] loss-1.205-|Sample:2.06|use_time:19.315369844436646
loss: -1.204982463906451, EarlyStopping counter: 283 out of 300
EPOCH[1517/2000] loss-1.204-|Sample:1.91|use_time:19.827225923538208
loss: -1.2036271618633736, EarlyStopping counter: 284 out of 300
EPOCH[1518/2000] loss-1.206-|Sample:1.77|use_time:19.702500581741333
loss: -1.2064890948737539, EarlyStopping counter: 285 out of 300
EPOCH[1519/2000] loss-1.202-|Sample:2.18|use_time:20.091325521469116
loss: -1.2021714303551652, EarlyStopping counter: 286 out of 300
EPOCH[1520/2000] loss-1.203-|Sample:1.86|use_time:18.828114986419678
loss: -1.2034371655161789, EarlyStopping counter: 287 out of 300
EPOCH[1521/2000] loss-1.204-|Sample:1.75|use_time:19.64036250114441
loss: -1.2035478062746001, EarlyStopping counter: 288 out of 300
EPOCH[1522/2000] loss-1.205-|Sample:2.10|use_time:19.86494255065918
loss: -1.2046335441310232, EarlyStopping counter: 289 out of 300
EPOCH[1523/2000] loss-1.204-|Sample:0.94|use_time:19.45569896697998
loss: -1.2038225865945584, EarlyStopping counter: 290 out of 300
EPOCH[1524/2000] loss-1.202-|Sample:0.95|use_time:18.875007152557373
loss: -1.2024251135384165, EarlyStopping counter: 291 out of 300
EPOCH[1525/2000] loss-1.205-|Sample:2.12|use_time:19.53432607650757
loss: -1.2051178536764005, EarlyStopping counter: 292 out of 300
EPOCH[1526/2000] loss-1.205-|Sample:1.78|use_time:19.6293888092041
loss: -1.2048459372869351, EarlyStopping counter: 293 out of 300
EPOCH[1527/2000] loss-1.203-|Sample:1.93|use_time:19.90172791481018
loss: -1.2032214461303339, EarlyStopping counter: 294 out of 300
EPOCH[1528/2000] loss-1.203-|Sample:0.94|use_time:19.931700229644775
loss: -1.2031800514314233, EarlyStopping counter: 295 out of 300
EPOCH[1529/2000] loss-1.205-|Sample:0.93|use_time:18.945563316345215
loss: -1.2050064860320673, EarlyStopping counter: 296 out of 300
EPOCH[1530/2000] loss-1.203-|Sample:0.95|use_time:18.878609895706177
loss: -1.2025329746851108, EarlyStopping counter: 297 out of 300
EPOCH[1531/2000] loss-1.204-|Sample:2.03|use_time:19.735981225967407
loss: -1.2043442813361562, EarlyStopping counter: 298 out of 300
EPOCH[1532/2000] loss-1.205-|Sample:1.76|use_time:19.752447605133057
loss: -1.204781125231487, EarlyStopping counter: 299 out of 300
EPOCH[1533/2000] loss-1.204-|Sample:2.06|use_time:19.905205965042114
loss: -1.2037837912396687, EarlyStopping counter: 300 out of 300
