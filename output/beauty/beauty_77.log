nohup: ignoring input
Cpp extension not loaded
>>SEED: 2023
loading [./datasets/beauty]
82167 interactions for training
16399 interactions for testing
beauty Sparsity : 0.0020608405216870815
beauty is ready to go
loading adjacency matrix
lgn is already to go(dropout:0)
load and save to ./checkpoints/lgn-beauty-4-64.pth.tar
===========config================
dataset: beauty
layer num: 4
recdim: 64
model: lgn
testbatch 100
topks [10, 20, 50]
epochs 2000
max_len 32
regloss2_decay 1e-06
head_num 1
gamma 0.5
gamma2(submodular) 2.0
sigma(submodular) 1.0
k(number of aggregated neighbors) 20
num of new aspects 8
the weight of the new aspects add to user 0.5
whether add new aspects in training True
whether add new aspects in testing True
loss function au
===========end===================
[TEST]
/root/autodl-tmp/anonymous1376/code/evaluater.py:45: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  self.aspect = np.array(list(dataset.item_aspect_ID_dic.values()))   # ID
{'precision': array([0.00022472, 0.00031835, 0.00030212]), 'recall': array([0.00106088, 0.00325521, 0.00721351]), 'ndcg': array([0.00048544, 0.0011123 , 0.0020504 ]), 'coverage': array([30.55917603, 33.85343321, 37.41260924]), 'Acoverage': array([ 88.76816175, 139.06566183, 238.11379982]), 'ILD': array([0.91435705, 0.91392141, 0.91335942]), 'F1': array([0.00211929, 0.00648732, 0.01431397])}
test time: 149.8534219264984
EPOCH[1/2000] loss2.189-|Sample:2.02|use_time:59.14411473274231
EPOCH[2/2000] loss2.068-|Sample:1.10|use_time:58.66220211982727
EPOCH[3/2000] loss1.933-|Sample:2.05|use_time:58.59473204612732
EPOCH[4/2000] loss1.784-|Sample:2.06|use_time:61.004520654678345
EPOCH[5/2000] loss1.655-|Sample:1.08|use_time:59.15346908569336
EPOCH[6/2000] loss1.546-|Sample:1.08|use_time:59.397146463394165
EPOCH[7/2000] loss1.446-|Sample:1.12|use_time:59.340961933135986
EPOCH[8/2000] loss1.355-|Sample:1.08|use_time:59.37014603614807
EPOCH[9/2000] loss1.272-|Sample:1.07|use_time:59.32809782028198
EPOCH[10/2000] loss1.194-|Sample:1.08|use_time:58.68211889266968
EPOCH[11/2000] loss1.119-|Sample:1.07|use_time:59.13685965538025
EPOCH[12/2000] loss1.049-|Sample:1.07|use_time:59.12982511520386
EPOCH[13/2000] loss0.982-|Sample:1.09|use_time:58.91006922721863
EPOCH[14/2000] loss0.914-|Sample:1.07|use_time:61.07268452644348
EPOCH[15/2000] loss0.850-|Sample:1.11|use_time:60.05280661582947
EPOCH[16/2000] loss0.788-|Sample:1.09|use_time:58.87765836715698
EPOCH[17/2000] loss0.728-|Sample:1.07|use_time:58.76568269729614
EPOCH[18/2000] loss0.670-|Sample:1.09|use_time:58.773184061050415
EPOCH[19/2000] loss0.615-|Sample:1.06|use_time:58.44243383407593
EPOCH[20/2000] loss0.563-|Sample:1.09|use_time:58.78254222869873
EPOCH[21/2000] loss0.515-|Sample:1.09|use_time:59.076895236968994
EPOCH[22/2000] loss0.469-|Sample:1.09|use_time:59.21387219429016
EPOCH[23/2000] loss0.423-|Sample:1.08|use_time:59.09156036376953
EPOCH[24/2000] loss0.380-|Sample:1.07|use_time:58.90725493431091
EPOCH[25/2000] loss0.340-|Sample:1.07|use_time:58.91831088066101
EPOCH[26/2000] loss0.298-|Sample:1.08|use_time:58.904321908950806
EPOCH[27/2000] loss0.259-|Sample:1.08|use_time:58.74029779434204
EPOCH[28/2000] loss0.220-|Sample:1.08|use_time:58.89050555229187
EPOCH[29/2000] loss0.188-|Sample:1.08|use_time:58.937833070755005
EPOCH[30/2000] loss0.154-|Sample:1.08|use_time:59.16045069694519
EPOCH[31/2000] loss0.117-|Sample:1.08|use_time:59.20982122421265
EPOCH[32/2000] loss0.086-|Sample:1.09|use_time:58.68471002578735
EPOCH[33/2000] loss0.055-|Sample:1.06|use_time:59.059773445129395
EPOCH[34/2000] loss0.024-|Sample:1.07|use_time:58.92524480819702
EPOCH[35/2000] loss-0.004-|Sample:1.12|use_time:58.85612750053406
EPOCH[36/2000] loss-0.035-|Sample:1.08|use_time:58.9547278881073
EPOCH[37/2000] loss-0.061-|Sample:1.07|use_time:58.92433738708496
EPOCH[38/2000] loss-0.087-|Sample:1.09|use_time:58.940773248672485
EPOCH[39/2000] loss-0.111-|Sample:1.07|use_time:58.8910174369812
EPOCH[40/2000] loss-0.137-|Sample:1.09|use_time:58.87011694908142
EPOCH[41/2000] loss-0.161-|Sample:1.09|use_time:59.07027506828308
EPOCH[42/2000] loss-0.184-|Sample:1.09|use_time:58.798628091812134
EPOCH[43/2000] loss-0.206-|Sample:1.09|use_time:59.00255274772644
EPOCH[44/2000] loss-0.225-|Sample:1.08|use_time:59.011024475097656
EPOCH[45/2000] loss-0.246-|Sample:1.06|use_time:59.1508903503418
EPOCH[46/2000] loss-0.268-|Sample:1.10|use_time:59.209930658340454
EPOCH[47/2000] loss-0.287-|Sample:1.09|use_time:58.86377191543579
EPOCH[48/2000] loss-0.305-|Sample:1.08|use_time:58.95198106765747
EPOCH[49/2000] loss-0.325-|Sample:1.13|use_time:59.088425397872925
EPOCH[50/2000] loss-0.345-|Sample:1.08|use_time:58.76692843437195
[TEST]
{'precision': array([0.01334582, 0.00998752, 0.00649189]), 'recall': array([0.05458645, 0.08088083, 0.13025177]), 'ndcg': array([0.03544877, 0.04368019, 0.05602495]), 'coverage': array([22.80187266, 27.21785268, 31.86953808]), 'Acoverage': array([124.07531744, 168.38616668, 243.6940623 ]), 'ILD': array([0.68727979, 0.70295946, 0.73166542]), 'F1': array([0.10113997, 0.14507023, 0.22113659])}
test time: 277.0366225242615
reg_loss2: tensor(0.3799, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-0.7557, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[51/2000] loss-0.359-|Sample:1.08|use_time:58.79020118713379
EPOCH[52/2000] loss-0.380-|Sample:2.03|use_time:58.92100691795349
EPOCH[53/2000] loss-0.395-|Sample:2.05|use_time:58.57185435295105
EPOCH[54/2000] loss-0.413-|Sample:2.01|use_time:59.90611243247986
EPOCH[55/2000] loss-0.429-|Sample:1.60|use_time:58.66918587684631
EPOCH[56/2000] loss-0.443-|Sample:2.03|use_time:59.77647805213928
EPOCH[57/2000] loss-0.457-|Sample:1.07|use_time:58.27336239814758
EPOCH[58/2000] loss-0.472-|Sample:2.02|use_time:58.59740138053894
EPOCH[59/2000] loss-0.488-|Sample:2.04|use_time:59.52167010307312
EPOCH[60/2000] loss-0.504-|Sample:2.00|use_time:59.96014666557312
EPOCH[61/2000] loss-0.516-|Sample:1.09|use_time:58.376357316970825
EPOCH[62/2000] loss-0.532-|Sample:2.04|use_time:59.21960926055908
EPOCH[63/2000] loss-0.541-|Sample:2.05|use_time:59.24756336212158
EPOCH[64/2000] loss-0.558-|Sample:2.09|use_time:58.99917149543762
EPOCH[65/2000] loss-0.570-|Sample:2.08|use_time:59.62287664413452
EPOCH[66/2000] loss-0.579-|Sample:2.06|use_time:59.36229586601257
EPOCH[67/2000] loss-0.594-|Sample:2.04|use_time:58.95506715774536
EPOCH[68/2000] loss-0.607-|Sample:2.02|use_time:59.62714076042175
EPOCH[69/2000] loss-0.616-|Sample:1.67|use_time:58.39209508895874
EPOCH[70/2000] loss-0.631-|Sample:1.95|use_time:59.64202070236206
EPOCH[71/2000] loss-0.638-|Sample:1.04|use_time:58.68202447891235
EPOCH[72/2000] loss-0.647-|Sample:2.06|use_time:58.93420457839966
EPOCH[73/2000] loss-0.659-|Sample:2.00|use_time:60.11766815185547
EPOCH[74/2000] loss-0.670-|Sample:2.00|use_time:58.99207782745361
EPOCH[75/2000] loss-0.683-|Sample:2.02|use_time:58.584115982055664
EPOCH[76/2000] loss-0.694-|Sample:2.02|use_time:58.05806756019592
EPOCH[77/2000] loss-0.701-|Sample:1.99|use_time:58.85570549964905
EPOCH[78/2000] loss-0.710-|Sample:1.73|use_time:57.924110889434814
EPOCH[79/2000] loss-0.721-|Sample:2.01|use_time:58.61138415336609
EPOCH[80/2000] loss-0.731-|Sample:2.04|use_time:59.45002865791321
EPOCH[81/2000] loss-0.740-|Sample:1.84|use_time:59.21003460884094
EPOCH[82/2000] loss-0.749-|Sample:1.06|use_time:57.797292709350586
EPOCH[83/2000] loss-0.757-|Sample:2.00|use_time:58.48763704299927
EPOCH[84/2000] loss-0.767-|Sample:2.09|use_time:59.267449378967285
EPOCH[85/2000] loss-0.773-|Sample:1.80|use_time:58.55848169326782
EPOCH[86/2000] loss-0.782-|Sample:1.97|use_time:58.37642979621887
EPOCH[87/2000] loss-0.789-|Sample:2.12|use_time:58.6220543384552
EPOCH[88/2000] loss-0.799-|Sample:2.00|use_time:58.794057846069336
EPOCH[89/2000] loss-0.804-|Sample:1.04|use_time:58.46751523017883
EPOCH[90/2000] loss-0.812-|Sample:2.01|use_time:58.38456463813782
EPOCH[91/2000] loss-0.822-|Sample:2.03|use_time:58.535959005355835
EPOCH[92/2000] loss-0.827-|Sample:2.01|use_time:58.62192678451538
EPOCH[93/2000] loss-0.834-|Sample:2.01|use_time:59.13083362579346
EPOCH[94/2000] loss-0.839-|Sample:2.03|use_time:58.49646186828613
EPOCH[95/2000] loss-0.847-|Sample:2.03|use_time:59.23094320297241
EPOCH[96/2000] loss-0.852-|Sample:1.62|use_time:57.95489048957825
EPOCH[97/2000] loss-0.862-|Sample:1.99|use_time:59.0766499042511
EPOCH[98/2000] loss-0.866-|Sample:1.54|use_time:57.725778102874756
EPOCH[99/2000] loss-0.873-|Sample:2.02|use_time:58.160972595214844
EPOCH[100/2000] loss-0.879-|Sample:2.01|use_time:58.462875843048096
[TEST]
{'precision': array([0.02033708, 0.0152809 , 0.00950562]), 'recall': array([0.08654785, 0.12928379, 0.19663852]), 'ndcg': array([0.05737697, 0.07045799, 0.08717448]), 'coverage': array([23.33907615, 27.75106117, 32.56916355]), 'Acoverage': array([132.81918334, 178.46354861, 254.93540696]), 'ILD': array([0.73842697, 0.75117025, 0.77464486]), 'F1': array([0.15493628, 0.22060013, 0.31365721])}
test time: 275.1279537677765
reg_loss2: tensor(0.1492, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.0716, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[101/2000] loss-0.883-|Sample:2.02|use_time:57.92611336708069
EPOCH[102/2000] loss-0.890-|Sample:2.01|use_time:57.96040415763855
EPOCH[103/2000] loss-0.897-|Sample:2.00|use_time:59.066917419433594
EPOCH[104/2000] loss-0.904-|Sample:2.00|use_time:59.24405598640442
EPOCH[105/2000] loss-0.906-|Sample:1.05|use_time:57.63733220100403
EPOCH[106/2000] loss-0.911-|Sample:1.99|use_time:58.30200719833374
EPOCH[107/2000] loss-0.918-|Sample:1.99|use_time:59.03335213661194
EPOCH[108/2000] loss-0.924-|Sample:1.52|use_time:57.940422773361206
EPOCH[109/2000] loss-0.928-|Sample:2.04|use_time:58.55942249298096
EPOCH[110/2000] loss-0.933-|Sample:1.93|use_time:58.3654682636261
EPOCH[111/2000] loss-0.938-|Sample:2.01|use_time:58.54273867607117
EPOCH[112/2000] loss-0.940-|Sample:2.02|use_time:58.29491662979126
EPOCH[113/2000] loss-0.947-|Sample:2.03|use_time:58.495158433914185
EPOCH[114/2000] loss-0.951-|Sample:2.01|use_time:58.98163294792175
EPOCH[115/2000] loss-0.955-|Sample:1.99|use_time:59.136531352996826
EPOCH[116/2000] loss-0.960-|Sample:1.04|use_time:58.14387607574463
EPOCH[117/2000] loss-0.963-|Sample:1.99|use_time:58.44168734550476
EPOCH[118/2000] loss-0.970-|Sample:2.00|use_time:59.27649283409119
EPOCH[119/2000] loss-0.971-|Sample:1.53|use_time:58.01711869239807
EPOCH[120/2000] loss-0.975-|Sample:2.04|use_time:58.07719039916992
EPOCH[121/2000] loss-0.981-|Sample:2.02|use_time:57.93675518035889
EPOCH[122/2000] loss-0.984-|Sample:2.02|use_time:58.6176221370697
EPOCH[123/2000] loss-0.986-|Sample:1.95|use_time:57.80474281311035
EPOCH[124/2000] loss-0.991-|Sample:2.00|use_time:58.08203339576721
EPOCH[125/2000] loss-0.996-|Sample:2.05|use_time:59.32817268371582
EPOCH[126/2000] loss-0.999-|Sample:1.92|use_time:59.34762167930603
EPOCH[127/2000] loss-1.002-|Sample:1.05|use_time:57.9981586933136
EPOCH[128/2000] loss-1.006-|Sample:2.09|use_time:58.60206413269043
EPOCH[129/2000] loss-1.008-|Sample:1.98|use_time:59.03993844985962
EPOCH[130/2000] loss-1.010-|Sample:1.52|use_time:57.83466386795044
EPOCH[131/2000] loss-1.015-|Sample:2.06|use_time:58.415528774261475
EPOCH[132/2000] loss-1.016-|Sample:2.02|use_time:58.032389640808105
EPOCH[133/2000] loss-1.019-|Sample:2.08|use_time:58.66825532913208
EPOCH[134/2000] loss-1.023-|Sample:1.05|use_time:58.444185972213745
EPOCH[135/2000] loss-1.025-|Sample:1.99|use_time:57.87917637825012
EPOCH[136/2000] loss-1.028-|Sample:2.00|use_time:58.01032590866089
EPOCH[137/2000] loss-1.033-|Sample:2.01|use_time:58.21347260475159
EPOCH[138/2000] loss-1.036-|Sample:1.99|use_time:58.91111207008362
EPOCH[139/2000] loss-1.038-|Sample:2.04|use_time:58.307769775390625
EPOCH[140/2000] loss-1.040-|Sample:2.02|use_time:58.840925216674805
EPOCH[141/2000] loss-1.043-|Sample:1.79|use_time:57.897964000701904
EPOCH[142/2000] loss-1.044-|Sample:2.02|use_time:59.34754300117493
EPOCH[143/2000] loss-1.048-|Sample:1.57|use_time:57.6600558757782
EPOCH[144/2000] loss-1.048-|Sample:2.02|use_time:58.02393984794617
EPOCH[145/2000] loss-1.051-|Sample:2.03|use_time:58.030680656433105
EPOCH[146/2000] loss-1.055-|Sample:2.03|use_time:58.389187812805176
EPOCH[147/2000] loss-1.060-|Sample:2.03|use_time:58.62785196304321
EPOCH[148/2000] loss-1.058-|Sample:2.93|use_time:64.55723857879639
loss: -1.0577400661096341, EarlyStopping counter: 1 out of 300
EPOCH[149/2000] loss-1.060-|Sample:2.35|use_time:62.08575105667114
loss: -1.059824641157941, EarlyStopping counter: 2 out of 300
EPOCH[150/2000] loss-1.062-|Sample:2.94|use_time:61.457048654556274
[TEST]
{'precision': array([0.02363296, 0.01764045, 0.01095131]), 'recall': array([0.10113523, 0.14911398, 0.22660634]), 'ndcg': array([0.06858279, 0.08320733, 0.10235812]), 'coverage': array([22.87078652, 27.41048689, 32.20661673]), 'Acoverage': array([134.34429524, 180.59214701, 256.53088213]), 'ILD': array([0.73414621, 0.74867205, 0.77485062]), 'F1': array([0.17777971, 0.24869505, 0.35066123])}
test time: 278.28359389305115
reg_loss2: tensor(0.0794, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.1311, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[151/2000] loss-1.063-|Sample:1.96|use_time:60.51704430580139
EPOCH[152/2000] loss-1.069-|Sample:1.00|use_time:60.15293574333191
EPOCH[153/2000] loss-1.068-|Sample:1.01|use_time:59.87937688827515
loss: -1.0681666019486218, EarlyStopping counter: 1 out of 300
EPOCH[154/2000] loss-1.073-|Sample:2.02|use_time:60.05554008483887
EPOCH[155/2000] loss-1.071-|Sample:2.01|use_time:60.34491205215454
loss: -1.0713253748126146, EarlyStopping counter: 1 out of 300
EPOCH[156/2000] loss-1.077-|Sample:1.98|use_time:59.90351939201355
EPOCH[157/2000] loss-1.078-|Sample:1.98|use_time:60.94001269340515
EPOCH[158/2000] loss-1.081-|Sample:1.79|use_time:60.079442739486694
EPOCH[159/2000] loss-1.083-|Sample:1.96|use_time:60.83538556098938
EPOCH[160/2000] loss-1.086-|Sample:1.57|use_time:59.51244115829468
EPOCH[161/2000] loss-1.085-|Sample:2.00|use_time:60.199543476104736
loss: -1.084696856940665, EarlyStopping counter: 1 out of 300
EPOCH[162/2000] loss-1.087-|Sample:1.97|use_time:59.92568850517273
EPOCH[163/2000] loss-1.089-|Sample:2.07|use_time:60.8575177192688
EPOCH[164/2000] loss-1.091-|Sample:2.05|use_time:59.63240838050842
EPOCH[165/2000] loss-1.092-|Sample:2.01|use_time:60.52080154418945
EPOCH[166/2000] loss-1.094-|Sample:2.00|use_time:59.872968673706055
EPOCH[167/2000] loss-1.096-|Sample:1.97|use_time:59.969711780548096
EPOCH[168/2000] loss-1.097-|Sample:2.01|use_time:60.98615550994873
EPOCH[169/2000] loss-1.097-|Sample:1.95|use_time:60.860002517700195
EPOCH[170/2000] loss-1.102-|Sample:0.99|use_time:59.51864719390869
EPOCH[171/2000] loss-1.103-|Sample:1.97|use_time:59.7437698841095
EPOCH[172/2000] loss-1.104-|Sample:1.95|use_time:60.88448357582092
EPOCH[173/2000] loss-1.103-|Sample:1.58|use_time:59.779133319854736
loss: -1.103308849218415, EarlyStopping counter: 1 out of 300
EPOCH[174/2000] loss-1.107-|Sample:1.96|use_time:59.88817620277405
EPOCH[175/2000] loss-1.107-|Sample:1.93|use_time:60.1705539226532
EPOCH[176/2000] loss-1.109-|Sample:1.98|use_time:60.696640968322754
EPOCH[177/2000] loss-1.108-|Sample:0.98|use_time:59.84784293174744
loss: -1.1081948512937965, EarlyStopping counter: 1 out of 300
EPOCH[178/2000] loss-1.110-|Sample:1.92|use_time:60.248061180114746
EPOCH[179/2000] loss-1.112-|Sample:2.01|use_time:60.01368570327759
EPOCH[180/2000] loss-1.113-|Sample:1.96|use_time:60.01750206947327
EPOCH[181/2000] loss-1.114-|Sample:1.94|use_time:60.56082105636597
EPOCH[182/2000] loss-1.116-|Sample:1.86|use_time:59.90618276596069
EPOCH[183/2000] loss-1.117-|Sample:1.76|use_time:60.441805362701416
EPOCH[184/2000] loss-1.121-|Sample:1.65|use_time:59.593855142593384
EPOCH[185/2000] loss-1.118-|Sample:1.80|use_time:60.652780532836914
loss: -1.1184531217668114, EarlyStopping counter: 1 out of 300
EPOCH[186/2000] loss-1.120-|Sample:1.55|use_time:59.610349893569946
loss: -1.1203006186136386, EarlyStopping counter: 2 out of 300
EPOCH[187/2000] loss-1.121-|Sample:1.80|use_time:59.96041750907898
EPOCH[188/2000] loss-1.123-|Sample:1.87|use_time:59.901864767074585
EPOCH[189/2000] loss-1.124-|Sample:1.97|use_time:60.15528869628906
EPOCH[190/2000] loss-1.129-|Sample:2.01|use_time:59.84063935279846
EPOCH[191/2000] loss-1.126-|Sample:1.99|use_time:60.49865245819092
loss: -1.126184765885516, EarlyStopping counter: 1 out of 300
EPOCH[192/2000] loss-1.127-|Sample:1.93|use_time:60.01253390312195
loss: -1.127437768912897, EarlyStopping counter: 2 out of 300
EPOCH[193/2000] loss-1.126-|Sample:1.97|use_time:60.243765115737915
loss: -1.126055220278298, EarlyStopping counter: 3 out of 300
EPOCH[194/2000] loss-1.128-|Sample:1.96|use_time:60.574952125549316
loss: -1.1283061097307903, EarlyStopping counter: 4 out of 300
EPOCH[195/2000] loss-1.129-|Sample:1.98|use_time:61.21676301956177
EPOCH[196/2000] loss-1.129-|Sample:1.00|use_time:59.93617343902588
EPOCH[197/2000] loss-1.131-|Sample:1.91|use_time:59.8776330947876
EPOCH[198/2000] loss-1.132-|Sample:1.88|use_time:60.79862999916077
EPOCH[199/2000] loss-1.134-|Sample:1.79|use_time:59.36013460159302
EPOCH[200/2000] loss-1.135-|Sample:1.92|use_time:59.699270248413086
[TEST]
{'precision': array([0.02481898, 0.01845818, 0.01153558]), 'recall': array([0.10674776, 0.15479693, 0.23920998]), 'ndcg': array([0.07179989, 0.08651057, 0.10727071]), 'coverage': array([22.94531835, 27.32871411, 32.16054931]), 'Acoverage': array([134.31021284, 180.61845559, 256.61891234]), 'ILD': array([0.73258982, 0.75130626, 0.77779541]), 'F1': array([0.18634296, 0.25670344, 0.36589073])}
test time: 279.5768163204193
reg_loss2: tensor(0.0491, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.1911, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[201/2000] loss-1.135-|Sample:1.98|use_time:60.945847272872925
EPOCH[202/2000] loss-1.135-|Sample:1.60|use_time:59.79502582550049
EPOCH[203/2000] loss-1.136-|Sample:1.89|use_time:60.25330996513367
EPOCH[204/2000] loss-1.138-|Sample:1.81|use_time:59.90711855888367
EPOCH[205/2000] loss-1.135-|Sample:1.86|use_time:60.00322651863098
loss: -1.135463964648363, EarlyStopping counter: 1 out of 300
EPOCH[206/2000] loss-1.139-|Sample:1.87|use_time:60.54076385498047
EPOCH[207/2000] loss-1.137-|Sample:1.91|use_time:59.66686153411865
loss: -1.1373560748449185, EarlyStopping counter: 1 out of 300
EPOCH[208/2000] loss-1.143-|Sample:1.90|use_time:60.483049631118774
EPOCH[209/2000] loss-1.144-|Sample:1.84|use_time:59.96373414993286
EPOCH[210/2000] loss-1.144-|Sample:1.87|use_time:60.56689715385437
EPOCH[211/2000] loss-1.143-|Sample:1.74|use_time:60.49422907829285
loss: -1.1426813718749256, EarlyStopping counter: 1 out of 300
EPOCH[212/2000] loss-1.144-|Sample:1.74|use_time:59.98296356201172
loss: -1.1437172628030545, EarlyStopping counter: 2 out of 300
EPOCH[213/2000] loss-1.144-|Sample:1.89|use_time:60.28779077529907
EPOCH[214/2000] loss-1.145-|Sample:1.73|use_time:59.479886054992676
EPOCH[215/2000] loss-1.144-|Sample:1.86|use_time:60.02571368217468
loss: -1.144291563731868, EarlyStopping counter: 1 out of 300
EPOCH[216/2000] loss-1.147-|Sample:1.88|use_time:60.43516659736633
EPOCH[217/2000] loss-1.146-|Sample:1.01|use_time:60.33421850204468
loss: -1.1460705704805327, EarlyStopping counter: 1 out of 300
EPOCH[218/2000] loss-1.147-|Sample:1.81|use_time:60.181190967559814
loss: -1.146681300023707, EarlyStopping counter: 2 out of 300
EPOCH[219/2000] loss-1.148-|Sample:1.92|use_time:60.201204776763916
EPOCH[220/2000] loss-1.148-|Sample:1.98|use_time:59.966986894607544
loss: -1.1479589473910448, EarlyStopping counter: 1 out of 300
EPOCH[221/2000] loss-1.151-|Sample:1.99|use_time:60.34784960746765
EPOCH[222/2000] loss-1.151-|Sample:1.96|use_time:59.735607624053955
EPOCH[223/2000] loss-1.151-|Sample:1.95|use_time:60.561296224594116
EPOCH[224/2000] loss-1.154-|Sample:1.58|use_time:59.54895782470703
EPOCH[225/2000] loss-1.152-|Sample:1.97|use_time:60.532727003097534
loss: -1.1524776336623401, EarlyStopping counter: 1 out of 300
EPOCH[226/2000] loss-1.155-|Sample:1.60|use_time:59.22642469406128
EPOCH[227/2000] loss-1.153-|Sample:1.96|use_time:59.82855010032654
loss: -1.153224354836999, EarlyStopping counter: 1 out of 300
EPOCH[228/2000] loss-1.155-|Sample:1.88|use_time:60.073400020599365
EPOCH[229/2000] loss-1.159-|Sample:1.88|use_time:59.737658739089966
EPOCH[230/2000] loss-1.157-|Sample:1.80|use_time:59.46554255485535
loss: -1.1566055984031864, EarlyStopping counter: 1 out of 300
EPOCH[231/2000] loss-1.154-|Sample:1.85|use_time:60.49404048919678
loss: -1.1541529922950557, EarlyStopping counter: 2 out of 300
EPOCH[232/2000] loss-1.157-|Sample:1.59|use_time:59.59767031669617
loss: -1.157263374910122, EarlyStopping counter: 3 out of 300
EPOCH[233/2000] loss-1.157-|Sample:1.82|use_time:59.61365723609924
loss: -1.1566117420429136, EarlyStopping counter: 4 out of 300
EPOCH[234/2000] loss-1.155-|Sample:1.95|use_time:60.56670117378235
loss: -1.154835945222436, EarlyStopping counter: 5 out of 300
EPOCH[235/2000] loss-1.158-|Sample:1.60|use_time:59.92214226722717
loss: -1.1584535575494534, EarlyStopping counter: 6 out of 300
EPOCH[236/2000] loss-1.161-|Sample:1.01|use_time:59.12411713600159
EPOCH[237/2000] loss-1.159-|Sample:1.95|use_time:59.84761118888855
loss: -1.1591424825714856, EarlyStopping counter: 1 out of 300
EPOCH[238/2000] loss-1.159-|Sample:1.97|use_time:60.99573230743408
loss: -1.15925349258795, EarlyStopping counter: 2 out of 300
EPOCH[239/2000] loss-1.161-|Sample:1.56|use_time:59.53820061683655
EPOCH[240/2000] loss-1.160-|Sample:1.96|use_time:59.770325660705566
loss: -1.1602348438123378, EarlyStopping counter: 1 out of 300
EPOCH[241/2000] loss-1.161-|Sample:2.01|use_time:59.98701739311218
loss: -1.1611118462027572, EarlyStopping counter: 2 out of 300
EPOCH[242/2000] loss-1.162-|Sample:1.97|use_time:60.650009870529175
EPOCH[243/2000] loss-1.160-|Sample:1.00|use_time:60.10183787345886
loss: -1.160494525258134, EarlyStopping counter: 1 out of 300
EPOCH[244/2000] loss-1.160-|Sample:1.98|use_time:60.19843554496765
loss: -1.1595742818785877, EarlyStopping counter: 2 out of 300
EPOCH[245/2000] loss-1.164-|Sample:1.96|use_time:60.11921048164368
EPOCH[246/2000] loss-1.164-|Sample:1.97|use_time:59.78660464286804
EPOCH[247/2000] loss-1.165-|Sample:1.94|use_time:60.7182080745697
EPOCH[248/2000] loss-1.167-|Sample:2.00|use_time:59.69189810752869
EPOCH[249/2000] loss-1.164-|Sample:1.95|use_time:60.412802934646606
loss: -1.164352957795306, EarlyStopping counter: 1 out of 300
EPOCH[250/2000] loss-1.165-|Sample:1.90|use_time:60.087645292282104
loss: -1.1651915660718593, EarlyStopping counter: 2 out of 300
[TEST]
{'precision': array([0.0252809 , 0.01897628, 0.01184519]), 'recall': array([0.10808008, 0.15834383, 0.24589194]), 'ndcg': array([0.07263538, 0.08811828, 0.10955533]), 'coverage': array([22.88826467, 27.39225968, 32.14207241]), 'Acoverage': array([135.16287872, 181.14545233, 257.15226394]), 'ILD': array([0.72894992, 0.74854655, 0.77707437]), 'F1': array([0.18824884, 0.26139372, 0.37357306])}
test time: 280.63953137397766
reg_loss2: tensor(0.0340, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2056, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[251/2000] loss-1.166-|Sample:2.00|use_time:60.468425989151
loss: -1.166409637869858, EarlyStopping counter: 3 out of 300
EPOCH[252/2000] loss-1.166-|Sample:1.72|use_time:59.54168772697449
loss: -1.1661082215425445, EarlyStopping counter: 4 out of 300
EPOCH[253/2000] loss-1.166-|Sample:1.93|use_time:59.9219388961792
loss: -1.1660453691715147, EarlyStopping counter: 5 out of 300
EPOCH[254/2000] loss-1.164-|Sample:1.00|use_time:60.001972675323486
loss: -1.1643045733614665, EarlyStopping counter: 6 out of 300
EPOCH[255/2000] loss-1.167-|Sample:1.88|use_time:60.02666997909546
loss: -1.1665223022786582, EarlyStopping counter: 7 out of 300
EPOCH[256/2000] loss-1.169-|Sample:1.93|use_time:59.792545795440674
EPOCH[257/2000] loss-1.169-|Sample:1.81|use_time:60.474494218826294
loss: -1.1686134076699979, EarlyStopping counter: 1 out of 300
EPOCH[258/2000] loss-1.168-|Sample:1.71|use_time:60.40450143814087
loss: -1.1681852398849115, EarlyStopping counter: 2 out of 300
EPOCH[259/2000] loss-1.170-|Sample:1.00|use_time:59.61878037452698
EPOCH[260/2000] loss-1.168-|Sample:1.79|use_time:59.48993897438049
loss: -1.1675944270157232, EarlyStopping counter: 1 out of 300
EPOCH[261/2000] loss-1.169-|Sample:1.86|use_time:60.97799491882324
loss: -1.169139332887603, EarlyStopping counter: 2 out of 300
EPOCH[262/2000] loss-1.170-|Sample:1.47|use_time:59.57089400291443
EPOCH[263/2000] loss-1.171-|Sample:2.02|use_time:59.725427865982056
EPOCH[264/2000] loss-1.173-|Sample:1.97|use_time:59.741255044937134
EPOCH[265/2000] loss-1.169-|Sample:1.97|use_time:60.24068737030029
loss: -1.169149076066366, EarlyStopping counter: 1 out of 300
EPOCH[266/2000] loss-1.172-|Sample:1.01|use_time:60.077213525772095
loss: -1.171719013190851, EarlyStopping counter: 2 out of 300
EPOCH[267/2000] loss-1.171-|Sample:1.98|use_time:60.09894633293152
loss: -1.1707261451860753, EarlyStopping counter: 3 out of 300
EPOCH[268/2000] loss-1.173-|Sample:1.91|use_time:59.70304870605469
EPOCH[269/2000] loss-1.174-|Sample:1.93|use_time:60.08583354949951
EPOCH[270/2000] loss-1.176-|Sample:2.02|use_time:60.56068158149719
EPOCH[271/2000] loss-1.175-|Sample:1.91|use_time:59.832202434539795
loss: -1.1750297808065646, EarlyStopping counter: 1 out of 300
EPOCH[272/2000] loss-1.175-|Sample:1.98|use_time:60.70946264266968
loss: -1.1753984747863397, EarlyStopping counter: 2 out of 300
EPOCH[273/2000] loss-1.174-|Sample:1.57|use_time:59.20942425727844
loss: -1.1743008508914854, EarlyStopping counter: 3 out of 300
EPOCH[274/2000] loss-1.175-|Sample:2.00|use_time:60.97669959068298
loss: -1.174968190309478, EarlyStopping counter: 4 out of 300
EPOCH[275/2000] loss-1.174-|Sample:1.54|use_time:59.595301389694214
loss: -1.1739605403527982, EarlyStopping counter: 5 out of 300
EPOCH[276/2000] loss-1.175-|Sample:1.97|use_time:59.923051595687866
loss: -1.175437726625582, EarlyStopping counter: 6 out of 300
EPOCH[277/2000] loss-1.177-|Sample:1.99|use_time:60.17576789855957
EPOCH[278/2000] loss-1.177-|Sample:1.93|use_time:59.91308069229126
EPOCH[279/2000] loss-1.175-|Sample:1.89|use_time:59.760788917541504
loss: -1.1750404573068387, EarlyStopping counter: 1 out of 300
EPOCH[280/2000] loss-1.176-|Sample:1.94|use_time:60.489389419555664
loss: -1.1756462323956374, EarlyStopping counter: 2 out of 300
EPOCH[281/2000] loss-1.176-|Sample:1.78|use_time:59.63334846496582
loss: -1.1761202201610659, EarlyStopping counter: 3 out of 300
EPOCH[282/2000] loss-1.177-|Sample:1.80|use_time:59.600157260894775
EPOCH[283/2000] loss-1.177-|Sample:1.75|use_time:60.45416808128357
loss: -1.1768519093350667, EarlyStopping counter: 1 out of 300
EPOCH[284/2000] loss-1.179-|Sample:1.55|use_time:59.93091678619385
EPOCH[285/2000] loss-1.177-|Sample:1.02|use_time:59.0498583316803
loss: -1.1773075301472733, EarlyStopping counter: 1 out of 300
EPOCH[286/2000] loss-1.178-|Sample:1.90|use_time:59.49987745285034
loss: -1.1780589528200103, EarlyStopping counter: 2 out of 300
EPOCH[287/2000] loss-1.177-|Sample:1.97|use_time:60.34956932067871
loss: -1.1774797265122576, EarlyStopping counter: 3 out of 300
EPOCH[288/2000] loss-1.178-|Sample:1.49|use_time:59.46112895011902
loss: -1.1780406323874868, EarlyStopping counter: 4 out of 300
EPOCH[289/2000] loss-1.180-|Sample:1.97|use_time:59.87082481384277
EPOCH[290/2000] loss-1.180-|Sample:1.97|use_time:59.8133225440979
EPOCH[291/2000] loss-1.177-|Sample:1.98|use_time:60.173710107803345
loss: -1.1767145337128058, EarlyStopping counter: 1 out of 300
EPOCH[292/2000] loss-1.179-|Sample:0.99|use_time:59.93602919578552
loss: -1.1785689388833396, EarlyStopping counter: 2 out of 300
EPOCH[293/2000] loss-1.178-|Sample:1.97|use_time:59.897926330566406
loss: -1.1780781745910645, EarlyStopping counter: 3 out of 300
EPOCH[294/2000] loss-1.180-|Sample:1.97|use_time:59.633800745010376
loss: -1.1795684128272823, EarlyStopping counter: 4 out of 300
EPOCH[295/2000] loss-1.179-|Sample:1.96|use_time:59.612486839294434
loss: -1.1794720713685198, EarlyStopping counter: 5 out of 300
EPOCH[296/2000] loss-1.181-|Sample:1.98|use_time:60.24623775482178
EPOCH[297/2000] loss-1.179-|Sample:1.96|use_time:60.01778817176819
loss: -1.17857187259488, EarlyStopping counter: 1 out of 300
EPOCH[298/2000] loss-1.180-|Sample:1.96|use_time:60.408400535583496
loss: -1.1796533974205576, EarlyStopping counter: 2 out of 300
EPOCH[299/2000] loss-1.182-|Sample:1.62|use_time:59.6356725692749
EPOCH[300/2000] loss-1.182-|Sample:2.01|use_time:60.97716212272644
loss: -1.1815877513187687, EarlyStopping counter: 1 out of 300
[TEST]
{'precision': array([0.02596754, 0.01931336, 0.01198752]), 'recall': array([0.11149359, 0.16069772, 0.24737985]), 'ndcg': array([0.07440423, 0.08952064, 0.11087217]), 'coverage': array([22.92833958, 27.32546816, 32.09650437]), 'Acoverage': array([135.84824762, 181.65273895, 257.25562863]), 'ILD': array([0.73152726, 0.7505296 , 0.77816729]), 'F1': array([0.19349605, 0.26471638, 0.37541503])}
test time: 282.1932668685913
reg_loss2: tensor(0.0255, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2441, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[301/2000] loss-1.183-|Sample:1.98|use_time:59.61389350891113
EPOCH[302/2000] loss-1.182-|Sample:2.00|use_time:59.80477786064148
loss: -1.1817729444038578, EarlyStopping counter: 1 out of 300
EPOCH[303/2000] loss-1.182-|Sample:1.00|use_time:59.601378440856934
loss: -1.1822573353604573, EarlyStopping counter: 2 out of 300
EPOCH[304/2000] loss-1.182-|Sample:1.99|use_time:59.929311990737915
loss: -1.182136512384182, EarlyStopping counter: 3 out of 300
EPOCH[305/2000] loss-1.182-|Sample:1.99|use_time:59.6614875793457
loss: -1.1821833092991898, EarlyStopping counter: 4 out of 300
EPOCH[306/2000] loss-1.181-|Sample:1.97|use_time:60.77851963043213
loss: -1.1811109519586331, EarlyStopping counter: 5 out of 300
EPOCH[307/2000] loss-1.184-|Sample:1.75|use_time:60.52216815948486
EPOCH[308/2000] loss-1.185-|Sample:1.00|use_time:59.43726420402527
EPOCH[309/2000] loss-1.183-|Sample:1.97|use_time:59.636051177978516
loss: -1.1827601194381714, EarlyStopping counter: 1 out of 300
EPOCH[310/2000] loss-1.185-|Sample:1.97|use_time:60.86750531196594
EPOCH[311/2000] loss-1.183-|Sample:1.49|use_time:59.11974048614502
loss: -1.182744662936141, EarlyStopping counter: 1 out of 300
EPOCH[312/2000] loss-1.186-|Sample:2.01|use_time:59.80842185020447
EPOCH[313/2000] loss-1.185-|Sample:1.95|use_time:59.71824073791504
loss: -1.1853463388070828, EarlyStopping counter: 1 out of 300
EPOCH[314/2000] loss-1.185-|Sample:1.98|use_time:60.10103464126587
loss: -1.1852883013283335, EarlyStopping counter: 2 out of 300
EPOCH[315/2000] loss-1.184-|Sample:1.01|use_time:59.765064001083374
loss: -1.1839439694474383, EarlyStopping counter: 3 out of 300
EPOCH[316/2000] loss-1.186-|Sample:1.96|use_time:59.687952280044556
loss: -1.185685108347637, EarlyStopping counter: 4 out of 300
EPOCH[317/2000] loss-1.184-|Sample:1.92|use_time:60.219435930252075
loss: -1.1841585810591535, EarlyStopping counter: 5 out of 300
EPOCH[318/2000] loss-1.185-|Sample:1.94|use_time:59.88925814628601
loss: -1.1850431924912987, EarlyStopping counter: 6 out of 300
EPOCH[319/2000] loss-1.187-|Sample:1.99|use_time:60.67580699920654
EPOCH[320/2000] loss-1.188-|Sample:1.85|use_time:59.88504505157471
EPOCH[321/2000] loss-1.186-|Sample:1.96|use_time:60.825480937957764
loss: -1.1857916087639042, EarlyStopping counter: 1 out of 300
EPOCH[322/2000] loss-1.185-|Sample:1.57|use_time:59.174121379852295
loss: -1.1848704029874104, EarlyStopping counter: 2 out of 300
EPOCH[323/2000] loss-1.188-|Sample:2.04|use_time:60.68649959564209
EPOCH[324/2000] loss-1.188-|Sample:1.60|use_time:59.67602753639221
loss: -1.187538109174589, EarlyStopping counter: 1 out of 300
EPOCH[325/2000] loss-1.186-|Sample:1.97|use_time:60.00563669204712
loss: -1.1862964862730445, EarlyStopping counter: 2 out of 300
EPOCH[326/2000] loss-1.186-|Sample:1.98|use_time:59.95656943321228
loss: -1.1860073136120308, EarlyStopping counter: 3 out of 300
EPOCH[327/2000] loss-1.186-|Sample:1.99|use_time:59.950658321380615
loss: -1.1860218542378123, EarlyStopping counter: 4 out of 300
EPOCH[328/2000] loss-1.187-|Sample:1.95|use_time:59.59144854545593
loss: -1.1873388348556146, EarlyStopping counter: 5 out of 300
EPOCH[329/2000] loss-1.188-|Sample:1.94|use_time:60.47830891609192
loss: -1.1877862738399971, EarlyStopping counter: 6 out of 300
EPOCH[330/2000] loss-1.186-|Sample:0.98|use_time:59.71330189704895
loss: -1.1862764387595943, EarlyStopping counter: 7 out of 300
EPOCH[331/2000] loss-1.187-|Sample:1.95|use_time:60.0187554359436
loss: -1.1866423851106225, EarlyStopping counter: 8 out of 300
EPOCH[332/2000] loss-1.187-|Sample:1.98|use_time:59.836994886398315
loss: -1.187260613208864, EarlyStopping counter: 9 out of 300
EPOCH[333/2000] loss-1.190-|Sample:1.98|use_time:59.804189920425415
EPOCH[334/2000] loss-1.191-|Sample:1.99|use_time:60.29947519302368
EPOCH[335/2000] loss-1.190-|Sample:1.96|use_time:59.94123458862305
loss: -1.1896194684796217, EarlyStopping counter: 1 out of 300
EPOCH[336/2000] loss-1.188-|Sample:1.92|use_time:60.72848320007324
loss: -1.1877992472997525, EarlyStopping counter: 2 out of 300
EPOCH[337/2000] loss-1.190-|Sample:1.97|use_time:59.595277070999146
loss: -1.1895904599166498, EarlyStopping counter: 3 out of 300
EPOCH[338/2000] loss-1.190-|Sample:1.97|use_time:60.905006647109985
loss: -1.1903020928545696, EarlyStopping counter: 4 out of 300
EPOCH[339/2000] loss-1.191-|Sample:1.63|use_time:59.6855788230896
loss: -1.1906764042086717, EarlyStopping counter: 5 out of 300
EPOCH[340/2000] loss-1.189-|Sample:2.00|use_time:60.14354586601257
loss: -1.1893805178200327, EarlyStopping counter: 6 out of 300
EPOCH[341/2000] loss-1.191-|Sample:1.97|use_time:59.80996108055115
loss: -1.1909815421918544, EarlyStopping counter: 7 out of 300
EPOCH[342/2000] loss-1.191-|Sample:1.96|use_time:59.62083172798157
loss: -1.1907757985882643, EarlyStopping counter: 8 out of 300
EPOCH[343/2000] loss-1.191-|Sample:1.97|use_time:59.45288705825806
loss: -1.1908284832791585, EarlyStopping counter: 9 out of 300
EPOCH[344/2000] loss-1.190-|Sample:1.98|use_time:60.385775327682495
loss: -1.1904585942989443, EarlyStopping counter: 10 out of 300
EPOCH[345/2000] loss-1.191-|Sample:0.99|use_time:59.864240407943726
loss: -1.1908302830486763, EarlyStopping counter: 11 out of 300
EPOCH[346/2000] loss-1.190-|Sample:1.90|use_time:60.272666931152344
loss: -1.1902075976860234, EarlyStopping counter: 12 out of 300
EPOCH[347/2000] loss-1.189-|Sample:1.91|use_time:59.54827690124512
loss: -1.1891387293978435, EarlyStopping counter: 13 out of 300
EPOCH[348/2000] loss-1.192-|Sample:1.97|use_time:59.76462721824646
EPOCH[349/2000] loss-1.190-|Sample:2.01|use_time:60.11008667945862
loss: -1.1897064825383628, EarlyStopping counter: 1 out of 300
EPOCH[350/2000] loss-1.190-|Sample:1.92|use_time:59.60169792175293
loss: -1.1901290649321021, EarlyStopping counter: 2 out of 300
[TEST]
{'precision': array([0.02606742, 0.01942572, 0.01205743]), 'recall': array([0.11212509, 0.16233954, 0.24862076]), 'ndcg': array([0.07481578, 0.09021706, 0.11154776]), 'coverage': array([23.00586767, 27.37478152, 32.31922597]), 'Acoverage': array([136.40312719, 182.23703907, 258.13174081]), 'ILD': array([0.73027882, 0.74864446, 0.7773794 ]), 'F1': array([0.19440218, 0.26682049, 0.37674976])}
test time: 282.19740891456604
reg_loss2: tensor(0.0203, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2357, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[351/2000] loss-1.193-|Sample:1.98|use_time:61.24608850479126
EPOCH[352/2000] loss-1.192-|Sample:1.57|use_time:59.77144193649292
loss: -1.1922132154790366, EarlyStopping counter: 1 out of 300
EPOCH[353/2000] loss-1.191-|Sample:1.98|use_time:59.94762682914734
loss: -1.1912328440968583, EarlyStopping counter: 2 out of 300
EPOCH[354/2000] loss-1.193-|Sample:1.99|use_time:59.90321350097656
EPOCH[355/2000] loss-1.192-|Sample:1.98|use_time:60.28697109222412
loss: -1.1921518401401798, EarlyStopping counter: 1 out of 300
EPOCH[356/2000] loss-1.193-|Sample:1.94|use_time:59.68240809440613
EPOCH[357/2000] loss-1.193-|Sample:1.91|use_time:59.85187530517578
loss: -1.1929064901863657, EarlyStopping counter: 1 out of 300
EPOCH[358/2000] loss-1.190-|Sample:1.76|use_time:60.46891903877258
loss: -1.1901138352184761, EarlyStopping counter: 2 out of 300
EPOCH[359/2000] loss-1.192-|Sample:1.71|use_time:59.76471138000488
loss: -1.1921809272068302, EarlyStopping counter: 3 out of 300
EPOCH[360/2000] loss-1.192-|Sample:1.78|use_time:60.51417851448059
loss: -1.192463028721693, EarlyStopping counter: 4 out of 300
EPOCH[361/2000] loss-1.193-|Sample:1.04|use_time:59.48548603057861
loss: -1.1928364968881375, EarlyStopping counter: 5 out of 300
EPOCH[362/2000] loss-1.191-|Sample:1.73|use_time:59.8362021446228
loss: -1.1912944520392068, EarlyStopping counter: 6 out of 300
EPOCH[363/2000] loss-1.193-|Sample:1.83|use_time:60.8326141834259
loss: -1.1927387074726383, EarlyStopping counter: 7 out of 300
EPOCH[364/2000] loss-1.193-|Sample:1.66|use_time:59.711392402648926
EPOCH[365/2000] loss-1.191-|Sample:1.93|use_time:59.621771574020386
loss: -1.1905199783604319, EarlyStopping counter: 1 out of 300
EPOCH[366/2000] loss-1.191-|Sample:1.76|use_time:59.587932109832764
loss: -1.1907409691229098, EarlyStopping counter: 2 out of 300
EPOCH[367/2000] loss-1.195-|Sample:1.97|use_time:60.33967304229736
EPOCH[368/2000] loss-1.194-|Sample:1.97|use_time:59.797184228897095
loss: -1.193764105075743, EarlyStopping counter: 1 out of 300
EPOCH[369/2000] loss-1.194-|Sample:2.01|use_time:60.40711498260498
loss: -1.1943361962713845, EarlyStopping counter: 2 out of 300
EPOCH[370/2000] loss-1.194-|Sample:2.02|use_time:60.23826813697815
loss: -1.193642482524965, EarlyStopping counter: 3 out of 300
EPOCH[371/2000] loss-1.193-|Sample:1.99|use_time:60.983726501464844
loss: -1.1932314547096812, EarlyStopping counter: 4 out of 300
EPOCH[372/2000] loss-1.193-|Sample:1.03|use_time:59.663968324661255
loss: -1.1925252646934696, EarlyStopping counter: 5 out of 300
EPOCH[373/2000] loss-1.194-|Sample:2.02|use_time:60.27081847190857
loss: -1.1943785679049608, EarlyStopping counter: 6 out of 300
EPOCH[374/2000] loss-1.193-|Sample:2.01|use_time:61.205809593200684
loss: -1.1934380647612781, EarlyStopping counter: 7 out of 300
EPOCH[375/2000] loss-1.194-|Sample:1.61|use_time:59.659828186035156
loss: -1.1939532029919508, EarlyStopping counter: 8 out of 300
EPOCH[376/2000] loss-1.195-|Sample:2.04|use_time:60.2437903881073
loss: -1.1947746015176541, EarlyStopping counter: 9 out of 300
EPOCH[377/2000] loss-1.193-|Sample:2.03|use_time:60.49261689186096
loss: -1.1930811085352084, EarlyStopping counter: 10 out of 300
EPOCH[378/2000] loss-1.195-|Sample:2.07|use_time:60.64651417732239
EPOCH[379/2000] loss-1.194-|Sample:1.06|use_time:60.18865990638733
loss: -1.194458757958761, EarlyStopping counter: 1 out of 300
EPOCH[380/2000] loss-1.193-|Sample:2.07|use_time:60.59866905212402
loss: -1.1930016657201254, EarlyStopping counter: 2 out of 300
EPOCH[381/2000] loss-1.194-|Sample:1.94|use_time:60.073190689086914
loss: -1.1939263198433854, EarlyStopping counter: 3 out of 300
EPOCH[382/2000] loss-1.193-|Sample:1.99|use_time:60.11474680900574
loss: -1.1926619861184098, EarlyStopping counter: 4 out of 300
EPOCH[383/2000] loss-1.195-|Sample:1.98|use_time:60.67066240310669
loss: -1.1950560982634382, EarlyStopping counter: 5 out of 300
EPOCH[384/2000] loss-1.194-|Sample:1.96|use_time:60.32311534881592
loss: -1.1938767578543685, EarlyStopping counter: 6 out of 300
EPOCH[385/2000] loss-1.194-|Sample:2.00|use_time:60.93946719169617
loss: -1.1938231979928366, EarlyStopping counter: 7 out of 300
EPOCH[386/2000] loss-1.197-|Sample:1.88|use_time:59.8754346370697
EPOCH[387/2000] loss-1.195-|Sample:2.05|use_time:61.18246006965637
loss: -1.1950624250784152, EarlyStopping counter: 1 out of 300
EPOCH[388/2000] loss-1.193-|Sample:1.56|use_time:59.586130142211914
loss: -1.1934645757442568, EarlyStopping counter: 2 out of 300
EPOCH[389/2000] loss-1.196-|Sample:2.01|use_time:60.19584012031555
loss: -1.196235197346385, EarlyStopping counter: 3 out of 300
EPOCH[390/2000] loss-1.195-|Sample:1.92|use_time:60.06856656074524
loss: -1.1954748514221936, EarlyStopping counter: 4 out of 300
EPOCH[391/2000] loss-1.195-|Sample:2.00|use_time:60.36701321601868
loss: -1.1949167338813222, EarlyStopping counter: 5 out of 300
EPOCH[392/2000] loss-1.195-|Sample:2.05|use_time:60.106499671936035
loss: -1.194769900019576, EarlyStopping counter: 6 out of 300
EPOCH[393/2000] loss-1.194-|Sample:2.02|use_time:60.847514390945435
loss: -1.1942487867867075, EarlyStopping counter: 7 out of 300
EPOCH[394/2000] loss-1.195-|Sample:1.92|use_time:60.246992349624634
loss: -1.1954085855949215, EarlyStopping counter: 8 out of 300
EPOCH[395/2000] loss-1.199-|Sample:2.00|use_time:60.520559549331665
EPOCH[396/2000] loss-1.196-|Sample:1.99|use_time:60.80861973762512
loss: -1.1957297761265824, EarlyStopping counter: 1 out of 300
EPOCH[397/2000] loss-1.196-|Sample:2.00|use_time:61.24853229522705
loss: -1.195872385327409, EarlyStopping counter: 2 out of 300
EPOCH[398/2000] loss-1.197-|Sample:1.04|use_time:59.804266929626465
loss: -1.1970882066866246, EarlyStopping counter: 3 out of 300
EPOCH[399/2000] loss-1.197-|Sample:2.04|use_time:59.99673581123352
loss: -1.196987797574299, EarlyStopping counter: 4 out of 300
EPOCH[400/2000] loss-1.197-|Sample:2.01|use_time:61.04666209220886
loss: -1.1968414521798856, EarlyStopping counter: 5 out of 300
[TEST]
{'precision': array([0.02605493, 0.01943196, 0.01210487]), 'recall': array([0.1112792 , 0.1631232 , 0.25074947]), 'ndcg': array([0.07445089, 0.09024435, 0.11188616]), 'coverage': array([23.11173533, 27.45617978, 32.41672909]), 'Acoverage': array([136.6432569 , 182.48047562, 258.53043756]), 'ILD': array([0.7280233 , 0.74720021, 0.77595016]), 'F1': array([0.19305042, 0.26778547, 0.37901853])}
test time: 285.39850902557373
reg_loss2: tensor(0.0169, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2181, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[401/2000] loss-1.197-|Sample:2.10|use_time:60.2248260974884
loss: -1.1965714053409855, EarlyStopping counter: 6 out of 300
EPOCH[402/2000] loss-1.198-|Sample:1.86|use_time:60.74718141555786
loss: -1.1983600971175403, EarlyStopping counter: 7 out of 300
EPOCH[403/2000] loss-1.199-|Sample:1.94|use_time:60.339247941970825
loss: -1.1988113507991884, EarlyStopping counter: 8 out of 300
EPOCH[404/2000] loss-1.197-|Sample:2.03|use_time:60.25494432449341
loss: -1.1966281751307046, EarlyStopping counter: 9 out of 300
EPOCH[405/2000] loss-1.198-|Sample:2.05|use_time:60.44851565361023
loss: -1.1982542508985938, EarlyStopping counter: 10 out of 300
EPOCH[406/2000] loss-1.197-|Sample:2.03|use_time:59.948429107666016
loss: -1.1971343494043118, EarlyStopping counter: 11 out of 300
EPOCH[407/2000] loss-1.199-|Sample:1.99|use_time:60.829495668411255
loss: -1.1985165782091094, EarlyStopping counter: 12 out of 300
EPOCH[408/2000] loss-1.199-|Sample:1.91|use_time:60.88578915596008
loss: -1.1987390692641096, EarlyStopping counter: 13 out of 300
EPOCH[409/2000] loss-1.198-|Sample:1.06|use_time:59.652615785598755
loss: -1.1976265354854305, EarlyStopping counter: 14 out of 300
EPOCH[410/2000] loss-1.198-|Sample:2.09|use_time:60.58301115036011
loss: -1.1979922492329667, EarlyStopping counter: 15 out of 300
EPOCH[411/2000] loss-1.198-|Sample:2.03|use_time:61.57702398300171
loss: -1.198357352396337, EarlyStopping counter: 16 out of 300
EPOCH[412/2000] loss-1.197-|Sample:1.54|use_time:59.91703772544861
loss: -1.1974188351049655, EarlyStopping counter: 17 out of 300
EPOCH[413/2000] loss-1.198-|Sample:2.05|use_time:60.70848989486694
loss: -1.1976594866775885, EarlyStopping counter: 18 out of 300
EPOCH[414/2000] loss-1.196-|Sample:2.04|use_time:60.71861815452576
loss: -1.1962847651504889, EarlyStopping counter: 19 out of 300
EPOCH[415/2000] loss-1.198-|Sample:2.03|use_time:61.14734649658203
loss: -1.1980796645327312, EarlyStopping counter: 20 out of 300
EPOCH[416/2000] loss-1.199-|Sample:1.04|use_time:60.40200591087341
EPOCH[417/2000] loss-1.200-|Sample:1.97|use_time:60.2948784828186
EPOCH[418/2000] loss-1.199-|Sample:2.09|use_time:60.60964632034302
loss: -1.1987398979140491, EarlyStopping counter: 1 out of 300
EPOCH[419/2000] loss-1.198-|Sample:1.90|use_time:60.287673234939575
loss: -1.1980590442331827, EarlyStopping counter: 2 out of 300
EPOCH[420/2000] loss-1.196-|Sample:2.01|use_time:61.53446078300476
loss: -1.1958360439393578, EarlyStopping counter: 3 out of 300
EPOCH[421/2000] loss-1.199-|Sample:1.99|use_time:61.2269651889801
loss: -1.1987810367491187, EarlyStopping counter: 4 out of 300
EPOCH[422/2000] loss-1.196-|Sample:3.05|use_time:65.10974740982056
loss: -1.195683842752038, EarlyStopping counter: 5 out of 300
EPOCH[423/2000] loss-1.198-|Sample:2.00|use_time:60.035194873809814
loss: -1.1984325472901507, EarlyStopping counter: 6 out of 300
EPOCH[424/2000] loss-1.197-|Sample:2.07|use_time:60.72825860977173
loss: -1.1971361724341787, EarlyStopping counter: 7 out of 300
EPOCH[425/2000] loss-1.198-|Sample:1.61|use_time:58.847230195999146
loss: -1.1981298022153901, EarlyStopping counter: 8 out of 300
EPOCH[426/2000] loss-1.196-|Sample:2.04|use_time:60.334784269332886
loss: -1.1964811057579228, EarlyStopping counter: 9 out of 300
EPOCH[427/2000] loss-1.198-|Sample:2.06|use_time:59.44557738304138
loss: -1.1980842177460833, EarlyStopping counter: 10 out of 300
EPOCH[428/2000] loss-1.199-|Sample:2.03|use_time:58.82188844680786
loss: -1.198581561809633, EarlyStopping counter: 11 out of 300
EPOCH[429/2000] loss-1.199-|Sample:2.03|use_time:58.676161766052246
loss: -1.1994718196915417, EarlyStopping counter: 12 out of 300
EPOCH[430/2000] loss-1.199-|Sample:2.02|use_time:59.376322507858276
loss: -1.1988785295951656, EarlyStopping counter: 13 out of 300
EPOCH[431/2000] loss-1.199-|Sample:2.02|use_time:58.98363709449768
loss: -1.199468830736672, EarlyStopping counter: 14 out of 300
EPOCH[432/2000] loss-1.199-|Sample:2.00|use_time:58.78712487220764
loss: -1.1986242212900302, EarlyStopping counter: 15 out of 300
EPOCH[433/2000] loss-1.200-|Sample:2.00|use_time:60.42733812332153
EPOCH[434/2000] loss-1.199-|Sample:2.06|use_time:59.74520945549011
loss: -1.1986333364393653, EarlyStopping counter: 1 out of 300
EPOCH[435/2000] loss-1.198-|Sample:1.08|use_time:58.41858172416687
loss: -1.1975999808892972, EarlyStopping counter: 2 out of 300
EPOCH[436/2000] loss-1.199-|Sample:1.99|use_time:58.89951705932617
loss: -1.1988311831544085, EarlyStopping counter: 3 out of 300
EPOCH[437/2000] loss-1.199-|Sample:1.99|use_time:60.055426359176636
loss: -1.1986656450643771, EarlyStopping counter: 4 out of 300
EPOCH[438/2000] loss-1.197-|Sample:1.61|use_time:58.85336136817932
loss: -1.1969639121032343, EarlyStopping counter: 5 out of 300
EPOCH[439/2000] loss-1.200-|Sample:2.14|use_time:59.3239483833313
loss: -1.1999030636578072, EarlyStopping counter: 6 out of 300
EPOCH[440/2000] loss-1.200-|Sample:2.00|use_time:58.85758137702942
EPOCH[441/2000] loss-1.199-|Sample:2.02|use_time:59.079421520233154
loss: -1.1992540504874252, EarlyStopping counter: 1 out of 300
EPOCH[442/2000] loss-1.200-|Sample:1.07|use_time:59.23562693595886
loss: -1.2003674565291986, EarlyStopping counter: 2 out of 300
EPOCH[443/2000] loss-1.199-|Sample:2.06|use_time:60.60091471672058
loss: -1.1992219860960798, EarlyStopping counter: 3 out of 300
EPOCH[444/2000] loss-1.199-|Sample:2.20|use_time:60.25699782371521
loss: -1.1993421839504708, EarlyStopping counter: 4 out of 300
EPOCH[445/2000] loss-1.199-|Sample:2.02|use_time:59.72294330596924
loss: -1.1993122158980951, EarlyStopping counter: 5 out of 300
EPOCH[446/2000] loss-1.200-|Sample:2.19|use_time:60.05240440368652
loss: -1.2002406411054658, EarlyStopping counter: 6 out of 300
EPOCH[447/2000] loss-1.201-|Sample:2.03|use_time:59.64677357673645
EPOCH[448/2000] loss-1.200-|Sample:2.04|use_time:59.96400499343872
loss: -1.1995979518425175, EarlyStopping counter: 1 out of 300
EPOCH[449/2000] loss-1.202-|Sample:1.90|use_time:59.03417134284973
EPOCH[450/2000] loss-1.200-|Sample:2.04|use_time:61.32529425621033
loss: -1.2004625477441928, EarlyStopping counter: 1 out of 300
[TEST]
{'precision': array([0.02606742, 0.0196005 , 0.01215231]), 'recall': array([0.11177658, 0.1636513 , 0.25138026]), 'ndcg': array([0.07490328, 0.09078028, 0.11241212]), 'coverage': array([23.16716604, 27.40811486, 32.41011236]), 'Acoverage': array([136.52400962, 182.58626108, 259.12824518]), 'ILD': array([0.72820086, 0.74528221, 0.77486978]), 'F1': array([0.19380473, 0.26837255, 0.37960918])}
test time: 283.7050745487213
reg_loss2: tensor(0.0146, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2336, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[451/2000] loss-1.202-|Sample:2.05|use_time:59.40513801574707
loss: -1.2015113510736606, EarlyStopping counter: 2 out of 300
EPOCH[452/2000] loss-1.199-|Sample:2.04|use_time:59.89893817901611
loss: -1.199442430240352, EarlyStopping counter: 3 out of 300
EPOCH[453/2000] loss-1.200-|Sample:1.08|use_time:59.0077919960022
loss: -1.1997185102323207, EarlyStopping counter: 4 out of 300
EPOCH[454/2000] loss-1.202-|Sample:2.04|use_time:59.11347770690918
EPOCH[455/2000] loss-1.202-|Sample:2.02|use_time:58.80636477470398
loss: -1.2019368613638528, EarlyStopping counter: 1 out of 300
EPOCH[456/2000] loss-1.202-|Sample:2.08|use_time:60.47213268280029
loss: -1.2019838588993723, EarlyStopping counter: 2 out of 300
EPOCH[457/2000] loss-1.200-|Sample:2.02|use_time:60.73296546936035
loss: -1.200012794355067, EarlyStopping counter: 3 out of 300
EPOCH[458/2000] loss-1.201-|Sample:1.10|use_time:59.24269986152649
loss: -1.2009502300402013, EarlyStopping counter: 4 out of 300
EPOCH[459/2000] loss-1.201-|Sample:2.12|use_time:59.35929775238037
loss: -1.2013621388412103, EarlyStopping counter: 5 out of 300
EPOCH[460/2000] loss-1.201-|Sample:2.04|use_time:60.02428483963013
loss: -1.2010392183210792, EarlyStopping counter: 6 out of 300
EPOCH[461/2000] loss-1.198-|Sample:1.80|use_time:58.769917249679565
loss: -1.1983972119122017, EarlyStopping counter: 7 out of 300
EPOCH[462/2000] loss-1.201-|Sample:1.99|use_time:59.1078884601593
loss: -1.2013185489468459, EarlyStopping counter: 8 out of 300
EPOCH[463/2000] loss-1.199-|Sample:2.10|use_time:60.11271405220032
loss: -1.1987801557633935, EarlyStopping counter: 9 out of 300
EPOCH[464/2000] loss-1.202-|Sample:2.04|use_time:59.73527503013611
loss: -1.2017704190277472, EarlyStopping counter: 10 out of 300
EPOCH[465/2000] loss-1.200-|Sample:1.13|use_time:59.71725940704346
loss: -1.200133146309271, EarlyStopping counter: 11 out of 300
EPOCH[466/2000] loss-1.200-|Sample:2.10|use_time:59.64659905433655
loss: -1.2004948505541173, EarlyStopping counter: 12 out of 300
EPOCH[467/2000] loss-1.199-|Sample:2.02|use_time:59.48537015914917
loss: -1.1994045623918859, EarlyStopping counter: 13 out of 300
EPOCH[468/2000] loss-1.202-|Sample:2.10|use_time:59.39534306526184
loss: -1.2015813385568015, EarlyStopping counter: 14 out of 300
EPOCH[469/2000] loss-1.202-|Sample:2.07|use_time:59.82972240447998
EPOCH[470/2000] loss-1.201-|Sample:2.05|use_time:58.963579177856445
loss: -1.201455755931575, EarlyStopping counter: 1 out of 300
EPOCH[471/2000] loss-1.203-|Sample:2.05|use_time:59.478198289871216
EPOCH[472/2000] loss-1.200-|Sample:1.64|use_time:58.04970622062683
loss: -1.2003690556782047, EarlyStopping counter: 1 out of 300
EPOCH[473/2000] loss-1.202-|Sample:1.99|use_time:59.90281939506531
loss: -1.2020219099230882, EarlyStopping counter: 2 out of 300
EPOCH[474/2000] loss-1.200-|Sample:2.02|use_time:59.01590919494629
loss: -1.200371175277524, EarlyStopping counter: 3 out of 300
EPOCH[475/2000] loss-1.202-|Sample:2.09|use_time:59.424795150756836
loss: -1.2020874634021665, EarlyStopping counter: 4 out of 300
EPOCH[476/2000] loss-1.202-|Sample:2.12|use_time:59.83961057662964
loss: -1.2017963775774327, EarlyStopping counter: 5 out of 300
EPOCH[477/2000] loss-1.200-|Sample:2.04|use_time:59.11933946609497
loss: -1.200150382228014, EarlyStopping counter: 6 out of 300
EPOCH[478/2000] loss-1.204-|Sample:2.11|use_time:59.23354625701904
EPOCH[479/2000] loss-1.201-|Sample:2.02|use_time:60.590237855911255
loss: -1.2013564982065341, EarlyStopping counter: 1 out of 300
EPOCH[480/2000] loss-1.203-|Sample:2.56|use_time:60.575568199157715
loss: -1.2029620118257476, EarlyStopping counter: 2 out of 300
EPOCH[481/2000] loss-1.201-|Sample:2.13|use_time:58.76727294921875
loss: -1.2010180514033248, EarlyStopping counter: 3 out of 300
EPOCH[482/2000] loss-1.202-|Sample:2.11|use_time:59.897072553634644
loss: -1.202200084197812, EarlyStopping counter: 4 out of 300
EPOCH[483/2000] loss-1.202-|Sample:2.13|use_time:60.75396466255188
loss: -1.2018493472076044, EarlyStopping counter: 5 out of 300
EPOCH[484/2000] loss-1.201-|Sample:1.12|use_time:59.29370737075806
loss: -1.2009857776688366, EarlyStopping counter: 6 out of 300
EPOCH[485/2000] loss-1.202-|Sample:2.07|use_time:59.0602490901947
loss: -1.2018714823373935, EarlyStopping counter: 7 out of 300
EPOCH[486/2000] loss-1.201-|Sample:2.02|use_time:59.69992423057556
loss: -1.2013267365897573, EarlyStopping counter: 8 out of 300
EPOCH[487/2000] loss-1.203-|Sample:1.65|use_time:58.74737286567688
loss: -1.203039576367634, EarlyStopping counter: 9 out of 300
EPOCH[488/2000] loss-1.202-|Sample:2.02|use_time:59.00848603248596
loss: -1.2015817427053683, EarlyStopping counter: 10 out of 300
EPOCH[489/2000] loss-1.203-|Sample:2.01|use_time:58.842140913009644
loss: -1.2034835902655996, EarlyStopping counter: 11 out of 300
EPOCH[490/2000] loss-1.201-|Sample:1.95|use_time:59.682257890701294
loss: -1.2014982467744408, EarlyStopping counter: 12 out of 300
EPOCH[491/2000] loss-1.200-|Sample:1.08|use_time:58.720303535461426
loss: -1.1996440916526607, EarlyStopping counter: 13 out of 300
EPOCH[492/2000] loss-1.205-|Sample:1.93|use_time:58.49719262123108
EPOCH[493/2000] loss-1.202-|Sample:1.97|use_time:59.048545360565186
loss: -1.2019514950310313, EarlyStopping counter: 1 out of 300
EPOCH[494/2000] loss-1.205-|Sample:1.89|use_time:59.04047989845276
EPOCH[495/2000] loss-1.201-|Sample:1.96|use_time:59.250272274017334
loss: -1.2014520807964046, EarlyStopping counter: 1 out of 300
EPOCH[496/2000] loss-1.203-|Sample:2.06|use_time:58.63583302497864
loss: -1.2030602548180558, EarlyStopping counter: 2 out of 300
EPOCH[497/2000] loss-1.205-|Sample:2.05|use_time:59.60860085487366
loss: -1.2047334095326865, EarlyStopping counter: 3 out of 300
EPOCH[498/2000] loss-1.202-|Sample:1.78|use_time:58.51724147796631
loss: -1.2021862849956606, EarlyStopping counter: 4 out of 300
EPOCH[499/2000] loss-1.203-|Sample:2.05|use_time:59.66098070144653
loss: -1.2025781375605886, EarlyStopping counter: 5 out of 300
EPOCH[500/2000] loss-1.201-|Sample:1.56|use_time:58.306662797927856
loss: -1.2005120835653165, EarlyStopping counter: 6 out of 300
[TEST]
{'precision': array([0.02645443, 0.01948814, 0.01214482]), 'recall': array([0.11312262, 0.16370896, 0.25363558]), 'ndcg': array([0.07561115, 0.09098882, 0.1130897 ]), 'coverage': array([23.2454432 , 27.50349563, 32.47915106]), 'Acoverage': array([136.84785482, 183.04601565, 259.11170184]), 'ILD': array([0.72616729, 0.74375123, 0.77269607]), 'F1': array([0.19575106, 0.26835059, 0.38191011])}
test time: 281.17249178886414
reg_loss2: tensor(0.0131, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2045, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[501/2000] loss-1.203-|Sample:2.05|use_time:58.94412541389465
loss: -1.2034414337902535, EarlyStopping counter: 7 out of 300
EPOCH[502/2000] loss-1.201-|Sample:1.10|use_time:58.77988791465759
loss: -1.200613013127955, EarlyStopping counter: 8 out of 300
EPOCH[503/2000] loss-1.201-|Sample:2.03|use_time:59.20626664161682
loss: -1.2007831102464257, EarlyStopping counter: 9 out of 300
EPOCH[504/2000] loss-1.202-|Sample:2.07|use_time:58.779417991638184
loss: -1.2015932187801455, EarlyStopping counter: 10 out of 300
EPOCH[505/2000] loss-1.200-|Sample:2.02|use_time:59.80710196495056
loss: -1.200257708386677, EarlyStopping counter: 11 out of 300
EPOCH[506/2000] loss-1.203-|Sample:1.92|use_time:59.90554475784302
loss: -1.2029102779016263, EarlyStopping counter: 12 out of 300
EPOCH[507/2000] loss-1.202-|Sample:1.08|use_time:58.628453969955444
loss: -1.2020821396897479, EarlyStopping counter: 13 out of 300
EPOCH[508/2000] loss-1.202-|Sample:1.88|use_time:59.20666193962097
loss: -1.2021588726741512, EarlyStopping counter: 14 out of 300
EPOCH[509/2000] loss-1.201-|Sample:1.91|use_time:59.9442777633667
loss: -1.2007025334893204, EarlyStopping counter: 15 out of 300
EPOCH[510/2000] loss-1.201-|Sample:1.76|use_time:59.3530330657959
loss: -1.2013252711877591, EarlyStopping counter: 16 out of 300
EPOCH[511/2000] loss-1.203-|Sample:1.94|use_time:59.09109687805176
loss: -1.203334488519808, EarlyStopping counter: 17 out of 300
EPOCH[512/2000] loss-1.201-|Sample:2.01|use_time:59.42402267456055
loss: -1.2013754931891836, EarlyStopping counter: 18 out of 300
EPOCH[513/2000] loss-1.204-|Sample:2.10|use_time:59.91391730308533
loss: -1.204233053253918, EarlyStopping counter: 19 out of 300
EPOCH[514/2000] loss-1.202-|Sample:2.09|use_time:59.70381951332092
loss: -1.202486936638995, EarlyStopping counter: 20 out of 300
EPOCH[515/2000] loss-1.203-|Sample:2.05|use_time:59.37821912765503
loss: -1.2029583366905772, EarlyStopping counter: 21 out of 300
EPOCH[516/2000] loss-1.203-|Sample:2.05|use_time:60.042317628860474
loss: -1.2034241746111614, EarlyStopping counter: 22 out of 300
EPOCH[517/2000] loss-1.204-|Sample:2.12|use_time:60.6551034450531
loss: -1.203538781259118, EarlyStopping counter: 23 out of 300
EPOCH[518/2000] loss-1.202-|Sample:1.17|use_time:59.717575550079346
loss: -1.2019332414720116, EarlyStopping counter: 24 out of 300
EPOCH[519/2000] loss-1.204-|Sample:2.12|use_time:59.812771797180176
loss: -1.2037197380531124, EarlyStopping counter: 25 out of 300
EPOCH[520/2000] loss-1.203-|Sample:2.14|use_time:60.07573056221008
loss: -1.2030196422483863, EarlyStopping counter: 26 out of 300
EPOCH[521/2000] loss-1.206-|Sample:1.96|use_time:59.17246341705322
EPOCH[522/2000] loss-1.202-|Sample:2.18|use_time:59.526169538497925
loss: -1.2023526837186116, EarlyStopping counter: 1 out of 300
EPOCH[523/2000] loss-1.205-|Sample:2.12|use_time:59.84458589553833
loss: -1.2049243828145468, EarlyStopping counter: 2 out of 300
EPOCH[524/2000] loss-1.203-|Sample:2.06|use_time:60.55705499649048
loss: -1.2030174150699522, EarlyStopping counter: 3 out of 300
EPOCH[525/2000] loss-1.202-|Sample:1.15|use_time:59.638386249542236
loss: -1.2024864801546422, EarlyStopping counter: 4 out of 300
EPOCH[526/2000] loss-1.201-|Sample:2.06|use_time:59.5689640045166
loss: -1.2012230448606538, EarlyStopping counter: 5 out of 300
EPOCH[527/2000] loss-1.204-|Sample:2.08|use_time:61.55882787704468
loss: -1.203717795813956, EarlyStopping counter: 6 out of 300
EPOCH[528/2000] loss-1.204-|Sample:2.16|use_time:59.70309090614319
loss: -1.2036734761261358, EarlyStopping counter: 7 out of 300
EPOCH[529/2000] loss-1.203-|Sample:2.09|use_time:60.10303354263306
loss: -1.2031254070561106, EarlyStopping counter: 8 out of 300
EPOCH[530/2000] loss-1.201-|Sample:2.12|use_time:59.61422419548035
loss: -1.2009337966035052, EarlyStopping counter: 9 out of 300
EPOCH[531/2000] loss-1.206-|Sample:2.11|use_time:60.52535367012024
EPOCH[532/2000] loss-1.203-|Sample:1.84|use_time:59.30511283874512
loss: -1.2034190835022345, EarlyStopping counter: 1 out of 300
EPOCH[533/2000] loss-1.202-|Sample:2.00|use_time:60.86904525756836
loss: -1.201958615605424, EarlyStopping counter: 2 out of 300
EPOCH[534/2000] loss-1.202-|Sample:2.16|use_time:59.652467012405396
loss: -1.2020315455227364, EarlyStopping counter: 3 out of 300
EPOCH[535/2000] loss-1.206-|Sample:2.16|use_time:59.39113116264343
loss: -1.205557009068931, EarlyStopping counter: 4 out of 300
EPOCH[536/2000] loss-1.203-|Sample:2.10|use_time:59.379907846450806
loss: -1.20261198427619, EarlyStopping counter: 5 out of 300
EPOCH[537/2000] loss-1.201-|Sample:2.12|use_time:59.59730935096741
loss: -1.2005307761634267, EarlyStopping counter: 6 out of 300
EPOCH[538/2000] loss-1.201-|Sample:2.16|use_time:59.37605404853821
loss: -1.2013934530862949, EarlyStopping counter: 7 out of 300
EPOCH[539/2000] loss-1.206-|Sample:2.27|use_time:60.73856711387634
loss: -1.2056773115948933, EarlyStopping counter: 8 out of 300
EPOCH[540/2000] loss-1.205-|Sample:1.84|use_time:59.28267431259155
loss: -1.2052406247069196, EarlyStopping counter: 9 out of 300
EPOCH[541/2000] loss-1.205-|Sample:2.12|use_time:59.59155464172363
loss: -1.2048325800314181, EarlyStopping counter: 10 out of 300
EPOCH[542/2000] loss-1.204-|Sample:2.14|use_time:60.323588848114014
loss: -1.2039784600095051, EarlyStopping counter: 11 out of 300
EPOCH[543/2000] loss-1.203-|Sample:1.88|use_time:60.208126068115234
loss: -1.2027805171361783, EarlyStopping counter: 12 out of 300
EPOCH[544/2000] loss-1.205-|Sample:1.15|use_time:59.0909469127655
loss: -1.204594149822142, EarlyStopping counter: 13 out of 300
EPOCH[545/2000] loss-1.203-|Sample:2.11|use_time:59.163519859313965
loss: -1.2027979245999965, EarlyStopping counter: 14 out of 300
EPOCH[546/2000] loss-1.203-|Sample:2.09|use_time:60.624128103256226
loss: -1.2034971045284737, EarlyStopping counter: 15 out of 300
EPOCH[547/2000] loss-1.204-|Sample:1.70|use_time:58.87163209915161
loss: -1.2039812599740378, EarlyStopping counter: 16 out of 300
EPOCH[548/2000] loss-1.204-|Sample:2.14|use_time:59.47884178161621
loss: -1.2042867672152635, EarlyStopping counter: 17 out of 300
EPOCH[549/2000] loss-1.202-|Sample:2.12|use_time:59.52782678604126
loss: -1.2020257914938577, EarlyStopping counter: 18 out of 300
EPOCH[550/2000] loss-1.205-|Sample:2.08|use_time:60.17999815940857
loss: -1.2048982643499606, EarlyStopping counter: 19 out of 300
[TEST]
{'precision': array([0.02645443, 0.01968165, 0.01217728]), 'recall': array([0.11310792, 0.16515967, 0.25357242]), 'ndcg': array([0.07580916, 0.09162975, 0.11335602]), 'coverage': array([23.34881398, 27.44719101, 32.61161049]), 'Acoverage': array([136.72021863, 182.91636978, 259.30735666]), 'ILD': array([0.72485227, 0.74228202, 0.77206808]), 'F1': array([0.19568122, 0.2701993 , 0.38176178])}
test time: 284.28848934173584
reg_loss2: tensor(0.0120, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2032, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[551/2000] loss-1.202-|Sample:1.15|use_time:60.167869329452515
loss: -1.2020113962452585, EarlyStopping counter: 20 out of 300
EPOCH[552/2000] loss-1.203-|Sample:2.10|use_time:59.66950750350952
loss: -1.2029356782029315, EarlyStopping counter: 21 out of 300
EPOCH[553/2000] loss-1.202-|Sample:2.08|use_time:59.541319608688354
loss: -1.2019540013336554, EarlyStopping counter: 22 out of 300
EPOCH[554/2000] loss-1.203-|Sample:1.92|use_time:59.4074490070343
loss: -1.2029630963395281, EarlyStopping counter: 23 out of 300
EPOCH[555/2000] loss-1.204-|Sample:2.09|use_time:59.48838400840759
loss: -1.2041438352770921, EarlyStopping counter: 24 out of 300
EPOCH[556/2000] loss-1.206-|Sample:2.09|use_time:59.98605227470398
loss: -1.2060904473793217, EarlyStopping counter: 25 out of 300
EPOCH[557/2000] loss-1.204-|Sample:2.10|use_time:59.70997977256775
loss: -1.2044573789689599, EarlyStopping counter: 26 out of 300
EPOCH[558/2000] loss-1.205-|Sample:2.11|use_time:59.720173835754395
loss: -1.2047280945428989, EarlyStopping counter: 27 out of 300
EPOCH[559/2000] loss-1.200-|Sample:2.08|use_time:60.19027280807495
loss: -1.2003861956480073, EarlyStopping counter: 28 out of 300
EPOCH[560/2000] loss-1.206-|Sample:1.89|use_time:59.97470283508301
loss: -1.2055824733361966, EarlyStopping counter: 29 out of 300
EPOCH[561/2000] loss-1.203-|Sample:1.15|use_time:59.164591789245605
loss: -1.20313795310695, EarlyStopping counter: 30 out of 300
EPOCH[562/2000] loss-1.205-|Sample:1.93|use_time:59.581605672836304
loss: -1.2050737433317231, EarlyStopping counter: 31 out of 300
EPOCH[563/2000] loss-1.203-|Sample:2.05|use_time:60.6253981590271
loss: -1.2034582277623618, EarlyStopping counter: 32 out of 300
EPOCH[564/2000] loss-1.204-|Sample:1.88|use_time:59.74279022216797
loss: -1.2043470667629708, EarlyStopping counter: 33 out of 300
EPOCH[565/2000] loss-1.205-|Sample:2.11|use_time:59.931283950805664
loss: -1.2048186906954137, EarlyStopping counter: 34 out of 300
EPOCH[566/2000] loss-1.203-|Sample:2.03|use_time:60.357603788375854
loss: -1.2030908567149465, EarlyStopping counter: 35 out of 300
EPOCH[567/2000] loss-1.204-|Sample:2.10|use_time:61.50450348854065
loss: -1.2040549225923491, EarlyStopping counter: 36 out of 300
EPOCH[568/2000] loss-1.204-|Sample:2.14|use_time:60.41071081161499
loss: -1.2041394070881168, EarlyStopping counter: 37 out of 300
EPOCH[569/2000] loss-1.206-|Sample:2.07|use_time:59.978909730911255
loss: -1.2062370806205562, EarlyStopping counter: 38 out of 300
EPOCH[570/2000] loss-1.203-|Sample:2.15|use_time:60.03715991973877
loss: -1.2034347086417965, EarlyStopping counter: 39 out of 300
EPOCH[571/2000] loss-1.204-|Sample:2.07|use_time:60.11104106903076
loss: -1.2037537970194003, EarlyStopping counter: 40 out of 300
EPOCH[572/2000] loss-1.204-|Sample:1.14|use_time:59.48598837852478
loss: -1.2038310097485054, EarlyStopping counter: 41 out of 300
EPOCH[573/2000] loss-1.206-|Sample:2.08|use_time:59.10958933830261
EPOCH[574/2000] loss-1.206-|Sample:2.08|use_time:60.37084889411926
loss: -1.2055295647644415, EarlyStopping counter: 1 out of 300
EPOCH[575/2000] loss-1.206-|Sample:2.09|use_time:59.798993825912476
loss: -1.2055260088385604, EarlyStopping counter: 2 out of 300
EPOCH[576/2000] loss-1.201-|Sample:2.12|use_time:59.58292746543884
loss: -1.2012627706295107, EarlyStopping counter: 3 out of 300
EPOCH[577/2000] loss-1.205-|Sample:2.09|use_time:60.32033896446228
loss: -1.2052665745339743, EarlyStopping counter: 4 out of 300
EPOCH[578/2000] loss-1.204-|Sample:2.76|use_time:65.21842670440674
loss: -1.2042524465700475, EarlyStopping counter: 5 out of 300
EPOCH[579/2000] loss-1.203-|Sample:1.14|use_time:62.72894811630249
loss: -1.2030514682211526, EarlyStopping counter: 6 out of 300
EPOCH[580/2000] loss-1.204-|Sample:3.68|use_time:62.743738651275635
loss: -1.2038245230186275, EarlyStopping counter: 7 out of 300
EPOCH[581/2000] loss-1.205-|Sample:2.91|use_time:63.71987843513489
loss: -1.2049676993998086, EarlyStopping counter: 8 out of 300
EPOCH[582/2000] loss-1.205-|Sample:2.43|use_time:61.34006071090698
loss: -1.2048150184677868, EarlyStopping counter: 9 out of 300
EPOCH[583/2000] loss-1.206-|Sample:2.50|use_time:63.62526607513428
loss: -1.2055357840003036, EarlyStopping counter: 10 out of 300
EPOCH[584/2000] loss-1.203-|Sample:3.30|use_time:62.812660694122314
loss: -1.2026043548816587, EarlyStopping counter: 11 out of 300
EPOCH[585/2000] loss-1.204-|Sample:2.25|use_time:61.94056224822998
loss: -1.2037930895642537, EarlyStopping counter: 12 out of 300
EPOCH[586/2000] loss-1.203-|Sample:1.65|use_time:60.535616397857666
loss: -1.2028942544285843, EarlyStopping counter: 13 out of 300
EPOCH[587/2000] loss-1.207-|Sample:2.10|use_time:62.246819496154785
EPOCH[588/2000] loss-1.205-|Sample:1.93|use_time:60.830145597457886
loss: -1.2051776095134457, EarlyStopping counter: 1 out of 300
EPOCH[589/2000] loss-1.204-|Sample:2.12|use_time:61.14457654953003
loss: -1.2043501138687134, EarlyStopping counter: 2 out of 300
EPOCH[590/2000] loss-1.203-|Sample:2.11|use_time:60.91072988510132
loss: -1.2034045079859292, EarlyStopping counter: 3 out of 300
EPOCH[591/2000] loss-1.204-|Sample:2.07|use_time:60.7205171585083
loss: -1.2044984829135057, EarlyStopping counter: 4 out of 300
EPOCH[592/2000] loss-1.206-|Sample:2.08|use_time:61.01329851150513
loss: -1.2060623576001424, EarlyStopping counter: 5 out of 300
EPOCH[593/2000] loss-1.203-|Sample:2.12|use_time:61.844951152801514
loss: -1.2027442571593494, EarlyStopping counter: 6 out of 300
EPOCH[594/2000] loss-1.205-|Sample:1.18|use_time:61.1005585193634
loss: -1.2046067249484178, EarlyStopping counter: 7 out of 300
EPOCH[595/2000] loss-1.203-|Sample:2.70|use_time:62.49992609024048
loss: -1.2025756632409446, EarlyStopping counter: 8 out of 300
EPOCH[596/2000] loss-1.208-|Sample:3.74|use_time:64.38233733177185
EPOCH[597/2000] loss-1.203-|Sample:3.59|use_time:64.22781205177307
loss: -1.203035584310206, EarlyStopping counter: 1 out of 300
EPOCH[598/2000] loss-1.204-|Sample:2.85|use_time:62.64298892021179
loss: -1.204126314419072, EarlyStopping counter: 2 out of 300
EPOCH[599/2000] loss-1.205-|Sample:2.11|use_time:61.45872473716736
loss: -1.2046704350448236, EarlyStopping counter: 3 out of 300
EPOCH[600/2000] loss-1.205-|Sample:2.20|use_time:62.52302670478821
loss: -1.2048115613983899, EarlyStopping counter: 4 out of 300
[TEST]
{'precision': array([0.0264794 , 0.01975031, 0.01219725]), 'recall': array([0.11347389, 0.16489461, 0.25442472]), 'ndcg': array([0.07612047, 0.09189156, 0.11383949]), 'coverage': array([23.4897628 , 27.51398252, 32.62259675]), 'Acoverage': array([136.86370695, 183.27202887, 260.48770744]), 'ILD': array([0.72492995, 0.74343124, 0.77266539]), 'F1': array([0.1962315 , 0.26992032, 0.38280025])}
test time: 286.8090672492981
reg_loss2: tensor(0.0113, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2255, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[601/2000] loss-1.207-|Sample:2.08|use_time:60.86855435371399
loss: -1.206614491416187, EarlyStopping counter: 5 out of 300
EPOCH[602/2000] loss-1.207-|Sample:2.10|use_time:60.790154218673706
loss: -1.2071204127334967, EarlyStopping counter: 6 out of 300
EPOCH[603/2000] loss-1.205-|Sample:2.13|use_time:61.212388038635254
loss: -1.2045710842783859, EarlyStopping counter: 7 out of 300
EPOCH[604/2000] loss-1.204-|Sample:2.13|use_time:60.31459903717041
loss: -1.2039263132141858, EarlyStopping counter: 8 out of 300
EPOCH[605/2000] loss-1.204-|Sample:2.06|use_time:60.198583364486694
loss: -1.2036102632196939, EarlyStopping counter: 9 out of 300
EPOCH[606/2000] loss-1.205-|Sample:2.14|use_time:60.52691984176636
loss: -1.2046215883115443, EarlyStopping counter: 10 out of 300
EPOCH[607/2000] loss-1.205-|Sample:2.17|use_time:61.53732395172119
loss: -1.204683896971912, EarlyStopping counter: 11 out of 300
EPOCH[608/2000] loss-1.207-|Sample:2.13|use_time:60.603567600250244
loss: -1.20695161819458, EarlyStopping counter: 12 out of 300
EPOCH[609/2000] loss-1.206-|Sample:2.10|use_time:62.07818961143494
loss: -1.20580558079045, EarlyStopping counter: 13 out of 300
EPOCH[610/2000] loss-1.203-|Sample:1.73|use_time:60.34643244743347
loss: -1.2030595163019693, EarlyStopping counter: 14 out of 300
EPOCH[611/2000] loss-1.203-|Sample:2.09|use_time:61.93561673164368
loss: -1.2030827970039555, EarlyStopping counter: 15 out of 300
EPOCH[612/2000] loss-1.205-|Sample:2.23|use_time:61.282129526138306
loss: -1.205188934395953, EarlyStopping counter: 16 out of 300
EPOCH[613/2000] loss-1.206-|Sample:2.13|use_time:60.47193098068237
loss: -1.2061529130470463, EarlyStopping counter: 17 out of 300
EPOCH[614/2000] loss-1.205-|Sample:2.16|use_time:60.72089600563049
loss: -1.2048225112077666, EarlyStopping counter: 18 out of 300
EPOCH[615/2000] loss-1.204-|Sample:2.15|use_time:60.98182034492493
loss: -1.2043122343900727, EarlyStopping counter: 19 out of 300
EPOCH[616/2000] loss-1.204-|Sample:2.11|use_time:61.67477512359619
loss: -1.203721406983166, EarlyStopping counter: 20 out of 300
EPOCH[617/2000] loss-1.206-|Sample:2.13|use_time:61.309359312057495
loss: -1.2057385677244605, EarlyStopping counter: 21 out of 300
EPOCH[618/2000] loss-1.204-|Sample:2.14|use_time:61.007543325424194
loss: -1.204047819463218, EarlyStopping counter: 22 out of 300
EPOCH[619/2000] loss-1.204-|Sample:2.12|use_time:61.27842926979065
loss: -1.2036338463062193, EarlyStopping counter: 23 out of 300
EPOCH[620/2000] loss-1.205-|Sample:2.11|use_time:61.48258972167969
loss: -1.205047171290328, EarlyStopping counter: 24 out of 300
EPOCH[621/2000] loss-1.206-|Sample:1.80|use_time:61.74928426742554
loss: -1.2061912635477579, EarlyStopping counter: 25 out of 300
EPOCH[622/2000] loss-1.204-|Sample:1.15|use_time:60.46387076377869
loss: -1.2036942388953231, EarlyStopping counter: 26 out of 300
EPOCH[623/2000] loss-1.205-|Sample:2.11|use_time:60.76243591308594
loss: -1.2050568243352378, EarlyStopping counter: 27 out of 300
EPOCH[624/2000] loss-1.205-|Sample:2.13|use_time:61.886394023895264
loss: -1.2048108199747598, EarlyStopping counter: 28 out of 300
EPOCH[625/2000] loss-1.205-|Sample:1.63|use_time:60.17919206619263
loss: -1.2053478723619042, EarlyStopping counter: 29 out of 300
EPOCH[626/2000] loss-1.203-|Sample:2.15|use_time:60.62202763557434
loss: -1.2034318214509545, EarlyStopping counter: 30 out of 300
EPOCH[627/2000] loss-1.206-|Sample:2.15|use_time:61.19486045837402
loss: -1.2060433975080165, EarlyStopping counter: 31 out of 300
EPOCH[628/2000] loss-1.205-|Sample:2.17|use_time:62.03344464302063
loss: -1.2054866087145921, EarlyStopping counter: 32 out of 300
EPOCH[629/2000] loss-1.206-|Sample:2.10|use_time:60.68170666694641
loss: -1.2061496885811411, EarlyStopping counter: 33 out of 300
EPOCH[630/2000] loss-1.206-|Sample:2.13|use_time:60.609479665756226
loss: -1.2058802145283396, EarlyStopping counter: 34 out of 300
EPOCH[631/2000] loss-1.207-|Sample:2.17|use_time:60.79878759384155
loss: -1.2070067190542453, EarlyStopping counter: 35 out of 300
EPOCH[632/2000] loss-1.205-|Sample:2.14|use_time:61.625853300094604
loss: -1.2053749299630887, EarlyStopping counter: 36 out of 300
EPOCH[633/2000] loss-1.203-|Sample:1.13|use_time:60.191309452056885
loss: -1.2033104663941918, EarlyStopping counter: 37 out of 300
EPOCH[634/2000] loss-1.204-|Sample:2.18|use_time:60.91998553276062
loss: -1.2035352166106061, EarlyStopping counter: 38 out of 300
EPOCH[635/2000] loss-1.207-|Sample:2.13|use_time:61.924835205078125
loss: -1.2070772095424374, EarlyStopping counter: 39 out of 300
EPOCH[636/2000] loss-1.204-|Sample:1.61|use_time:60.16242837905884
loss: -1.2042672692275629, EarlyStopping counter: 40 out of 300
EPOCH[637/2000] loss-1.205-|Sample:2.12|use_time:60.93260836601257
loss: -1.2050243645179561, EarlyStopping counter: 41 out of 300
EPOCH[638/2000] loss-1.205-|Sample:2.10|use_time:60.51721549034119
loss: -1.2049542374727202, EarlyStopping counter: 42 out of 300
EPOCH[639/2000] loss-1.207-|Sample:2.13|use_time:61.17118978500366
loss: -1.2074241056674864, EarlyStopping counter: 43 out of 300
EPOCH[640/2000] loss-1.206-|Sample:1.14|use_time:60.39950633049011
loss: -1.2060250043869019, EarlyStopping counter: 44 out of 300
EPOCH[641/2000] loss-1.206-|Sample:1.95|use_time:61.0891809463501
loss: -1.2055903353342197, EarlyStopping counter: 45 out of 300
EPOCH[642/2000] loss-1.207-|Sample:2.12|use_time:61.69855833053589
loss: -1.2065520897144224, EarlyStopping counter: 46 out of 300
EPOCH[643/2000] loss-1.206-|Sample:2.07|use_time:60.6091251373291
loss: -1.205720759019619, EarlyStopping counter: 47 out of 300
EPOCH[644/2000] loss-1.206-|Sample:2.10|use_time:61.06407141685486
loss: -1.205710544818785, EarlyStopping counter: 48 out of 300
EPOCH[645/2000] loss-1.206-|Sample:2.01|use_time:60.80441498756409
loss: -1.2063738165832147, EarlyStopping counter: 49 out of 300
EPOCH[646/2000] loss-1.205-|Sample:2.01|use_time:61.28949975967407
loss: -1.2047995328903198, EarlyStopping counter: 50 out of 300
EPOCH[647/2000] loss-1.204-|Sample:1.99|use_time:60.46064114570618
loss: -1.2038125003256448, EarlyStopping counter: 51 out of 300
EPOCH[648/2000] loss-1.207-|Sample:2.05|use_time:61.622836112976074
loss: -1.2071238959707864, EarlyStopping counter: 52 out of 300
EPOCH[649/2000] loss-1.206-|Sample:1.85|use_time:60.90081453323364
loss: -1.2060890517583707, EarlyStopping counter: 53 out of 300
EPOCH[650/2000] loss-1.204-|Sample:2.15|use_time:61.36233973503113
loss: -1.2039604448690646, EarlyStopping counter: 54 out of 300
[TEST]
{'precision': array([0.02652934, 0.0198377 , 0.0121573 ]), 'recall': array([0.11411957, 0.16715323, 0.25135483]), 'ndcg': array([0.07615163, 0.09230717, 0.11321943]), 'coverage': array([23.52446941, 27.87640449, 32.98089888]), 'Acoverage': array([136.64093359, 183.40154989, 261.22400658]), 'ILD': array([0.72545707, 0.74251856, 0.77253423]), 'F1': array([0.1972157 , 0.27287727, 0.37929931])}
test time: 284.33459877967834
reg_loss2: tensor(0.0107, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2125, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[651/2000] loss-1.207-|Sample:2.83|use_time:61.643251180648804
loss: -1.2066625124070702, EarlyStopping counter: 55 out of 300
EPOCH[652/2000] loss-1.207-|Sample:3.80|use_time:62.114187240600586
loss: -1.2070378937372348, EarlyStopping counter: 56 out of 300
EPOCH[653/2000] loss-1.204-|Sample:2.12|use_time:59.423983335494995
loss: -1.2040321274501522, EarlyStopping counter: 57 out of 300
EPOCH[654/2000] loss-1.206-|Sample:2.12|use_time:59.33254146575928
loss: -1.2059512196517572, EarlyStopping counter: 58 out of 300
EPOCH[655/2000] loss-1.208-|Sample:2.14|use_time:59.76419734954834
loss: -1.2076635564245828, EarlyStopping counter: 59 out of 300
EPOCH[656/2000] loss-1.208-|Sample:2.08|use_time:59.53349018096924
EPOCH[657/2000] loss-1.206-|Sample:2.04|use_time:60.30832767486572
loss: -1.2062085314494808, EarlyStopping counter: 1 out of 300
EPOCH[658/2000] loss-1.206-|Sample:1.89|use_time:60.265692472457886
loss: -1.205908510743118, EarlyStopping counter: 2 out of 300
EPOCH[659/2000] loss-1.204-|Sample:1.13|use_time:58.89845657348633
loss: -1.2037908536631887, EarlyStopping counter: 3 out of 300
EPOCH[660/2000] loss-1.205-|Sample:2.10|use_time:59.044782638549805
loss: -1.2050687220038436, EarlyStopping counter: 4 out of 300
EPOCH[661/2000] loss-1.207-|Sample:2.14|use_time:60.60007619857788
loss: -1.2072508916622255, EarlyStopping counter: 5 out of 300
EPOCH[662/2000] loss-1.208-|Sample:1.73|use_time:58.82252240180969
loss: -1.2080360825468854, EarlyStopping counter: 6 out of 300
EPOCH[663/2000] loss-1.206-|Sample:2.14|use_time:59.85662388801575
loss: -1.2056821439324357, EarlyStopping counter: 7 out of 300
EPOCH[664/2000] loss-1.207-|Sample:2.04|use_time:59.609885931015015
loss: -1.2065990174688943, EarlyStopping counter: 8 out of 300
EPOCH[665/2000] loss-1.207-|Sample:2.04|use_time:60.00835418701172
loss: -1.2069113865131285, EarlyStopping counter: 9 out of 300
EPOCH[666/2000] loss-1.206-|Sample:1.79|use_time:59.25755214691162
loss: -1.2055146054523747, EarlyStopping counter: 10 out of 300
EPOCH[667/2000] loss-1.205-|Sample:1.95|use_time:59.204012393951416
loss: -1.2054787932372675, EarlyStopping counter: 11 out of 300
EPOCH[668/2000] loss-1.207-|Sample:2.04|use_time:60.35417056083679
loss: -1.2068696022033691, EarlyStopping counter: 12 out of 300
EPOCH[669/2000] loss-1.206-|Sample:1.94|use_time:59.570565938949585
loss: -1.2062236535839919, EarlyStopping counter: 13 out of 300
EPOCH[670/2000] loss-1.205-|Sample:1.17|use_time:59.22954320907593
loss: -1.2046620089833329, EarlyStopping counter: 14 out of 300
EPOCH[671/2000] loss-1.203-|Sample:1.94|use_time:59.79021239280701
loss: -1.2026856876001126, EarlyStopping counter: 15 out of 300
EPOCH[672/2000] loss-1.205-|Sample:2.12|use_time:60.41392731666565
loss: -1.2054881293599198, EarlyStopping counter: 16 out of 300
EPOCH[673/2000] loss-1.206-|Sample:1.91|use_time:59.21155762672424
loss: -1.2056304797893618, EarlyStopping counter: 17 out of 300
EPOCH[674/2000] loss-1.205-|Sample:2.14|use_time:59.74821591377258
loss: -1.205117289612933, EarlyStopping counter: 18 out of 300
EPOCH[675/2000] loss-1.205-|Sample:2.08|use_time:59.55499076843262
loss: -1.205164199922143, EarlyStopping counter: 19 out of 300
EPOCH[676/2000] loss-1.205-|Sample:2.14|use_time:59.884000301361084
loss: -1.2048239329966104, EarlyStopping counter: 20 out of 300
EPOCH[677/2000] loss-1.207-|Sample:2.15|use_time:59.65624976158142
loss: -1.2073325180425876, EarlyStopping counter: 21 out of 300
EPOCH[678/2000] loss-1.205-|Sample:2.21|use_time:59.23501110076904
loss: -1.2050887055513335, EarlyStopping counter: 22 out of 300
EPOCH[679/2000] loss-1.204-|Sample:2.15|use_time:60.06448483467102
loss: -1.2042005294706764, EarlyStopping counter: 23 out of 300
EPOCH[680/2000] loss-1.206-|Sample:2.13|use_time:60.80014610290527
loss: -1.2059996186233148, EarlyStopping counter: 24 out of 300
EPOCH[681/2000] loss-1.207-|Sample:1.15|use_time:59.33016920089722
loss: -1.2066076557810714, EarlyStopping counter: 25 out of 300
EPOCH[682/2000] loss-1.207-|Sample:2.12|use_time:59.54337692260742
loss: -1.2069068187620582, EarlyStopping counter: 26 out of 300
EPOCH[683/2000] loss-1.206-|Sample:2.12|use_time:60.18663454055786
loss: -1.2060738249522884, EarlyStopping counter: 27 out of 300
EPOCH[684/2000] loss-1.206-|Sample:1.66|use_time:59.369723320007324
loss: -1.2060599501540021, EarlyStopping counter: 28 out of 300
EPOCH[685/2000] loss-1.208-|Sample:2.07|use_time:59.34804677963257
loss: -1.207802208458505, EarlyStopping counter: 29 out of 300
EPOCH[686/2000] loss-1.206-|Sample:2.14|use_time:59.17771768569946
loss: -1.2064161184357434, EarlyStopping counter: 30 out of 300
EPOCH[687/2000] loss-1.208-|Sample:2.19|use_time:60.10302925109863
EPOCH[688/2000] loss-1.207-|Sample:2.16|use_time:59.180811166763306
loss: -1.207254979668594, EarlyStopping counter: 1 out of 300
EPOCH[689/2000] loss-1.207-|Sample:2.09|use_time:59.30594086647034
loss: -1.206772844965865, EarlyStopping counter: 2 out of 300
EPOCH[690/2000] loss-1.207-|Sample:2.04|use_time:59.92144298553467
loss: -1.2066684583338296, EarlyStopping counter: 3 out of 300
EPOCH[691/2000] loss-1.204-|Sample:2.04|use_time:60.075539112091064
loss: -1.204216933831936, EarlyStopping counter: 4 out of 300
EPOCH[692/2000] loss-1.208-|Sample:1.12|use_time:59.133639097213745
loss: -1.2082985552345835, EarlyStopping counter: 5 out of 300
EPOCH[693/2000] loss-1.206-|Sample:2.05|use_time:59.277430295944214
loss: -1.206199965825895, EarlyStopping counter: 6 out of 300
EPOCH[694/2000] loss-1.208-|Sample:2.03|use_time:60.028098583221436
loss: -1.207866561122057, EarlyStopping counter: 7 out of 300
EPOCH[695/2000] loss-1.204-|Sample:1.87|use_time:58.99560546875
loss: -1.2044449579424974, EarlyStopping counter: 8 out of 300
EPOCH[696/2000] loss-1.207-|Sample:2.08|use_time:59.56715750694275
loss: -1.207060653988908, EarlyStopping counter: 9 out of 300
EPOCH[697/2000] loss-1.206-|Sample:2.14|use_time:59.94299030303955
loss: -1.2061270184633208, EarlyStopping counter: 10 out of 300
EPOCH[698/2000] loss-1.208-|Sample:2.16|use_time:60.056357622146606
loss: -1.2078290596240904, EarlyStopping counter: 11 out of 300
EPOCH[699/2000] loss-1.207-|Sample:2.09|use_time:59.47019577026367
loss: -1.206791909729562, EarlyStopping counter: 12 out of 300
EPOCH[700/2000] loss-1.207-|Sample:2.12|use_time:59.20981025695801
loss: -1.207084437695945, EarlyStopping counter: 13 out of 300
[TEST]
{'precision': array([0.026804  , 0.01996879, 0.01209988]), 'recall': array([0.11405995, 0.16849358, 0.25315536]), 'ndcg': array([0.07699936, 0.09343662, 0.11423888]), 'coverage': array([23.61560549, 27.71685393, 32.88776529]), 'Acoverage': array([136.83048324, 183.60026796, 261.09236016]), 'ILD': array([0.7204966 , 0.73804258, 0.76896288]), 'F1': array([0.19694244, 0.27435295, 0.38090911])}
test time: 279.59627294540405
reg_loss2: tensor(0.0103, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2572, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[701/2000] loss-1.208-|Sample:2.15|use_time:60.35363173484802
loss: -1.207816754899374, EarlyStopping counter: 14 out of 300
EPOCH[702/2000] loss-1.206-|Sample:1.19|use_time:59.49156379699707
loss: -1.2057117078362443, EarlyStopping counter: 15 out of 300
EPOCH[703/2000] loss-1.207-|Sample:1.15|use_time:59.4005606174469
loss: -1.2074970036018184, EarlyStopping counter: 16 out of 300
EPOCH[704/2000] loss-1.205-|Sample:2.00|use_time:59.31765389442444
loss: -1.2052786757306355, EarlyStopping counter: 17 out of 300
EPOCH[705/2000] loss-1.205-|Sample:2.10|use_time:60.166558265686035
loss: -1.2053125282613242, EarlyStopping counter: 18 out of 300
EPOCH[706/2000] loss-1.206-|Sample:2.09|use_time:59.67659640312195
loss: -1.2058490136774576, EarlyStopping counter: 19 out of 300
EPOCH[707/2000] loss-1.208-|Sample:2.11|use_time:60.7289183139801
loss: -1.2079659555016495, EarlyStopping counter: 20 out of 300
EPOCH[708/2000] loss-1.208-|Sample:1.78|use_time:59.224374294281006
loss: -1.20786803815423, EarlyStopping counter: 21 out of 300
EPOCH[709/2000] loss-1.208-|Sample:2.14|use_time:60.36230731010437
loss: -1.2076083247254534, EarlyStopping counter: 22 out of 300
EPOCH[710/2000] loss-1.206-|Sample:1.74|use_time:59.234487771987915
loss: -1.2062949959824725, EarlyStopping counter: 23 out of 300
EPOCH[711/2000] loss-1.206-|Sample:2.14|use_time:59.60899806022644
loss: -1.2061595451541063, EarlyStopping counter: 24 out of 300
EPOCH[712/2000] loss-1.206-|Sample:2.14|use_time:59.25695872306824
loss: -1.2063369343920451, EarlyStopping counter: 25 out of 300
EPOCH[713/2000] loss-1.209-|Sample:2.12|use_time:59.36471724510193
EPOCH[714/2000] loss-1.205-|Sample:2.11|use_time:59.604804039001465
loss: -1.2048529968029116, EarlyStopping counter: 1 out of 300
EPOCH[715/2000] loss-1.205-|Sample:2.06|use_time:60.16645383834839
loss: -1.2054044589763735, EarlyStopping counter: 2 out of 300
EPOCH[716/2000] loss-1.208-|Sample:2.06|use_time:59.5096321105957
loss: -1.2076265724693858, EarlyStopping counter: 3 out of 300
EPOCH[717/2000] loss-1.206-|Sample:2.05|use_time:59.753902435302734
loss: -1.2058941445699551, EarlyStopping counter: 4 out of 300
EPOCH[718/2000] loss-1.208-|Sample:2.18|use_time:60.12581515312195
loss: -1.2077649395640304, EarlyStopping counter: 5 out of 300
EPOCH[719/2000] loss-1.206-|Sample:2.04|use_time:60.52592206001282
loss: -1.2062968422726887, EarlyStopping counter: 6 out of 300
EPOCH[720/2000] loss-1.205-|Sample:1.17|use_time:59.4567129611969
loss: -1.205470637577336, EarlyStopping counter: 7 out of 300
EPOCH[721/2000] loss-1.206-|Sample:2.06|use_time:59.35955858230591
loss: -1.205625304361669, EarlyStopping counter: 8 out of 300
EPOCH[722/2000] loss-1.208-|Sample:2.00|use_time:60.04761457443237
loss: -1.207711100578308, EarlyStopping counter: 9 out of 300
EPOCH[723/2000] loss-1.207-|Sample:1.87|use_time:58.84947109222412
loss: -1.207291379207518, EarlyStopping counter: 10 out of 300
EPOCH[724/2000] loss-1.208-|Sample:2.02|use_time:59.36553502082825
loss: -1.2076648357437878, EarlyStopping counter: 11 out of 300
EPOCH[725/2000] loss-1.206-|Sample:2.12|use_time:59.53247666358948
loss: -1.2059763059383486, EarlyStopping counter: 12 out of 300
EPOCH[726/2000] loss-1.208-|Sample:2.02|use_time:60.04247283935547
loss: -1.2076167391567696, EarlyStopping counter: 13 out of 300
EPOCH[727/2000] loss-1.205-|Sample:1.15|use_time:59.58045315742493
loss: -1.2047880073873007, EarlyStopping counter: 14 out of 300
EPOCH[728/2000] loss-1.208-|Sample:2.10|use_time:59.71825385093689
loss: -1.2077476484019583, EarlyStopping counter: 15 out of 300
EPOCH[729/2000] loss-1.207-|Sample:2.09|use_time:59.579935789108276
loss: -1.2067149179737742, EarlyStopping counter: 16 out of 300
EPOCH[730/2000] loss-1.206-|Sample:2.09|use_time:59.51006746292114
loss: -1.205607443321042, EarlyStopping counter: 17 out of 300
EPOCH[731/2000] loss-1.207-|Sample:2.10|use_time:60.30558180809021
loss: -1.206739341340414, EarlyStopping counter: 18 out of 300
EPOCH[732/2000] loss-1.206-|Sample:2.01|use_time:59.62051773071289
loss: -1.2062628065667502, EarlyStopping counter: 19 out of 300
EPOCH[733/2000] loss-1.206-|Sample:1.99|use_time:60.17546796798706
loss: -1.2059798531415986, EarlyStopping counter: 20 out of 300
EPOCH[734/2000] loss-1.206-|Sample:1.84|use_time:59.68714761734009
loss: -1.2062171872069196, EarlyStopping counter: 21 out of 300
EPOCH[735/2000] loss-1.206-|Sample:1.98|use_time:60.34240984916687
loss: -1.2061848785819076, EarlyStopping counter: 22 out of 300
EPOCH[736/2000] loss-1.207-|Sample:1.77|use_time:59.64164137840271
loss: -1.206788603852435, EarlyStopping counter: 23 out of 300
EPOCH[737/2000] loss-1.206-|Sample:1.95|use_time:59.4568989276886
loss: -1.2056519461841118, EarlyStopping counter: 24 out of 300
EPOCH[738/2000] loss-1.206-|Sample:1.84|use_time:59.79244804382324
loss: -1.2063134879600712, EarlyStopping counter: 25 out of 300
EPOCH[739/2000] loss-1.208-|Sample:1.92|use_time:59.68726682662964
loss: -1.2076617915455887, EarlyStopping counter: 26 out of 300
EPOCH[740/2000] loss-1.207-|Sample:1.98|use_time:59.5511691570282
loss: -1.2067199044111299, EarlyStopping counter: 27 out of 300
EPOCH[741/2000] loss-1.207-|Sample:2.09|use_time:60.23541331291199
loss: -1.2074375617794875, EarlyStopping counter: 28 out of 300
EPOCH[742/2000] loss-1.207-|Sample:1.75|use_time:58.829519271850586
loss: -1.2068289605582632, EarlyStopping counter: 29 out of 300
EPOCH[743/2000] loss-1.208-|Sample:2.07|use_time:59.23496437072754
loss: -1.2078599958885006, EarlyStopping counter: 30 out of 300
EPOCH[744/2000] loss-1.209-|Sample:2.13|use_time:59.82123851776123
loss: -1.208562185124653, EarlyStopping counter: 31 out of 300
EPOCH[745/2000] loss-1.209-|Sample:1.95|use_time:60.07340598106384
EPOCH[746/2000] loss-1.206-|Sample:1.15|use_time:58.791109800338745
loss: -1.2056624482317668, EarlyStopping counter: 1 out of 300
EPOCH[747/2000] loss-1.207-|Sample:2.12|use_time:59.473403453826904
loss: -1.2074384340425817, EarlyStopping counter: 2 out of 300
EPOCH[748/2000] loss-1.207-|Sample:2.10|use_time:60.62586212158203
loss: -1.2072289193548806, EarlyStopping counter: 3 out of 300
EPOCH[749/2000] loss-1.208-|Sample:1.69|use_time:58.95227646827698
loss: -1.2080338204779275, EarlyStopping counter: 4 out of 300
EPOCH[750/2000] loss-1.207-|Sample:2.09|use_time:59.151872396469116
loss: -1.2072747451503103, EarlyStopping counter: 5 out of 300
[TEST]
{'precision': array([0.02676654, 0.01990637, 0.0121573 ]), 'recall': array([0.1147024, 0.1673874, 0.2528767]), 'ndcg': array([0.07741467, 0.09342233, 0.11443385]), 'coverage': array([23.65043695, 27.93620474, 33.02372035]), 'Acoverage': array([137.0080296 , 183.46614902, 261.31612009]), 'ILD': array([0.72354002, 0.7399067 , 0.77047293]), 'F1': array([0.19801378, 0.27301193, 0.38077827])}
test time: 279.0883505344391
reg_loss2: tensor(0.0100, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2094, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[751/2000] loss-1.207-|Sample:2.14|use_time:59.57937550544739
loss: -1.2065556049346924, EarlyStopping counter: 6 out of 300
EPOCH[752/2000] loss-1.209-|Sample:2.14|use_time:60.19707918167114
loss: -1.208527940075572, EarlyStopping counter: 7 out of 300
EPOCH[753/2000] loss-1.206-|Sample:1.16|use_time:60.00462031364441
loss: -1.2060983006547137, EarlyStopping counter: 8 out of 300
EPOCH[754/2000] loss-1.206-|Sample:1.16|use_time:60.19601535797119
loss: -1.2058772372036446, EarlyStopping counter: 9 out of 300
EPOCH[755/2000] loss-1.207-|Sample:1.14|use_time:59.59972929954529
loss: -1.2073610206929648, EarlyStopping counter: 10 out of 300
EPOCH[756/2000] loss-1.208-|Sample:1.15|use_time:59.95602369308472
loss: -1.2077185206296968, EarlyStopping counter: 11 out of 300
EPOCH[757/2000] loss-1.208-|Sample:1.19|use_time:59.64881253242493
loss: -1.2076697727529013, EarlyStopping counter: 12 out of 300
EPOCH[758/2000] loss-1.207-|Sample:1.15|use_time:59.43630933761597
loss: -1.2066315208993308, EarlyStopping counter: 13 out of 300
EPOCH[759/2000] loss-1.207-|Sample:1.16|use_time:59.391053915023804
loss: -1.207121186140107, EarlyStopping counter: 14 out of 300
EPOCH[760/2000] loss-1.207-|Sample:1.15|use_time:59.96903920173645
loss: -1.2074152202140995, EarlyStopping counter: 15 out of 300
EPOCH[761/2000] loss-1.206-|Sample:1.13|use_time:59.92645788192749
loss: -1.2060973353502227, EarlyStopping counter: 16 out of 300
EPOCH[762/2000] loss-1.206-|Sample:1.15|use_time:59.213037729263306
loss: -1.2063915060787667, EarlyStopping counter: 17 out of 300
EPOCH[763/2000] loss-1.208-|Sample:1.15|use_time:59.54973125457764
loss: -1.2080740172688553, EarlyStopping counter: 18 out of 300
EPOCH[764/2000] loss-1.208-|Sample:1.13|use_time:59.352604150772095
loss: -1.2079752945318454, EarlyStopping counter: 19 out of 300
EPOCH[765/2000] loss-1.207-|Sample:1.13|use_time:59.613245725631714
loss: -1.2066014685281894, EarlyStopping counter: 20 out of 300
EPOCH[766/2000] loss-1.206-|Sample:1.15|use_time:59.58745980262756
loss: -1.2061095005128442, EarlyStopping counter: 21 out of 300
EPOCH[767/2000] loss-1.209-|Sample:1.16|use_time:59.23106002807617
EPOCH[768/2000] loss-1.209-|Sample:1.14|use_time:59.60753893852234
loss: -1.2086358302977027, EarlyStopping counter: 1 out of 300
EPOCH[769/2000] loss-1.207-|Sample:1.15|use_time:59.359326124191284
loss: -1.2066717903788498, EarlyStopping counter: 2 out of 300
EPOCH[770/2000] loss-1.207-|Sample:1.14|use_time:59.14791655540466
loss: -1.2070261647061604, EarlyStopping counter: 3 out of 300
EPOCH[771/2000] loss-1.207-|Sample:1.15|use_time:59.924660205841064
loss: -1.206576911414542, EarlyStopping counter: 4 out of 300
EPOCH[772/2000] loss-1.206-|Sample:1.15|use_time:59.424378871917725
loss: -1.2058392385157144, EarlyStopping counter: 5 out of 300
EPOCH[773/2000] loss-1.206-|Sample:1.17|use_time:59.52660799026489
loss: -1.2056458839556066, EarlyStopping counter: 6 out of 300
EPOCH[774/2000] loss-1.206-|Sample:1.17|use_time:59.41327428817749
loss: -1.2061093609507492, EarlyStopping counter: 7 out of 300
EPOCH[775/2000] loss-1.207-|Sample:1.18|use_time:59.45308542251587
loss: -1.2066913814079472, EarlyStopping counter: 8 out of 300
EPOCH[776/2000] loss-1.206-|Sample:1.16|use_time:59.51480579376221
loss: -1.2060685855586355, EarlyStopping counter: 9 out of 300
EPOCH[777/2000] loss-1.206-|Sample:1.14|use_time:59.696911096572876
loss: -1.2064591035610293, EarlyStopping counter: 10 out of 300
EPOCH[778/2000] loss-1.206-|Sample:1.19|use_time:59.588120222091675
loss: -1.2056867204061368, EarlyStopping counter: 11 out of 300
EPOCH[779/2000] loss-1.207-|Sample:1.16|use_time:59.11876916885376
loss: -1.2072905680028403, EarlyStopping counter: 12 out of 300
EPOCH[780/2000] loss-1.207-|Sample:1.17|use_time:59.402769327163696
loss: -1.2070335673122872, EarlyStopping counter: 13 out of 300
EPOCH[781/2000] loss-1.208-|Sample:1.16|use_time:59.28035879135132
loss: -1.207569023457969, EarlyStopping counter: 14 out of 300
EPOCH[782/2000] loss-1.209-|Sample:1.13|use_time:59.25541853904724
loss: -1.208895660028225, EarlyStopping counter: 15 out of 300
EPOCH[783/2000] loss-1.206-|Sample:1.16|use_time:59.960023403167725
loss: -1.2062390810105859, EarlyStopping counter: 16 out of 300
EPOCH[784/2000] loss-1.207-|Sample:1.13|use_time:60.153806924819946
loss: -1.2074835096917502, EarlyStopping counter: 17 out of 300
EPOCH[785/2000] loss-1.208-|Sample:1.17|use_time:59.59275507926941
loss: -1.207621181883463, EarlyStopping counter: 18 out of 300
EPOCH[786/2000] loss-1.209-|Sample:1.17|use_time:59.570897579193115
loss: -1.2088038485224655, EarlyStopping counter: 19 out of 300
EPOCH[787/2000] loss-1.208-|Sample:1.16|use_time:59.6228883266449
loss: -1.208355848382159, EarlyStopping counter: 20 out of 300
EPOCH[788/2000] loss-1.207-|Sample:1.19|use_time:59.8810932636261
loss: -1.2066444158554077, EarlyStopping counter: 21 out of 300
EPOCH[789/2000] loss-1.207-|Sample:1.15|use_time:59.72129535675049
loss: -1.2068957352056735, EarlyStopping counter: 22 out of 300
EPOCH[790/2000] loss-1.204-|Sample:1.16|use_time:59.706928730010986
loss: -1.2039677573413383, EarlyStopping counter: 23 out of 300
EPOCH[791/2000] loss-1.206-|Sample:1.14|use_time:59.865384578704834
loss: -1.2063960621996623, EarlyStopping counter: 24 out of 300
EPOCH[792/2000] loss-1.208-|Sample:1.17|use_time:59.7932653427124
loss: -1.207508979774103, EarlyStopping counter: 25 out of 300
EPOCH[793/2000] loss-1.204-|Sample:1.17|use_time:59.76352000236511
loss: -1.2044648891542016, EarlyStopping counter: 26 out of 300
EPOCH[794/2000] loss-1.205-|Sample:1.17|use_time:59.564024925231934
loss: -1.2049312591552734, EarlyStopping counter: 27 out of 300
EPOCH[795/2000] loss-1.208-|Sample:1.17|use_time:59.69529938697815
loss: -1.2077578945857723, EarlyStopping counter: 28 out of 300
EPOCH[796/2000] loss-1.207-|Sample:1.17|use_time:59.79698824882507
loss: -1.2066507804684523, EarlyStopping counter: 29 out of 300
EPOCH[797/2000] loss-1.207-|Sample:1.15|use_time:59.32038164138794
loss: -1.2066687229203015, EarlyStopping counter: 30 out of 300
EPOCH[798/2000] loss-1.208-|Sample:1.11|use_time:59.16561579704285
loss: -1.2079285092470122, EarlyStopping counter: 31 out of 300
EPOCH[799/2000] loss-1.209-|Sample:1.10|use_time:59.046576738357544
loss: -1.208588777518854, EarlyStopping counter: 32 out of 300
EPOCH[800/2000] loss-1.208-|Sample:1.12|use_time:59.291800022125244
loss: -1.2077268740025962, EarlyStopping counter: 33 out of 300
[TEST]
{'precision': array([0.02692884, 0.01990012, 0.01218976]), 'recall': array([0.11507738, 0.16547974, 0.25253476]), 'ndcg': array([0.07748692, 0.09301617, 0.11445054]), 'coverage': array([23.63108614, 27.860799  , 32.8772784 ]), 'Acoverage': array([136.77926068, 183.50050242, 261.10235377]), 'ILD': array([0.72149813, 0.73890597, 0.76931621]), 'F1': array([0.1984952 , 0.27040225, 0.38024935])}
test time: 274.24321699142456
reg_loss2: tensor(0.0097, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2073, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[801/2000] loss-1.207-|Sample:1.11|use_time:58.921488523483276
loss: -1.2073322389183976, EarlyStopping counter: 34 out of 300
EPOCH[802/2000] loss-1.209-|Sample:1.06|use_time:58.974154472351074
loss: -1.2092634613921003, EarlyStopping counter: 35 out of 300
EPOCH[803/2000] loss-1.206-|Sample:2.06|use_time:58.774112701416016
loss: -1.2057526576809767, EarlyStopping counter: 36 out of 300
EPOCH[804/2000] loss-1.210-|Sample:2.07|use_time:59.22756862640381
EPOCH[805/2000] loss-1.206-|Sample:2.09|use_time:58.7399115562439
loss: -1.2063114614021488, EarlyStopping counter: 1 out of 300
EPOCH[806/2000] loss-1.208-|Sample:2.09|use_time:59.912110328674316
loss: -1.2078568121282065, EarlyStopping counter: 2 out of 300
EPOCH[807/2000] loss-1.206-|Sample:1.91|use_time:59.115086793899536
loss: -1.2058809850274064, EarlyStopping counter: 3 out of 300
EPOCH[808/2000] loss-1.208-|Sample:1.99|use_time:59.63909983634949
loss: -1.2079509903744954, EarlyStopping counter: 4 out of 300
EPOCH[809/2000] loss-1.209-|Sample:1.70|use_time:58.85045766830444
loss: -1.208945855861757, EarlyStopping counter: 5 out of 300
EPOCH[810/2000] loss-1.207-|Sample:2.05|use_time:59.07869076728821
loss: -1.2068916297540433, EarlyStopping counter: 6 out of 300
EPOCH[811/2000] loss-1.208-|Sample:2.04|use_time:58.824838399887085
loss: -1.2081384106380184, EarlyStopping counter: 7 out of 300
EPOCH[812/2000] loss-1.206-|Sample:2.02|use_time:59.10647416114807
loss: -1.2061569516251727, EarlyStopping counter: 8 out of 300
EPOCH[813/2000] loss-1.207-|Sample:1.96|use_time:58.90699028968811
loss: -1.2068011731636235, EarlyStopping counter: 9 out of 300
EPOCH[814/2000] loss-1.208-|Sample:2.00|use_time:59.59661555290222
loss: -1.208197032533041, EarlyStopping counter: 10 out of 300
EPOCH[815/2000] loss-1.206-|Sample:1.14|use_time:59.330169439315796
loss: -1.2064963724555038, EarlyStopping counter: 11 out of 300
EPOCH[816/2000] loss-1.207-|Sample:1.89|use_time:58.995333194732666
loss: -1.2065569714802067, EarlyStopping counter: 12 out of 300
EPOCH[817/2000] loss-1.207-|Sample:1.91|use_time:59.192675828933716
loss: -1.2071466969280709, EarlyStopping counter: 13 out of 300
EPOCH[818/2000] loss-1.209-|Sample:1.82|use_time:58.76259136199951
loss: -1.2091636483262225, EarlyStopping counter: 14 out of 300
EPOCH[819/2000] loss-1.206-|Sample:1.99|use_time:59.57197690010071
loss: -1.206236778236017, EarlyStopping counter: 15 out of 300
EPOCH[820/2000] loss-1.209-|Sample:1.84|use_time:58.64143133163452
loss: -1.2085305423271366, EarlyStopping counter: 16 out of 300
EPOCH[821/2000] loss-1.207-|Sample:2.05|use_time:59.58097195625305
loss: -1.2065943653990583, EarlyStopping counter: 17 out of 300
EPOCH[822/2000] loss-1.207-|Sample:1.65|use_time:58.43287110328674
loss: -1.2072997442105922, EarlyStopping counter: 18 out of 300
EPOCH[823/2000] loss-1.207-|Sample:2.10|use_time:60.14452528953552
loss: -1.2065550525013993, EarlyStopping counter: 19 out of 300
EPOCH[824/2000] loss-1.207-|Sample:1.64|use_time:58.47999906539917
loss: -1.2069238744130948, EarlyStopping counter: 20 out of 300
EPOCH[825/2000] loss-1.208-|Sample:2.08|use_time:59.411004304885864
loss: -1.208257776934926, EarlyStopping counter: 21 out of 300
EPOCH[826/2000] loss-1.209-|Sample:2.10|use_time:58.939448833465576
loss: -1.2085634877042073, EarlyStopping counter: 22 out of 300
EPOCH[827/2000] loss-1.209-|Sample:2.12|use_time:59.206787109375
loss: -1.208642418791608, EarlyStopping counter: 23 out of 300
EPOCH[828/2000] loss-1.210-|Sample:2.08|use_time:58.86704421043396
loss: -1.2099182489441662, EarlyStopping counter: 24 out of 300
EPOCH[829/2000] loss-1.208-|Sample:2.09|use_time:59.82001733779907
loss: -1.207865025939011, EarlyStopping counter: 25 out of 300
EPOCH[830/2000] loss-1.207-|Sample:1.77|use_time:58.706472635269165
loss: -1.2070101644934677, EarlyStopping counter: 26 out of 300
EPOCH[831/2000] loss-1.207-|Sample:1.98|use_time:59.18933892250061
loss: -1.2066445176194354, EarlyStopping counter: 27 out of 300
EPOCH[832/2000] loss-1.208-|Sample:2.11|use_time:59.90723657608032
loss: -1.2084037094581417, EarlyStopping counter: 28 out of 300
EPOCH[833/2000] loss-1.206-|Sample:1.82|use_time:59.79808330535889
loss: -1.206334329232937, EarlyStopping counter: 29 out of 300
EPOCH[834/2000] loss-1.206-|Sample:1.11|use_time:58.532628297805786
loss: -1.2061123964263172, EarlyStopping counter: 30 out of 300
EPOCH[835/2000] loss-1.208-|Sample:2.12|use_time:58.71299910545349
loss: -1.2075749374017484, EarlyStopping counter: 31 out of 300
EPOCH[836/2000] loss-1.205-|Sample:2.07|use_time:59.940956115722656
loss: -1.2050392191584518, EarlyStopping counter: 32 out of 300
EPOCH[837/2000] loss-1.208-|Sample:1.59|use_time:58.3046760559082
loss: -1.207923685632101, EarlyStopping counter: 33 out of 300
EPOCH[838/2000] loss-1.205-|Sample:2.11|use_time:58.81063747406006
loss: -1.2054583415752504, EarlyStopping counter: 34 out of 300
EPOCH[839/2000] loss-1.206-|Sample:2.09|use_time:58.8504536151886
loss: -1.205706724306432, EarlyStopping counter: 35 out of 300
EPOCH[840/2000] loss-1.207-|Sample:2.13|use_time:59.57538461685181
loss: -1.2065796852111816, EarlyStopping counter: 36 out of 300
EPOCH[841/2000] loss-1.206-|Sample:1.15|use_time:59.718624114990234
loss: -1.2061858816844662, EarlyStopping counter: 37 out of 300
EPOCH[842/2000] loss-1.208-|Sample:2.10|use_time:59.18944573402405
loss: -1.2083033236061655, EarlyStopping counter: 38 out of 300
EPOCH[843/2000] loss-1.208-|Sample:2.10|use_time:59.0045850276947
loss: -1.2075794179265091, EarlyStopping counter: 39 out of 300
EPOCH[844/2000] loss-1.207-|Sample:2.09|use_time:58.805803060531616
loss: -1.207098158394418, EarlyStopping counter: 40 out of 300
EPOCH[845/2000] loss-1.210-|Sample:2.12|use_time:59.35821604728699
loss: -1.2098993295576514, EarlyStopping counter: 41 out of 300
EPOCH[846/2000] loss-1.206-|Sample:2.12|use_time:58.75641942024231
loss: -1.2063198554806593, EarlyStopping counter: 42 out of 300
EPOCH[847/2000] loss-1.209-|Sample:2.10|use_time:59.63844609260559
loss: -1.2087019187648123, EarlyStopping counter: 43 out of 300
EPOCH[848/2000] loss-1.208-|Sample:1.71|use_time:58.6430401802063
loss: -1.2080506522481034, EarlyStopping counter: 44 out of 300
EPOCH[849/2000] loss-1.207-|Sample:2.07|use_time:60.283764362335205
loss: -1.2067113533252622, EarlyStopping counter: 45 out of 300
EPOCH[850/2000] loss-1.207-|Sample:1.77|use_time:58.972819089889526
loss: -1.2071430537758805, EarlyStopping counter: 46 out of 300
[TEST]
{'precision': array([0.0272035 , 0.02038077, 0.01218227]), 'recall': array([0.11736801, 0.17146717, 0.25405764]), 'ndcg': array([0.07857778, 0.09506775, 0.11527757]), 'coverage': array([23.60436954, 27.97191011, 32.96566792]), 'Acoverage': array([136.55438629, 183.11243263, 261.47393502]), 'ILD': array([0.72048828, 0.73784283, 0.76794497]), 'F1': array([0.20185389, 0.27826775, 0.38180389])}
test time: 276.519234418869
reg_loss2: tensor(0.0095, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2068, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[851/2000] loss-1.208-|Sample:2.10|use_time:59.601213455200195
loss: -1.2077164940717744, EarlyStopping counter: 47 out of 300
EPOCH[852/2000] loss-1.207-|Sample:1.15|use_time:59.19583797454834
loss: -1.2069230428556117, EarlyStopping counter: 48 out of 300
EPOCH[853/2000] loss-1.206-|Sample:2.13|use_time:59.102978229522705
loss: -1.2058020801078984, EarlyStopping counter: 49 out of 300
EPOCH[854/2000] loss-1.209-|Sample:2.09|use_time:59.3380389213562
loss: -1.209186117823531, EarlyStopping counter: 50 out of 300
EPOCH[855/2000] loss-1.209-|Sample:2.11|use_time:60.32997155189514
loss: -1.2092068718700875, EarlyStopping counter: 51 out of 300
EPOCH[856/2000] loss-1.207-|Sample:2.05|use_time:61.82515358924866
loss: -1.2068164290451422, EarlyStopping counter: 52 out of 300
EPOCH[857/2000] loss-1.208-|Sample:1.13|use_time:59.67506527900696
loss: -1.2076096127672893, EarlyStopping counter: 53 out of 300
EPOCH[858/2000] loss-1.207-|Sample:2.12|use_time:59.109015703201294
loss: -1.2068415792976939, EarlyStopping counter: 54 out of 300
EPOCH[859/2000] loss-1.207-|Sample:2.16|use_time:60.348793745040894
loss: -1.2066255400820476, EarlyStopping counter: 55 out of 300
EPOCH[860/2000] loss-1.208-|Sample:1.69|use_time:58.498382329940796
loss: -1.2077681000639753, EarlyStopping counter: 56 out of 300
EPOCH[861/2000] loss-1.207-|Sample:2.12|use_time:59.39648795127869
loss: -1.2068264513480953, EarlyStopping counter: 57 out of 300
EPOCH[862/2000] loss-1.207-|Sample:2.11|use_time:58.982625007629395
loss: -1.2073591598650304, EarlyStopping counter: 58 out of 300
EPOCH[863/2000] loss-1.207-|Sample:2.10|use_time:59.853994846343994
loss: -1.2069702090286627, EarlyStopping counter: 59 out of 300
EPOCH[864/2000] loss-1.207-|Sample:2.19|use_time:60.2331964969635
loss: -1.2074061137873953, EarlyStopping counter: 60 out of 300
EPOCH[865/2000] loss-1.207-|Sample:2.16|use_time:61.1385715007782
loss: -1.2069318120072527, EarlyStopping counter: 61 out of 300
EPOCH[866/2000] loss-1.208-|Sample:2.11|use_time:60.4857120513916
loss: -1.2075092240077694, EarlyStopping counter: 62 out of 300
EPOCH[867/2000] loss-1.209-|Sample:2.14|use_time:60.38026022911072
loss: -1.209475040435791, EarlyStopping counter: 63 out of 300
EPOCH[868/2000] loss-1.207-|Sample:1.16|use_time:58.891406297683716
loss: -1.2068551517114408, EarlyStopping counter: 64 out of 300
EPOCH[869/2000] loss-1.208-|Sample:2.11|use_time:60.43011927604675
loss: -1.2083581453416405, EarlyStopping counter: 65 out of 300
EPOCH[870/2000] loss-1.206-|Sample:2.11|use_time:60.33929634094238
loss: -1.2064527302253536, EarlyStopping counter: 66 out of 300
EPOCH[871/2000] loss-1.207-|Sample:1.79|use_time:61.199495792388916
loss: -1.2067742260490977, EarlyStopping counter: 67 out of 300
EPOCH[872/2000] loss-1.209-|Sample:2.11|use_time:59.32639956474304
loss: -1.208850325607672, EarlyStopping counter: 68 out of 300
EPOCH[873/2000] loss-1.207-|Sample:2.10|use_time:59.70242619514465
loss: -1.2070552430501797, EarlyStopping counter: 69 out of 300
EPOCH[874/2000] loss-1.210-|Sample:2.08|use_time:59.698819160461426
loss: -1.209770903354738, EarlyStopping counter: 70 out of 300
EPOCH[875/2000] loss-1.207-|Sample:1.14|use_time:59.21191883087158
loss: -1.2074865509824055, EarlyStopping counter: 71 out of 300
EPOCH[876/2000] loss-1.207-|Sample:2.03|use_time:59.054147720336914
loss: -1.2070915146571835, EarlyStopping counter: 72 out of 300
EPOCH[877/2000] loss-1.207-|Sample:2.02|use_time:59.56751751899719
loss: -1.206831388357209, EarlyStopping counter: 73 out of 300
EPOCH[878/2000] loss-1.208-|Sample:1.97|use_time:59.048879861831665
loss: -1.20783272603663, EarlyStopping counter: 74 out of 300
EPOCH[879/2000] loss-1.206-|Sample:2.02|use_time:59.6185417175293
loss: -1.205939513881032, EarlyStopping counter: 75 out of 300
EPOCH[880/2000] loss-1.208-|Sample:1.86|use_time:58.70769119262695
loss: -1.207839904761896, EarlyStopping counter: 76 out of 300
EPOCH[881/2000] loss-1.207-|Sample:1.96|use_time:60.81674599647522
loss: -1.2073029105256243, EarlyStopping counter: 77 out of 300
EPOCH[882/2000] loss-1.209-|Sample:2.17|use_time:59.96623253822327
loss: -1.2085242911082943, EarlyStopping counter: 78 out of 300
EPOCH[883/2000] loss-1.208-|Sample:2.08|use_time:60.13754463195801
loss: -1.2080056551026135, EarlyStopping counter: 79 out of 300
EPOCH[884/2000] loss-1.210-|Sample:1.66|use_time:59.06586170196533
loss: -1.2097123454256755, EarlyStopping counter: 80 out of 300
EPOCH[885/2000] loss-1.208-|Sample:1.99|use_time:59.12337112426758
loss: -1.2081321943096999, EarlyStopping counter: 81 out of 300
EPOCH[886/2000] loss-1.209-|Sample:2.08|use_time:58.985087156295776
loss: -1.208978030739761, EarlyStopping counter: 82 out of 300
EPOCH[887/2000] loss-1.207-|Sample:2.13|use_time:58.696383237838745
loss: -1.2069852584745826, EarlyStopping counter: 83 out of 300
EPOCH[888/2000] loss-1.206-|Sample:2.08|use_time:59.16311979293823
loss: -1.2062261337187232, EarlyStopping counter: 84 out of 300
EPOCH[889/2000] loss-1.208-|Sample:2.15|use_time:59.701804876327515
loss: -1.207809041186077, EarlyStopping counter: 85 out of 300
EPOCH[890/2000] loss-1.208-|Sample:2.00|use_time:59.029574155807495
loss: -1.208373511709818, EarlyStopping counter: 86 out of 300
EPOCH[891/2000] loss-1.209-|Sample:2.11|use_time:58.75849175453186
loss: -1.208940450738116, EarlyStopping counter: 87 out of 300
EPOCH[892/2000] loss-1.209-|Sample:2.15|use_time:59.219873666763306
loss: -1.2091681695565946, EarlyStopping counter: 88 out of 300
EPOCH[893/2000] loss-1.209-|Sample:1.95|use_time:59.702266216278076
loss: -1.208678803792814, EarlyStopping counter: 89 out of 300
EPOCH[894/2000] loss-1.208-|Sample:1.16|use_time:58.22252702713013
loss: -1.2081937004880208, EarlyStopping counter: 90 out of 300
EPOCH[895/2000] loss-1.205-|Sample:2.11|use_time:58.619486570358276
loss: -1.2050262660515019, EarlyStopping counter: 91 out of 300
EPOCH[896/2000] loss-1.209-|Sample:2.13|use_time:60.01664447784424
loss: -1.2091671402861432, EarlyStopping counter: 92 out of 300
EPOCH[897/2000] loss-1.211-|Sample:1.71|use_time:58.96501922607422
EPOCH[898/2000] loss-1.208-|Sample:2.12|use_time:59.191972494125366
loss: -1.207970075490998, EarlyStopping counter: 1 out of 300
EPOCH[899/2000] loss-1.210-|Sample:2.13|use_time:59.45990228652954
loss: -1.2101159124839596, EarlyStopping counter: 2 out of 300
EPOCH[900/2000] loss-1.210-|Sample:2.11|use_time:60.125837087631226
loss: -1.2097677719302293, EarlyStopping counter: 3 out of 300
[TEST]
{'precision': array([0.02706617, 0.01994382, 0.01214981]), 'recall': array([0.11747391, 0.16786608, 0.25229365]), 'ndcg': array([0.07837029, 0.09379426, 0.11465456]), 'coverage': array([24.02696629, 28.01972534, 33.06953808]), 'Acoverage': array([137.03963643, 183.78552419, 261.96133492]), 'ILD': array([0.72040782, 0.73701623, 0.76789768]), 'F1': array([0.20200732, 0.27344998, 0.37980269])}
test time: 271.0246670246124
reg_loss2: tensor(0.0094, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.1843, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[901/2000] loss-1.206-|Sample:1.16|use_time:59.28772449493408
loss: -1.2060710540631923, EarlyStopping counter: 4 out of 300
EPOCH[902/2000] loss-1.208-|Sample:2.00|use_time:59.212281227111816
loss: -1.2075379214635709, EarlyStopping counter: 5 out of 300
EPOCH[903/2000] loss-1.209-|Sample:1.99|use_time:58.89840364456177
loss: -1.209108483500597, EarlyStopping counter: 6 out of 300
EPOCH[904/2000] loss-1.209-|Sample:1.89|use_time:59.08169937133789
loss: -1.2094577754416116, EarlyStopping counter: 7 out of 300
EPOCH[905/2000] loss-1.205-|Sample:2.03|use_time:59.446537256240845
loss: -1.2052694035739433, EarlyStopping counter: 8 out of 300
EPOCH[906/2000] loss-1.206-|Sample:1.96|use_time:59.88791537284851
loss: -1.2058153181541256, EarlyStopping counter: 9 out of 300
EPOCH[907/2000] loss-1.208-|Sample:1.73|use_time:58.901994705200195
loss: -1.2082034523894147, EarlyStopping counter: 10 out of 300
EPOCH[908/2000] loss-1.209-|Sample:2.09|use_time:58.89325189590454
loss: -1.2086498301203659, EarlyStopping counter: 11 out of 300
EPOCH[909/2000] loss-1.209-|Sample:2.08|use_time:59.86136817932129
loss: -1.2092564396741914, EarlyStopping counter: 12 out of 300
EPOCH[910/2000] loss-1.206-|Sample:1.89|use_time:59.79476618766785
loss: -1.2060223643372698, EarlyStopping counter: 13 out of 300
EPOCH[911/2000] loss-1.208-|Sample:1.20|use_time:58.64946937561035
loss: -1.2083166459711587, EarlyStopping counter: 14 out of 300
EPOCH[912/2000] loss-1.208-|Sample:1.94|use_time:58.80196690559387
loss: -1.2081445978909005, EarlyStopping counter: 15 out of 300
EPOCH[913/2000] loss-1.209-|Sample:2.03|use_time:59.60341119766235
loss: -1.208643128232258, EarlyStopping counter: 16 out of 300
EPOCH[914/2000] loss-1.208-|Sample:1.91|use_time:59.2441303730011
loss: -1.208427443736937, EarlyStopping counter: 17 out of 300
EPOCH[915/2000] loss-1.211-|Sample:2.05|use_time:59.2286491394043
loss: -1.210520104664128, EarlyStopping counter: 18 out of 300
EPOCH[916/2000] loss-1.207-|Sample:2.05|use_time:59.27963852882385
loss: -1.2069452477664482, EarlyStopping counter: 19 out of 300
EPOCH[917/2000] loss-1.207-|Sample:2.02|use_time:59.55480980873108
loss: -1.2069874420398619, EarlyStopping counter: 20 out of 300
EPOCH[918/2000] loss-1.207-|Sample:1.86|use_time:59.063923835754395
loss: -1.2068438907948935, EarlyStopping counter: 21 out of 300
EPOCH[919/2000] loss-1.207-|Sample:2.05|use_time:58.85581851005554
loss: -1.2072454458329736, EarlyStopping counter: 22 out of 300
EPOCH[920/2000] loss-1.211-|Sample:2.05|use_time:59.62749910354614
EPOCH[921/2000] loss-1.207-|Sample:2.12|use_time:59.765300035476685
loss: -1.20682248545856, EarlyStopping counter: 1 out of 300
EPOCH[922/2000] loss-1.209-|Sample:1.12|use_time:58.98830199241638
loss: -1.2086232755242325, EarlyStopping counter: 2 out of 300
EPOCH[923/2000] loss-1.205-|Sample:2.13|use_time:59.56450390815735
loss: -1.2046873918393763, EarlyStopping counter: 3 out of 300
EPOCH[924/2000] loss-1.207-|Sample:2.10|use_time:60.18631625175476
loss: -1.2072811650066841, EarlyStopping counter: 4 out of 300
EPOCH[925/2000] loss-1.209-|Sample:1.68|use_time:58.20445394515991
loss: -1.208761075647866, EarlyStopping counter: 5 out of 300
EPOCH[926/2000] loss-1.208-|Sample:2.09|use_time:59.046589851379395
loss: -1.207670929955273, EarlyStopping counter: 6 out of 300
EPOCH[927/2000] loss-1.209-|Sample:2.22|use_time:59.57026290893555
loss: -1.2088581585302585, EarlyStopping counter: 7 out of 300
EPOCH[928/2000] loss-1.210-|Sample:2.09|use_time:59.771071910858154
loss: -1.2102449696238449, EarlyStopping counter: 8 out of 300
EPOCH[929/2000] loss-1.207-|Sample:1.12|use_time:58.69655704498291
loss: -1.2069969264472402, EarlyStopping counter: 9 out of 300
EPOCH[930/2000] loss-1.209-|Sample:2.13|use_time:59.16474771499634
loss: -1.2092878324229543, EarlyStopping counter: 10 out of 300
EPOCH[931/2000] loss-1.208-|Sample:2.08|use_time:58.65680456161499
loss: -1.2079554127483834, EarlyStopping counter: 11 out of 300
EPOCH[932/2000] loss-1.207-|Sample:2.08|use_time:58.83570599555969
loss: -1.2069706131772298, EarlyStopping counter: 12 out of 300
EPOCH[933/2000] loss-1.209-|Sample:2.05|use_time:59.747848987579346
loss: -1.2090744739625512, EarlyStopping counter: 13 out of 300
EPOCH[934/2000] loss-1.208-|Sample:2.03|use_time:58.84545111656189
loss: -1.208084769365264, EarlyStopping counter: 14 out of 300
EPOCH[935/2000] loss-1.207-|Sample:2.03|use_time:59.43637228012085
loss: -1.2073358442725204, EarlyStopping counter: 15 out of 300
EPOCH[936/2000] loss-1.208-|Sample:2.00|use_time:59.00432515144348
loss: -1.2078609728231662, EarlyStopping counter: 16 out of 300
EPOCH[937/2000] loss-1.207-|Sample:2.03|use_time:59.730419397354126
loss: -1.2072769461608515, EarlyStopping counter: 17 out of 300
EPOCH[938/2000] loss-1.206-|Sample:1.88|use_time:59.169410943984985
loss: -1.2064412774109259, EarlyStopping counter: 18 out of 300
EPOCH[939/2000] loss-1.209-|Sample:1.89|use_time:58.89439105987549
loss: -1.208622964417062, EarlyStopping counter: 19 out of 300
EPOCH[940/2000] loss-1.209-|Sample:1.86|use_time:58.65888237953186
loss: -1.209407818026659, EarlyStopping counter: 20 out of 300
EPOCH[941/2000] loss-1.209-|Sample:1.93|use_time:58.8622088432312
loss: -1.2093086824184511, EarlyStopping counter: 21 out of 300
EPOCH[942/2000] loss-1.208-|Sample:1.89|use_time:58.71947383880615
loss: -1.2083409355907906, EarlyStopping counter: 22 out of 300
EPOCH[943/2000] loss-1.210-|Sample:2.10|use_time:59.86386752128601
loss: -1.2095475952799728, EarlyStopping counter: 23 out of 300
EPOCH[944/2000] loss-1.209-|Sample:1.87|use_time:59.139801263809204
loss: -1.2089308267686425, EarlyStopping counter: 24 out of 300
EPOCH[945/2000] loss-1.208-|Sample:2.15|use_time:63.08476424217224
loss: -1.2080714731681637, EarlyStopping counter: 25 out of 300
EPOCH[946/2000] loss-1.206-|Sample:3.34|use_time:64.88160109519958
loss: -1.205794171589177, EarlyStopping counter: 26 out of 300
EPOCH[947/2000] loss-1.208-|Sample:3.12|use_time:64.38548874855042
loss: -1.2079017918284347, EarlyStopping counter: 27 out of 300
EPOCH[948/2000] loss-1.208-|Sample:1.08|use_time:62.26267981529236
loss: -1.2077443948606166, EarlyStopping counter: 28 out of 300
EPOCH[949/2000] loss-1.208-|Sample:2.53|use_time:62.094074726104736
loss: -1.2080089871476336, EarlyStopping counter: 29 out of 300
EPOCH[950/2000] loss-1.208-|Sample:2.13|use_time:61.97333550453186
loss: -1.2077091089109095, EarlyStopping counter: 30 out of 300
[TEST]
{'precision': array([0.02686642, 0.01990637, 0.01218227]), 'recall': array([0.11568394, 0.16689197, 0.25300849]), 'ndcg': array([0.07797767, 0.09364743, 0.11485824]), 'coverage': array([23.89400749, 27.93258427, 33.00549313]), 'Acoverage': array([136.63411894, 183.44987363, 261.60329466]), 'ILD': array([0.71999168, 0.73741244, 0.76761253]), 'F1': array([0.19933924, 0.27218315, 0.38057708])}
test time: 275.82232189178467
reg_loss2: tensor(0.0093, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2220, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[951/2000] loss-1.208-|Sample:2.18|use_time:61.19232249259949
loss: -1.2079248079439489, EarlyStopping counter: 31 out of 300
EPOCH[952/2000] loss-1.209-|Sample:2.02|use_time:60.76028752326965
loss: -1.2085291786891659, EarlyStopping counter: 32 out of 300
EPOCH[953/2000] loss-1.207-|Sample:2.14|use_time:60.87985682487488
loss: -1.206560475070302, EarlyStopping counter: 33 out of 300
EPOCH[954/2000] loss-1.207-|Sample:2.11|use_time:61.15810942649841
loss: -1.2066359752561988, EarlyStopping counter: 34 out of 300
EPOCH[955/2000] loss-1.210-|Sample:2.14|use_time:60.88125491142273
loss: -1.2095499474827835, EarlyStopping counter: 35 out of 300
EPOCH[956/2000] loss-1.210-|Sample:2.15|use_time:60.91797375679016
loss: -1.209716872471135, EarlyStopping counter: 36 out of 300
EPOCH[957/2000] loss-1.206-|Sample:2.15|use_time:61.573668241500854
loss: -1.2063822164768125, EarlyStopping counter: 37 out of 300
EPOCH[958/2000] loss-1.208-|Sample:2.10|use_time:61.738513469696045
loss: -1.2080218821037105, EarlyStopping counter: 38 out of 300
EPOCH[959/2000] loss-1.206-|Sample:1.11|use_time:60.9539794921875
loss: -1.2058038769698725, EarlyStopping counter: 39 out of 300
EPOCH[960/2000] loss-1.211-|Sample:2.12|use_time:61.678240060806274
loss: -1.2107523825110458, EarlyStopping counter: 40 out of 300
EPOCH[961/2000] loss-1.208-|Sample:2.15|use_time:61.90367031097412
loss: -1.2078095063930605, EarlyStopping counter: 41 out of 300
EPOCH[962/2000] loss-1.208-|Sample:1.76|use_time:61.1172399520874
loss: -1.2080566505106485, EarlyStopping counter: 42 out of 300
EPOCH[963/2000] loss-1.210-|Sample:2.12|use_time:60.755539655685425
loss: -1.210415531949299, EarlyStopping counter: 43 out of 300
EPOCH[964/2000] loss-1.209-|Sample:2.17|use_time:60.93884038925171
loss: -1.209024240330952, EarlyStopping counter: 44 out of 300
EPOCH[965/2000] loss-1.208-|Sample:2.14|use_time:61.44544458389282
loss: -1.2083171984044516, EarlyStopping counter: 45 out of 300
EPOCH[966/2000] loss-1.207-|Sample:1.12|use_time:60.71590828895569
loss: -1.2069557817970835, EarlyStopping counter: 46 out of 300
EPOCH[967/2000] loss-1.210-|Sample:2.23|use_time:60.92732310295105
loss: -1.2100573545548974, EarlyStopping counter: 47 out of 300
EPOCH[968/2000] loss-1.206-|Sample:2.16|use_time:61.324591875076294
loss: -1.205688575418984, EarlyStopping counter: 48 out of 300
EPOCH[969/2000] loss-1.207-|Sample:2.15|use_time:61.276742696762085
loss: -1.2071535848989718, EarlyStopping counter: 49 out of 300
EPOCH[970/2000] loss-1.206-|Sample:2.18|use_time:61.77846932411194
loss: -1.206226357599584, EarlyStopping counter: 50 out of 300
EPOCH[971/2000] loss-1.206-|Sample:2.15|use_time:61.459261894226074
loss: -1.206244675124564, EarlyStopping counter: 51 out of 300
EPOCH[972/2000] loss-1.207-|Sample:2.19|use_time:62.212947368621826
loss: -1.207203803992853, EarlyStopping counter: 52 out of 300
EPOCH[973/2000] loss-1.211-|Sample:1.76|use_time:60.590789794921875
EPOCH[974/2000] loss-1.208-|Sample:2.17|use_time:62.13521075248718
loss: -1.207510776636077, EarlyStopping counter: 1 out of 300
EPOCH[975/2000] loss-1.207-|Sample:1.64|use_time:60.8731586933136
loss: -1.207460830851299, EarlyStopping counter: 2 out of 300
EPOCH[976/2000] loss-1.208-|Sample:2.14|use_time:61.18925070762634
loss: -1.2077455375252701, EarlyStopping counter: 3 out of 300
EPOCH[977/2000] loss-1.207-|Sample:2.16|use_time:61.27450895309448
loss: -1.2065680434064168, EarlyStopping counter: 4 out of 300
EPOCH[978/2000] loss-1.210-|Sample:2.19|use_time:60.98036980628967
loss: -1.2096572649188158, EarlyStopping counter: 5 out of 300
EPOCH[979/2000] loss-1.209-|Sample:2.15|use_time:60.73889923095703
loss: -1.2094020203846256, EarlyStopping counter: 6 out of 300
EPOCH[980/2000] loss-1.207-|Sample:2.22|use_time:62.50916314125061
loss: -1.206773504978273, EarlyStopping counter: 7 out of 300
EPOCH[981/2000] loss-1.208-|Sample:1.82|use_time:60.90296769142151
loss: -1.2078144492172613, EarlyStopping counter: 8 out of 300
EPOCH[982/2000] loss-1.210-|Sample:2.14|use_time:60.98123812675476
loss: -1.209959294737839, EarlyStopping counter: 9 out of 300
EPOCH[983/2000] loss-1.206-|Sample:2.14|use_time:61.71540093421936
loss: -1.2064442082149227, EarlyStopping counter: 10 out of 300
EPOCH[984/2000] loss-1.207-|Sample:1.88|use_time:61.876652240753174
loss: -1.20664644241333, EarlyStopping counter: 11 out of 300
EPOCH[985/2000] loss-1.208-|Sample:1.10|use_time:60.141401052474976
loss: -1.2083003608191885, EarlyStopping counter: 12 out of 300
EPOCH[986/2000] loss-1.209-|Sample:2.08|use_time:60.947412729263306
loss: -1.2094163691125266, EarlyStopping counter: 13 out of 300
EPOCH[987/2000] loss-1.208-|Sample:2.17|use_time:62.331963777542114
loss: -1.2082788566263711, EarlyStopping counter: 14 out of 300
EPOCH[988/2000] loss-1.207-|Sample:1.68|use_time:61.00305366516113
loss: -1.2066164627307798, EarlyStopping counter: 15 out of 300
EPOCH[989/2000] loss-1.208-|Sample:2.12|use_time:61.11810064315796
loss: -1.208038693521081, EarlyStopping counter: 16 out of 300
EPOCH[990/2000] loss-1.210-|Sample:2.24|use_time:61.13564848899841
loss: -1.209733776929902, EarlyStopping counter: 17 out of 300
EPOCH[991/2000] loss-1.207-|Sample:2.25|use_time:62.33407497406006
loss: -1.2074609936737433, EarlyStopping counter: 18 out of 300
EPOCH[992/2000] loss-1.208-|Sample:2.18|use_time:61.17307901382446
loss: -1.2080892847805489, EarlyStopping counter: 19 out of 300
EPOCH[993/2000] loss-1.208-|Sample:2.08|use_time:61.31912612915039
loss: -1.2083181578938553, EarlyStopping counter: 20 out of 300
EPOCH[994/2000] loss-1.209-|Sample:2.19|use_time:61.513290882110596
loss: -1.209208764681002, EarlyStopping counter: 21 out of 300
EPOCH[995/2000] loss-1.210-|Sample:2.20|use_time:61.90483093261719
loss: -1.2098033428192139, EarlyStopping counter: 22 out of 300
EPOCH[996/2000] loss-1.205-|Sample:1.14|use_time:60.72875714302063
loss: -1.2054856056120338, EarlyStopping counter: 23 out of 300
EPOCH[997/2000] loss-1.209-|Sample:2.17|use_time:60.955254793167114
loss: -1.2093287590073376, EarlyStopping counter: 24 out of 300
EPOCH[998/2000] loss-1.209-|Sample:2.16|use_time:61.85701894760132
loss: -1.2085622985188553, EarlyStopping counter: 25 out of 300
EPOCH[999/2000] loss-1.206-|Sample:1.68|use_time:60.424375772476196
loss: -1.2060873217699004, EarlyStopping counter: 26 out of 300
EPOCH[1000/2000] loss-1.206-|Sample:2.03|use_time:60.7435986995697
loss: -1.2059729419103482, EarlyStopping counter: 27 out of 300
[TEST]
{'precision': array([0.0271161 , 0.02011236, 0.01211735]), 'recall': array([0.11645361, 0.16737925, 0.25268395]), 'ndcg': array([0.07845716, 0.09415763, 0.11493246]), 'coverage': array([23.98764045, 28.01498127, 33.15480649]), 'Acoverage': array([136.29452209, 183.31461588, 261.8569806 ]), 'ILD': array([0.71917326, 0.73680991, 0.76735601]), 'F1': array([0.20044909, 0.27278958, 0.38017833])}
test time: 278.2977578639984
reg_loss2: tensor(0.0092, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2252, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[1001/2000] loss-1.208-|Sample:2.18|use_time:61.01269340515137
loss: -1.2076243307532333, EarlyStopping counter: 28 out of 300
EPOCH[1002/2000] loss-1.208-|Sample:2.04|use_time:61.34183406829834
loss: -1.2082397647020293, EarlyStopping counter: 29 out of 300
EPOCH[1003/2000] loss-1.209-|Sample:1.18|use_time:61.22558236122131
loss: -1.2090188584676602, EarlyStopping counter: 30 out of 300
EPOCH[1004/2000] loss-1.209-|Sample:1.14|use_time:61.89385533332825
loss: -1.2088289958674734, EarlyStopping counter: 31 out of 300
EPOCH[1005/2000] loss-1.210-|Sample:1.13|use_time:61.009345293045044
loss: -1.2103109912174503, EarlyStopping counter: 32 out of 300
EPOCH[1006/2000] loss-1.206-|Sample:1.14|use_time:61.156585931777954
loss: -1.2063005988190814, EarlyStopping counter: 33 out of 300
EPOCH[1007/2000] loss-1.207-|Sample:1.13|use_time:60.90532851219177
loss: -1.20651894371684, EarlyStopping counter: 34 out of 300
EPOCH[1008/2000] loss-1.209-|Sample:1.14|use_time:60.81051754951477
loss: -1.2087921747347203, EarlyStopping counter: 35 out of 300
EPOCH[1009/2000] loss-1.210-|Sample:1.15|use_time:61.58635687828064
loss: -1.2102404978217147, EarlyStopping counter: 36 out of 300
EPOCH[1010/2000] loss-1.209-|Sample:1.14|use_time:61.207005977630615
loss: -1.2088369828898733, EarlyStopping counter: 37 out of 300
EPOCH[1011/2000] loss-1.208-|Sample:1.15|use_time:61.73452591896057
loss: -1.2078464002144047, EarlyStopping counter: 38 out of 300
EPOCH[1012/2000] loss-1.208-|Sample:1.15|use_time:61.817986249923706
loss: -1.2078227735147244, EarlyStopping counter: 39 out of 300
EPOCH[1013/2000] loss-1.206-|Sample:1.12|use_time:60.767048597335815
loss: -1.2058106079334165, EarlyStopping counter: 40 out of 300
EPOCH[1014/2000] loss-1.205-|Sample:1.12|use_time:61.06643772125244
loss: -1.2047623919277657, EarlyStopping counter: 41 out of 300
EPOCH[1015/2000] loss-1.207-|Sample:1.14|use_time:60.93215990066528
loss: -1.2065229299591809, EarlyStopping counter: 42 out of 300
EPOCH[1016/2000] loss-1.210-|Sample:1.14|use_time:61.165857553482056
loss: -1.2099086046218872, EarlyStopping counter: 43 out of 300
EPOCH[1017/2000] loss-1.208-|Sample:1.14|use_time:61.06363797187805
loss: -1.208434209591005, EarlyStopping counter: 44 out of 300
EPOCH[1018/2000] loss-1.210-|Sample:1.13|use_time:61.551860332489014
loss: -1.209953529078786, EarlyStopping counter: 45 out of 300
EPOCH[1019/2000] loss-1.208-|Sample:1.14|use_time:60.9351532459259
loss: -1.2076064173768206, EarlyStopping counter: 46 out of 300
EPOCH[1020/2000] loss-1.208-|Sample:1.17|use_time:61.55427622795105
loss: -1.2077507303982247, EarlyStopping counter: 47 out of 300
EPOCH[1021/2000] loss-1.208-|Sample:1.13|use_time:61.36513042449951
loss: -1.2081783544726488, EarlyStopping counter: 48 out of 300
EPOCH[1022/2000] loss-1.210-|Sample:1.14|use_time:60.938910484313965
loss: -1.209983625063082, EarlyStopping counter: 49 out of 300
EPOCH[1023/2000] loss-1.208-|Sample:1.16|use_time:61.41573214530945
loss: -1.2080541674683734, EarlyStopping counter: 50 out of 300
EPOCH[1024/2000] loss-1.207-|Sample:1.19|use_time:61.378602027893066
loss: -1.2067839139845313, EarlyStopping counter: 51 out of 300
EPOCH[1025/2000] loss-1.209-|Sample:1.12|use_time:61.50418734550476
loss: -1.2091174038445078, EarlyStopping counter: 52 out of 300
EPOCH[1026/2000] loss-1.208-|Sample:1.12|use_time:60.96282243728638
loss: -1.2083363765623512, EarlyStopping counter: 53 out of 300
EPOCH[1027/2000] loss-1.207-|Sample:1.10|use_time:60.78964614868164
loss: -1.2067072246132828, EarlyStopping counter: 54 out of 300
EPOCH[1028/2000] loss-1.208-|Sample:1.07|use_time:61.528796672821045
loss: -1.2083027769879597, EarlyStopping counter: 55 out of 300
EPOCH[1029/2000] loss-1.207-|Sample:1.14|use_time:61.02605986595154
loss: -1.2072760215619716, EarlyStopping counter: 56 out of 300
EPOCH[1030/2000] loss-1.209-|Sample:1.11|use_time:61.27005672454834
loss: -1.2094339917345744, EarlyStopping counter: 57 out of 300
EPOCH[1031/2000] loss-1.209-|Sample:1.13|use_time:61.341148138046265
loss: -1.2094169651589743, EarlyStopping counter: 58 out of 300
EPOCH[1032/2000] loss-1.210-|Sample:1.11|use_time:61.22720003128052
loss: -1.2097340560540921, EarlyStopping counter: 59 out of 300
EPOCH[1033/2000] loss-1.207-|Sample:1.13|use_time:60.81652021408081
loss: -1.207218216686714, EarlyStopping counter: 60 out of 300
EPOCH[1034/2000] loss-1.208-|Sample:1.14|use_time:60.92591571807861
loss: -1.2081002694804495, EarlyStopping counter: 61 out of 300
EPOCH[1035/2000] loss-1.208-|Sample:1.12|use_time:61.46729922294617
loss: -1.2083341028632186, EarlyStopping counter: 62 out of 300
EPOCH[1036/2000] loss-1.210-|Sample:1.13|use_time:61.07523775100708
loss: -1.209732009143364, EarlyStopping counter: 63 out of 300
EPOCH[1037/2000] loss-1.209-|Sample:1.11|use_time:61.199511766433716
loss: -1.208651717116193, EarlyStopping counter: 64 out of 300
EPOCH[1038/2000] loss-1.205-|Sample:1.14|use_time:61.48707365989685
loss: -1.2051754782839519, EarlyStopping counter: 65 out of 300
EPOCH[1039/2000] loss-1.210-|Sample:1.16|use_time:61.5922634601593
loss: -1.209915998505383, EarlyStopping counter: 66 out of 300
EPOCH[1040/2000] loss-1.208-|Sample:1.14|use_time:61.070844888687134
loss: -1.2078145277209398, EarlyStopping counter: 67 out of 300
EPOCH[1041/2000] loss-1.208-|Sample:1.16|use_time:61.429556369781494
loss: -1.20801253144334, EarlyStopping counter: 68 out of 300
EPOCH[1042/2000] loss-1.210-|Sample:1.11|use_time:61.209030628204346
loss: -1.2102756413017832, EarlyStopping counter: 69 out of 300
EPOCH[1043/2000] loss-1.208-|Sample:1.14|use_time:61.118600606918335
loss: -1.207994818687439, EarlyStopping counter: 70 out of 300
EPOCH[1044/2000] loss-1.209-|Sample:1.12|use_time:61.46553826332092
loss: -1.208970142573845, EarlyStopping counter: 71 out of 300
EPOCH[1045/2000] loss-1.208-|Sample:1.15|use_time:60.97500252723694
loss: -1.2079507548634598, EarlyStopping counter: 72 out of 300
EPOCH[1046/2000] loss-1.208-|Sample:1.11|use_time:60.8985595703125
loss: -1.207971924688758, EarlyStopping counter: 73 out of 300
EPOCH[1047/2000] loss-1.207-|Sample:1.09|use_time:61.125569581985474
loss: -1.2069675864242926, EarlyStopping counter: 74 out of 300
EPOCH[1048/2000] loss-1.208-|Sample:1.11|use_time:63.27868938446045
loss: -1.2084037007355108, EarlyStopping counter: 75 out of 300
EPOCH[1049/2000] loss-1.211-|Sample:1.14|use_time:61.13330078125
loss: -1.210932624049303, EarlyStopping counter: 76 out of 300
EPOCH[1050/2000] loss-1.211-|Sample:1.15|use_time:61.38567590713501
loss: -1.2110618440116323, EarlyStopping counter: 77 out of 300
[TEST]
{'precision': array([0.02724095, 0.02032459, 0.0121598 ]), 'recall': array([0.11642743, 0.17022974, 0.25287242]), 'ndcg': array([0.0792664 , 0.09565159, 0.11597835]), 'coverage': array([23.92409488, 28.13158552, 33.24681648]), 'Acoverage': array([136.60053287, 183.09233275, 261.57746415]), 'ILD': array([0.71666805, 0.73492936, 0.76696599]), 'F1': array([0.20031274, 0.27643059, 0.38034368])}
test time: 275.71534490585327
reg_loss2: tensor(0.0092, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2050, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[1051/2000] loss-1.207-|Sample:1.13|use_time:60.63990354537964
loss: -1.2070010406215017, EarlyStopping counter: 78 out of 300
EPOCH[1052/2000] loss-1.208-|Sample:1.14|use_time:61.12798571586609
loss: -1.2078997827157743, EarlyStopping counter: 79 out of 300
EPOCH[1053/2000] loss-1.207-|Sample:2.08|use_time:59.978320360183716
loss: -1.2074475055787621, EarlyStopping counter: 80 out of 300
EPOCH[1054/2000] loss-1.206-|Sample:2.08|use_time:61.00637149810791
loss: -1.206264045180344, EarlyStopping counter: 81 out of 300
EPOCH[1055/2000] loss-1.210-|Sample:2.09|use_time:60.7852566242218
loss: -1.2097620673295928, EarlyStopping counter: 82 out of 300
EPOCH[1056/2000] loss-1.209-|Sample:2.11|use_time:61.729111433029175
loss: -1.2088596035794514, EarlyStopping counter: 83 out of 300
EPOCH[1057/2000] loss-1.207-|Sample:1.73|use_time:60.628355979919434
loss: -1.2069008292221441, EarlyStopping counter: 84 out of 300
EPOCH[1058/2000] loss-1.209-|Sample:2.13|use_time:61.80489420890808
loss: -1.2088031478044463, EarlyStopping counter: 85 out of 300
EPOCH[1059/2000] loss-1.209-|Sample:1.63|use_time:59.95853781700134
loss: -1.2090276683249124, EarlyStopping counter: 86 out of 300
EPOCH[1060/2000] loss-1.209-|Sample:2.12|use_time:60.42922568321228
loss: -1.209036524702863, EarlyStopping counter: 87 out of 300
EPOCH[1061/2000] loss-1.208-|Sample:2.17|use_time:60.220985412597656
loss: -1.2083794082083352, EarlyStopping counter: 88 out of 300
EPOCH[1062/2000] loss-1.205-|Sample:2.19|use_time:60.614381074905396
loss: -1.2049378505567225, EarlyStopping counter: 89 out of 300
EPOCH[1063/2000] loss-1.208-|Sample:2.11|use_time:61.07400608062744
loss: -1.2080790298741038, EarlyStopping counter: 90 out of 300
EPOCH[1064/2000] loss-1.210-|Sample:2.15|use_time:61.539326906204224
loss: -1.21013839942653, EarlyStopping counter: 91 out of 300
EPOCH[1065/2000] loss-1.210-|Sample:1.08|use_time:60.8321852684021
loss: -1.2103236448474046, EarlyStopping counter: 92 out of 300
EPOCH[1066/2000] loss-1.207-|Sample:2.12|use_time:60.68633222579956
loss: -1.2074940989657146, EarlyStopping counter: 93 out of 300
EPOCH[1067/2000] loss-1.207-|Sample:2.14|use_time:60.540634632110596
loss: -1.207221830763468, EarlyStopping counter: 94 out of 300
EPOCH[1068/2000] loss-1.208-|Sample:2.12|use_time:60.80350708961487
loss: -1.2081801978553213, EarlyStopping counter: 95 out of 300
EPOCH[1069/2000] loss-1.208-|Sample:2.14|use_time:61.428417921066284
loss: -1.2080666233853596, EarlyStopping counter: 96 out of 300
EPOCH[1070/2000] loss-1.209-|Sample:2.10|use_time:61.10265922546387
loss: -1.209152291460735, EarlyStopping counter: 97 out of 300
EPOCH[1071/2000] loss-1.209-|Sample:2.14|use_time:61.35367798805237
loss: -1.2090868193928788, EarlyStopping counter: 98 out of 300
EPOCH[1072/2000] loss-1.206-|Sample:1.78|use_time:60.148709535598755
loss: -1.2058265296424306, EarlyStopping counter: 99 out of 300
EPOCH[1073/2000] loss-1.207-|Sample:2.11|use_time:61.21436524391174
loss: -1.2073384610618032, EarlyStopping counter: 100 out of 300
EPOCH[1074/2000] loss-1.208-|Sample:1.61|use_time:60.1831738948822
loss: -1.2075706633125864, EarlyStopping counter: 101 out of 300
EPOCH[1075/2000] loss-1.210-|Sample:2.06|use_time:61.156938552856445
loss: -1.210054950016301, EarlyStopping counter: 102 out of 300
EPOCH[1076/2000] loss-1.208-|Sample:2.19|use_time:61.33421087265015
loss: -1.2079430498727939, EarlyStopping counter: 103 out of 300
EPOCH[1077/2000] loss-1.208-|Sample:2.15|use_time:60.80463528633118
loss: -1.2081009789210995, EarlyStopping counter: 104 out of 300
EPOCH[1078/2000] loss-1.207-|Sample:2.11|use_time:61.08455991744995
loss: -1.2074837393876983, EarlyStopping counter: 105 out of 300
EPOCH[1079/2000] loss-1.207-|Sample:2.17|use_time:62.531166315078735
loss: -1.206674005927109, EarlyStopping counter: 106 out of 300
EPOCH[1080/2000] loss-1.208-|Sample:2.15|use_time:60.75146961212158
loss: -1.2079986246620738, EarlyStopping counter: 107 out of 300
EPOCH[1081/2000] loss-1.206-|Sample:2.17|use_time:61.13977360725403
loss: -1.2064239658960483, EarlyStopping counter: 108 out of 300
EPOCH[1082/2000] loss-1.209-|Sample:2.14|use_time:62.942909955978394
loss: -1.209261367960674, EarlyStopping counter: 109 out of 300
EPOCH[1083/2000] loss-1.210-|Sample:2.13|use_time:61.99738359451294
loss: -1.209688308762341, EarlyStopping counter: 110 out of 300
EPOCH[1084/2000] loss-1.207-|Sample:1.11|use_time:61.23526334762573
loss: -1.2074703239813083, EarlyStopping counter: 111 out of 300
EPOCH[1085/2000] loss-1.208-|Sample:2.13|use_time:61.6083550453186
loss: -1.2077402109053077, EarlyStopping counter: 112 out of 300
EPOCH[1086/2000] loss-1.208-|Sample:2.14|use_time:62.172542333602905
loss: -1.2080184192192265, EarlyStopping counter: 113 out of 300
EPOCH[1087/2000] loss-1.210-|Sample:1.71|use_time:60.52487349510193
loss: -1.2101811025200822, EarlyStopping counter: 114 out of 300
EPOCH[1088/2000] loss-1.207-|Sample:2.07|use_time:60.893503189086914
loss: -1.2072388573390682, EarlyStopping counter: 115 out of 300
EPOCH[1089/2000] loss-1.208-|Sample:1.98|use_time:60.37127733230591
loss: -1.208414045775809, EarlyStopping counter: 116 out of 300
EPOCH[1090/2000] loss-1.210-|Sample:2.14|use_time:61.79831123352051
loss: -1.2096338446547346, EarlyStopping counter: 117 out of 300
EPOCH[1091/2000] loss-1.209-|Sample:1.75|use_time:60.44502019882202
loss: -1.2086577938824166, EarlyStopping counter: 118 out of 300
EPOCH[1092/2000] loss-1.208-|Sample:2.13|use_time:61.28493022918701
loss: -1.2075003240166642, EarlyStopping counter: 119 out of 300
EPOCH[1093/2000] loss-1.208-|Sample:2.13|use_time:61.74486804008484
loss: -1.2077223033439823, EarlyStopping counter: 120 out of 300
EPOCH[1094/2000] loss-1.207-|Sample:1.86|use_time:61.72424840927124
loss: -1.2067351021417758, EarlyStopping counter: 121 out of 300
EPOCH[1095/2000] loss-1.206-|Sample:1.10|use_time:60.907466650009155
loss: -1.2055230722194765, EarlyStopping counter: 122 out of 300
EPOCH[1096/2000] loss-1.210-|Sample:2.14|use_time:61.427711725234985
loss: -1.209777733174766, EarlyStopping counter: 123 out of 300
EPOCH[1097/2000] loss-1.208-|Sample:2.13|use_time:62.066633462905884
loss: -1.2083633701975753, EarlyStopping counter: 124 out of 300
EPOCH[1098/2000] loss-1.207-|Sample:1.84|use_time:60.560468435287476
loss: -1.2066012504624157, EarlyStopping counter: 125 out of 300
EPOCH[1099/2000] loss-1.208-|Sample:2.08|use_time:61.18627452850342
loss: -1.2079763412475586, EarlyStopping counter: 126 out of 300
EPOCH[1100/2000] loss-1.207-|Sample:2.14|use_time:60.96969032287598
loss: -1.2071335955363949, EarlyStopping counter: 127 out of 300
[TEST]
{'precision': array([0.0271161 , 0.02024969, 0.01213233]), 'recall': array([0.11690916, 0.17069377, 0.25230569]), 'ndcg': array([0.07842729, 0.0947481 , 0.11488695]), 'coverage': array([24.11660424, 28.25268414, 33.2659176 ]), 'Acoverage': array([136.59430894, 183.75903901, 262.36263817]), 'ILD': array([0.7165016 , 0.73374598, 0.76597427]), 'F1': array([0.20101877, 0.27695791, 0.37958061])}
test time: 273.90171551704407
reg_loss2: tensor(0.0091, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2263, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[1101/2000] loss-1.208-|Sample:2.09|use_time:61.32115983963013
loss: -1.207711356442149, EarlyStopping counter: 128 out of 300
EPOCH[1102/2000] loss-1.209-|Sample:1.10|use_time:60.495461225509644
loss: -1.208847348282977, EarlyStopping counter: 129 out of 300
EPOCH[1103/2000] loss-1.209-|Sample:1.05|use_time:60.41989612579346
loss: -1.208606984557175, EarlyStopping counter: 130 out of 300
EPOCH[1104/2000] loss-1.210-|Sample:1.14|use_time:61.00706911087036
loss: -1.2096399563114817, EarlyStopping counter: 131 out of 300
EPOCH[1105/2000] loss-1.208-|Sample:1.10|use_time:60.810951232910156
loss: -1.2083494721389398, EarlyStopping counter: 132 out of 300
EPOCH[1106/2000] loss-1.208-|Sample:1.08|use_time:61.040589809417725
loss: -1.2082966391633196, EarlyStopping counter: 133 out of 300
EPOCH[1107/2000] loss-1.207-|Sample:1.12|use_time:60.657530546188354
loss: -1.2069019660717104, EarlyStopping counter: 134 out of 300
EPOCH[1108/2000] loss-1.206-|Sample:1.10|use_time:60.83676338195801
loss: -1.2062296983672351, EarlyStopping counter: 135 out of 300
EPOCH[1109/2000] loss-1.208-|Sample:1.05|use_time:59.871864795684814
loss: -1.2077158020763863, EarlyStopping counter: 136 out of 300
EPOCH[1110/2000] loss-1.208-|Sample:1.08|use_time:59.90054702758789
loss: -1.2081617494908774, EarlyStopping counter: 137 out of 300
EPOCH[1111/2000] loss-1.209-|Sample:1.09|use_time:59.993558406829834
loss: -1.2089857066549905, EarlyStopping counter: 138 out of 300
EPOCH[1112/2000] loss-1.206-|Sample:1.05|use_time:60.12048840522766
loss: -1.2064601793521788, EarlyStopping counter: 139 out of 300
EPOCH[1113/2000] loss-1.207-|Sample:1.01|use_time:59.95819616317749
loss: -1.2074472875129887, EarlyStopping counter: 140 out of 300
EPOCH[1114/2000] loss-1.209-|Sample:1.07|use_time:59.75539708137512
loss: -1.2088647935448624, EarlyStopping counter: 141 out of 300
EPOCH[1115/2000] loss-1.207-|Sample:1.05|use_time:60.85069799423218
loss: -1.207090668561982, EarlyStopping counter: 142 out of 300
EPOCH[1116/2000] loss-1.206-|Sample:1.09|use_time:60.62619471549988
loss: -1.2060831407221353, EarlyStopping counter: 143 out of 300
EPOCH[1117/2000] loss-1.208-|Sample:1.08|use_time:60.40765929222107
loss: -1.2080813762618274, EarlyStopping counter: 144 out of 300
EPOCH[1118/2000] loss-1.210-|Sample:1.09|use_time:60.494948387145996
loss: -1.2100404152056066, EarlyStopping counter: 145 out of 300
EPOCH[1119/2000] loss-1.210-|Sample:0.99|use_time:60.579674243927
loss: -1.2100337423929355, EarlyStopping counter: 146 out of 300
EPOCH[1120/2000] loss-1.206-|Sample:1.11|use_time:61.80469346046448
loss: -1.2063022910094843, EarlyStopping counter: 147 out of 300
EPOCH[1121/2000] loss-1.209-|Sample:1.09|use_time:61.25455856323242
loss: -1.2086762771373842, EarlyStopping counter: 148 out of 300
EPOCH[1122/2000] loss-1.210-|Sample:1.08|use_time:60.94552659988403
loss: -1.210280063675671, EarlyStopping counter: 149 out of 300
EPOCH[1123/2000] loss-1.207-|Sample:1.08|use_time:61.629459619522095
loss: -1.2072768647496293, EarlyStopping counter: 150 out of 300
EPOCH[1124/2000] loss-1.211-|Sample:1.02|use_time:60.73106503486633
loss: -1.2112226544356928, EarlyStopping counter: 151 out of 300
EPOCH[1125/2000] loss-1.208-|Sample:1.11|use_time:60.474921226501465
loss: -1.2076323090530023, EarlyStopping counter: 152 out of 300
EPOCH[1126/2000] loss-1.209-|Sample:1.11|use_time:60.3416051864624
loss: -1.208564389042738, EarlyStopping counter: 153 out of 300
EPOCH[1127/2000] loss-1.207-|Sample:1.10|use_time:60.61199164390564
loss: -1.20650173396599, EarlyStopping counter: 154 out of 300
EPOCH[1128/2000] loss-1.208-|Sample:1.16|use_time:60.55075740814209
loss: -1.2077144820515702, EarlyStopping counter: 155 out of 300
EPOCH[1129/2000] loss-1.208-|Sample:1.07|use_time:60.67188310623169
loss: -1.2082985465119525, EarlyStopping counter: 156 out of 300
EPOCH[1130/2000] loss-1.209-|Sample:1.06|use_time:60.59518480300903
loss: -1.2094216317665287, EarlyStopping counter: 157 out of 300
EPOCH[1131/2000] loss-1.208-|Sample:1.11|use_time:60.97557592391968
loss: -1.207968566475845, EarlyStopping counter: 158 out of 300
EPOCH[1132/2000] loss-1.210-|Sample:1.05|use_time:60.79501128196716
loss: -1.2104125313642549, EarlyStopping counter: 159 out of 300
EPOCH[1133/2000] loss-1.210-|Sample:1.07|use_time:60.57475519180298
loss: -1.2100198036286889, EarlyStopping counter: 160 out of 300
EPOCH[1134/2000] loss-1.209-|Sample:1.09|use_time:61.449251890182495
loss: -1.2086440441085071, EarlyStopping counter: 161 out of 300
EPOCH[1135/2000] loss-1.208-|Sample:1.12|use_time:60.745466470718384
loss: -1.2082962291996653, EarlyStopping counter: 162 out of 300
EPOCH[1136/2000] loss-1.205-|Sample:1.11|use_time:61.019275188446045
loss: -1.2050630435711, EarlyStopping counter: 163 out of 300
EPOCH[1137/2000] loss-1.207-|Sample:1.12|use_time:60.9176664352417
loss: -1.2070853070514957, EarlyStopping counter: 164 out of 300
EPOCH[1138/2000] loss-1.211-|Sample:1.08|use_time:60.70036768913269
loss: -1.2105049796220733, EarlyStopping counter: 165 out of 300
EPOCH[1139/2000] loss-1.209-|Sample:1.11|use_time:60.736178159713745
loss: -1.2091200875072945, EarlyStopping counter: 166 out of 300
EPOCH[1140/2000] loss-1.208-|Sample:1.07|use_time:60.52184247970581
loss: -1.2082274919602929, EarlyStopping counter: 167 out of 300
EPOCH[1141/2000] loss-1.206-|Sample:1.08|use_time:60.56911277770996
loss: -1.206419206247097, EarlyStopping counter: 168 out of 300
EPOCH[1142/2000] loss-1.208-|Sample:1.11|use_time:61.04029631614685
loss: -1.2076427558573282, EarlyStopping counter: 169 out of 300
EPOCH[1143/2000] loss-1.208-|Sample:1.07|use_time:60.227051734924316
loss: -1.2078356364878213, EarlyStopping counter: 170 out of 300
EPOCH[1144/2000] loss-1.210-|Sample:1.10|use_time:60.484145402908325
loss: -1.209965269740035, EarlyStopping counter: 171 out of 300
EPOCH[1145/2000] loss-1.209-|Sample:1.08|use_time:60.96536684036255
loss: -1.2093270028509744, EarlyStopping counter: 172 out of 300
EPOCH[1146/2000] loss-1.207-|Sample:1.12|use_time:60.83094310760498
loss: -1.2070268189034812, EarlyStopping counter: 173 out of 300
EPOCH[1147/2000] loss-1.208-|Sample:1.08|use_time:61.67827296257019
loss: -1.2081079744711154, EarlyStopping counter: 174 out of 300
EPOCH[1148/2000] loss-1.208-|Sample:1.12|use_time:60.88602161407471
loss: -1.2081666341642054, EarlyStopping counter: 175 out of 300
EPOCH[1149/2000] loss-1.211-|Sample:1.07|use_time:61.2933464050293
EPOCH[1150/2000] loss-1.212-|Sample:1.09|use_time:60.43276238441467
[TEST]
{'precision': array([0.02707865, 0.02026217, 0.01210487]), 'recall': array([0.11555197, 0.1702775 , 0.25193312]), 'ndcg': array([0.07801191, 0.09462175, 0.1146751 ]), 'coverage': array([24.00274657, 28.19475655, 33.25068664]), 'Acoverage': array([136.44872263, 183.44375324, 262.15480649]), 'ILD': array([0.71839645, 0.73442539, 0.76607903]), 'F1': array([0.19908216, 0.27645788, 0.37917166])}
test time: 270.9803168773651
reg_loss2: tensor(0.0091, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2269, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[1151/2000] loss-1.207-|Sample:1.08|use_time:60.296780824661255
loss: -1.2071869431472406, EarlyStopping counter: 1 out of 300
EPOCH[1152/2000] loss-1.207-|Sample:1.07|use_time:60.81620454788208
loss: -1.2070911512142275, EarlyStopping counter: 2 out of 300
EPOCH[1153/2000] loss-1.210-|Sample:1.16|use_time:60.652668476104736
loss: -1.210130941577074, EarlyStopping counter: 3 out of 300
EPOCH[1154/2000] loss-1.208-|Sample:1.10|use_time:60.73316669464111
loss: -1.2084682365743125, EarlyStopping counter: 4 out of 300
EPOCH[1155/2000] loss-1.208-|Sample:1.10|use_time:60.97165513038635
loss: -1.207832042763873, EarlyStopping counter: 5 out of 300
EPOCH[1156/2000] loss-1.208-|Sample:1.07|use_time:60.471460580825806
loss: -1.2083030764649554, EarlyStopping counter: 6 out of 300
EPOCH[1157/2000] loss-1.209-|Sample:1.08|use_time:60.98751878738403
loss: -1.2094201314740065, EarlyStopping counter: 7 out of 300
EPOCH[1158/2000] loss-1.208-|Sample:1.07|use_time:60.50770092010498
loss: -1.208368816026827, EarlyStopping counter: 8 out of 300
EPOCH[1159/2000] loss-1.208-|Sample:1.06|use_time:60.01046323776245
loss: -1.2079890908264532, EarlyStopping counter: 9 out of 300
EPOCH[1160/2000] loss-1.209-|Sample:1.06|use_time:60.00316882133484
loss: -1.208757668006711, EarlyStopping counter: 10 out of 300
EPOCH[1161/2000] loss-1.208-|Sample:1.07|use_time:60.665825605392456
loss: -1.2075862739144303, EarlyStopping counter: 11 out of 300
EPOCH[1162/2000] loss-1.209-|Sample:1.06|use_time:61.20227861404419
loss: -1.2085230670324185, EarlyStopping counter: 12 out of 300
EPOCH[1163/2000] loss-1.207-|Sample:1.10|use_time:61.37092924118042
loss: -1.2072854420033896, EarlyStopping counter: 13 out of 300
EPOCH[1164/2000] loss-1.207-|Sample:1.02|use_time:60.707369565963745
loss: -1.2072430093113968, EarlyStopping counter: 14 out of 300
EPOCH[1165/2000] loss-1.207-|Sample:1.00|use_time:60.52207541465759
loss: -1.2070693039312594, EarlyStopping counter: 15 out of 300
EPOCH[1166/2000] loss-1.208-|Sample:1.18|use_time:60.9662549495697
loss: -1.2075438848355922, EarlyStopping counter: 16 out of 300
EPOCH[1167/2000] loss-1.208-|Sample:1.13|use_time:60.53971028327942
loss: -1.208289565109625, EarlyStopping counter: 17 out of 300
EPOCH[1168/2000] loss-1.210-|Sample:1.07|use_time:60.267701864242554
loss: -1.2100182161098574, EarlyStopping counter: 18 out of 300
EPOCH[1169/2000] loss-1.208-|Sample:1.06|use_time:60.33784770965576
loss: -1.2082340717315674, EarlyStopping counter: 19 out of 300
EPOCH[1170/2000] loss-1.207-|Sample:1.07|use_time:60.79209494590759
loss: -1.207038353129131, EarlyStopping counter: 20 out of 300
EPOCH[1171/2000] loss-1.210-|Sample:1.02|use_time:60.26371932029724
loss: -1.2095457344520382, EarlyStopping counter: 21 out of 300
EPOCH[1172/2000] loss-1.209-|Sample:1.04|use_time:60.42112731933594
loss: -1.2093158349758242, EarlyStopping counter: 22 out of 300
EPOCH[1173/2000] loss-1.209-|Sample:1.09|use_time:60.725635051727295
loss: -1.20863537381335, EarlyStopping counter: 23 out of 300
EPOCH[1174/2000] loss-1.209-|Sample:1.04|use_time:60.55368661880493
loss: -1.209166532609521, EarlyStopping counter: 24 out of 300
EPOCH[1175/2000] loss-1.208-|Sample:1.04|use_time:60.2161545753479
loss: -1.2080361319751274, EarlyStopping counter: 25 out of 300
EPOCH[1176/2000] loss-1.208-|Sample:1.05|use_time:60.190956354141235
loss: -1.2081798634878018, EarlyStopping counter: 26 out of 300
EPOCH[1177/2000] loss-1.207-|Sample:1.02|use_time:60.324262619018555
loss: -1.2066018901220181, EarlyStopping counter: 27 out of 300
EPOCH[1178/2000] loss-1.208-|Sample:1.01|use_time:60.41222953796387
loss: -1.208052437479903, EarlyStopping counter: 28 out of 300
EPOCH[1179/2000] loss-1.210-|Sample:0.99|use_time:60.495970249176025
loss: -1.210220267133015, EarlyStopping counter: 29 out of 300
EPOCH[1180/2000] loss-1.208-|Sample:1.03|use_time:60.339287519454956
loss: -1.2079194231731136, EarlyStopping counter: 30 out of 300
EPOCH[1181/2000] loss-1.210-|Sample:1.01|use_time:60.22277617454529
loss: -1.2103079266664458, EarlyStopping counter: 31 out of 300
EPOCH[1182/2000] loss-1.209-|Sample:1.09|use_time:60.76005005836487
loss: -1.2093598726319104, EarlyStopping counter: 32 out of 300
EPOCH[1183/2000] loss-1.208-|Sample:1.07|use_time:60.93981885910034
loss: -1.2078068488981666, EarlyStopping counter: 33 out of 300
EPOCH[1184/2000] loss-1.210-|Sample:1.01|use_time:60.76392459869385
loss: -1.2101926978041486, EarlyStopping counter: 34 out of 300
EPOCH[1185/2000] loss-1.208-|Sample:1.08|use_time:60.22612905502319
loss: -1.2077225039644939, EarlyStopping counter: 35 out of 300
EPOCH[1186/2000] loss-1.206-|Sample:1.10|use_time:60.56171679496765
loss: -1.2063895929150465, EarlyStopping counter: 36 out of 300
EPOCH[1187/2000] loss-1.210-|Sample:1.06|use_time:61.11491250991821
loss: -1.2098659044358788, EarlyStopping counter: 37 out of 300
EPOCH[1188/2000] loss-1.209-|Sample:1.07|use_time:60.66903066635132
loss: -1.2093782221398703, EarlyStopping counter: 38 out of 300
EPOCH[1189/2000] loss-1.208-|Sample:1.11|use_time:60.68560743331909
loss: -1.2079262762534908, EarlyStopping counter: 39 out of 300
EPOCH[1190/2000] loss-1.209-|Sample:1.06|use_time:60.83228921890259
loss: -1.2092324320862933, EarlyStopping counter: 40 out of 300
EPOCH[1191/2000] loss-1.206-|Sample:1.00|use_time:60.3663866519928
loss: -1.2061794269375685, EarlyStopping counter: 41 out of 300
EPOCH[1192/2000] loss-1.211-|Sample:1.04|use_time:60.629042863845825
loss: -1.2109335166652029, EarlyStopping counter: 42 out of 300
EPOCH[1193/2000] loss-1.209-|Sample:1.08|use_time:61.04141402244568
loss: -1.2092890012555007, EarlyStopping counter: 43 out of 300
EPOCH[1194/2000] loss-1.208-|Sample:1.05|use_time:60.61683440208435
loss: -1.2076516703861515, EarlyStopping counter: 44 out of 300
EPOCH[1195/2000] loss-1.210-|Sample:1.04|use_time:60.522531270980835
loss: -1.2100509172532616, EarlyStopping counter: 45 out of 300
EPOCH[1196/2000] loss-1.208-|Sample:1.06|use_time:60.612643241882324
loss: -1.2077301246363943, EarlyStopping counter: 46 out of 300
EPOCH[1197/2000] loss-1.205-|Sample:1.05|use_time:60.90182375907898
loss: -1.2053735227119633, EarlyStopping counter: 47 out of 300
EPOCH[1198/2000] loss-1.208-|Sample:1.12|use_time:60.4363169670105
loss: -1.2080564615203113, EarlyStopping counter: 48 out of 300
EPOCH[1199/2000] loss-1.207-|Sample:1.06|use_time:60.37506294250488
loss: -1.2073916836482723, EarlyStopping counter: 49 out of 300
EPOCH[1200/2000] loss-1.207-|Sample:1.04|use_time:60.042890787124634
loss: -1.2070233502039096, EarlyStopping counter: 50 out of 300
[TEST]
{'precision': array([0.02752809, 0.02021223, 0.01210487]), 'recall': array([0.11755819, 0.16918529, 0.25054598]), 'ndcg': array([0.0790489 , 0.0948326 , 0.11478335]), 'coverage': array([24.17440699, 28.35430712, 33.24044944]), 'Acoverage': array([136.3365336 , 183.72411011, 262.50231114]), 'ILD': array([0.71475933, 0.73293515, 0.76558832]), 'F1': array([0.20190807, 0.27491195, 0.37753882])}
test time: 266.65054512023926
reg_loss2: tensor(0.0090, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.1902, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[1201/2000] loss-1.207-|Sample:1.03|use_time:60.19028091430664
loss: -1.2073611137343616, EarlyStopping counter: 51 out of 300
EPOCH[1202/2000] loss-1.210-|Sample:0.98|use_time:60.54066729545593
loss: -1.2096442129553817, EarlyStopping counter: 52 out of 300
EPOCH[1203/2000] loss-1.209-|Sample:1.97|use_time:60.57977652549744
loss: -1.209412208417567, EarlyStopping counter: 53 out of 300
EPOCH[1204/2000] loss-1.208-|Sample:2.10|use_time:61.11208891868591
loss: -1.2083225802677433, EarlyStopping counter: 54 out of 300
EPOCH[1205/2000] loss-1.208-|Sample:1.99|use_time:61.44161128997803
loss: -1.2079031729116672, EarlyStopping counter: 55 out of 300
EPOCH[1206/2000] loss-1.209-|Sample:1.00|use_time:59.90332818031311
loss: -1.2085415502873862, EarlyStopping counter: 56 out of 300
EPOCH[1207/2000] loss-1.210-|Sample:1.95|use_time:60.41341280937195
loss: -1.2096688602028824, EarlyStopping counter: 57 out of 300
EPOCH[1208/2000] loss-1.208-|Sample:2.01|use_time:60.57897615432739
loss: -1.2078025689939174, EarlyStopping counter: 58 out of 300
EPOCH[1209/2000] loss-1.207-|Sample:2.06|use_time:60.231114864349365
loss: -1.2074978148064963, EarlyStopping counter: 59 out of 300
EPOCH[1210/2000] loss-1.207-|Sample:2.09|use_time:60.581976890563965
loss: -1.2071965002432101, EarlyStopping counter: 60 out of 300
EPOCH[1211/2000] loss-1.212-|Sample:1.98|use_time:60.2520546913147
loss: -1.2117672926042138, EarlyStopping counter: 61 out of 300
EPOCH[1212/2000] loss-1.208-|Sample:1.98|use_time:60.68917679786682
loss: -1.2083753870754708, EarlyStopping counter: 62 out of 300
EPOCH[1213/2000] loss-1.207-|Sample:2.06|use_time:61.66940188407898
loss: -1.2068580883305247, EarlyStopping counter: 63 out of 300
EPOCH[1214/2000] loss-1.206-|Sample:1.80|use_time:60.35067915916443
loss: -1.2061783889444864, EarlyStopping counter: 64 out of 300
EPOCH[1215/2000] loss-1.207-|Sample:1.95|use_time:60.98491048812866
loss: -1.207433563906972, EarlyStopping counter: 65 out of 300
EPOCH[1216/2000] loss-1.206-|Sample:1.04|use_time:59.97809624671936
loss: -1.2057246842035434, EarlyStopping counter: 66 out of 300
EPOCH[1217/2000] loss-1.209-|Sample:1.99|use_time:60.56562089920044
loss: -1.2094700394607172, EarlyStopping counter: 67 out of 300
EPOCH[1218/2000] loss-1.209-|Sample:2.08|use_time:61.290183305740356
loss: -1.2094168663024902, EarlyStopping counter: 68 out of 300
EPOCH[1219/2000] loss-1.208-|Sample:1.80|use_time:60.58190989494324
loss: -1.2084855713495395, EarlyStopping counter: 69 out of 300
EPOCH[1220/2000] loss-1.210-|Sample:2.04|use_time:60.76275110244751
loss: -1.2097187129462637, EarlyStopping counter: 70 out of 300
EPOCH[1221/2000] loss-1.209-|Sample:2.09|use_time:60.46937012672424
loss: -1.2091383265285958, EarlyStopping counter: 71 out of 300
EPOCH[1222/2000] loss-1.207-|Sample:2.01|use_time:60.70058512687683
loss: -1.2072614053400552, EarlyStopping counter: 72 out of 300
EPOCH[1223/2000] loss-1.209-|Sample:0.99|use_time:60.48628783226013
loss: -1.2088036159189737, EarlyStopping counter: 73 out of 300
EPOCH[1224/2000] loss-1.209-|Sample:2.06|use_time:60.431469440460205
loss: -1.2088275566333677, EarlyStopping counter: 74 out of 300
EPOCH[1225/2000] loss-1.207-|Sample:2.05|use_time:61.14090085029602
loss: -1.2073528417726842, EarlyStopping counter: 75 out of 300
EPOCH[1226/2000] loss-1.209-|Sample:2.12|use_time:60.46085858345032
loss: -1.2086176755951672, EarlyStopping counter: 76 out of 300
EPOCH[1227/2000] loss-1.209-|Sample:2.05|use_time:61.19028329849243
loss: -1.2088460660562284, EarlyStopping counter: 77 out of 300
EPOCH[1228/2000] loss-1.207-|Sample:2.10|use_time:60.52880644798279
loss: -1.2071790084606264, EarlyStopping counter: 78 out of 300
EPOCH[1229/2000] loss-1.208-|Sample:1.99|use_time:61.48490881919861
loss: -1.208316486056258, EarlyStopping counter: 79 out of 300
EPOCH[1230/2000] loss-1.209-|Sample:1.54|use_time:60.156264305114746
loss: -1.2088154612517938, EarlyStopping counter: 80 out of 300
EPOCH[1231/2000] loss-1.207-|Sample:1.96|use_time:61.54383826255798
loss: -1.2074722255148538, EarlyStopping counter: 81 out of 300
EPOCH[1232/2000] loss-1.208-|Sample:1.63|use_time:60.18256592750549
loss: -1.2080153255927852, EarlyStopping counter: 82 out of 300
EPOCH[1233/2000] loss-1.213-|Sample:1.99|use_time:60.36806273460388
EPOCH[1234/2000] loss-1.211-|Sample:1.93|use_time:60.409881353378296
loss: -1.2111178287645665, EarlyStopping counter: 1 out of 300
EPOCH[1235/2000] loss-1.209-|Sample:2.06|use_time:60.2797691822052
loss: -1.20909395450499, EarlyStopping counter: 2 out of 300
EPOCH[1236/2000] loss-1.209-|Sample:2.05|use_time:60.41746664047241
loss: -1.2094949512946895, EarlyStopping counter: 3 out of 300
EPOCH[1237/2000] loss-1.211-|Sample:2.05|use_time:61.07419729232788
loss: -1.2105881470005686, EarlyStopping counter: 4 out of 300
EPOCH[1238/2000] loss-1.207-|Sample:2.09|use_time:60.61413884162903
loss: -1.2066609888541988, EarlyStopping counter: 5 out of 300
EPOCH[1239/2000] loss-1.209-|Sample:2.04|use_time:60.787193059921265
loss: -1.209451692860301, EarlyStopping counter: 6 out of 300
EPOCH[1240/2000] loss-1.208-|Sample:2.04|use_time:61.221107006073
loss: -1.2084372101760492, EarlyStopping counter: 7 out of 300
EPOCH[1241/2000] loss-1.209-|Sample:1.84|use_time:61.330926179885864
loss: -1.2091674513933135, EarlyStopping counter: 8 out of 300
EPOCH[1242/2000] loss-1.208-|Sample:1.04|use_time:60.307398557662964
loss: -1.2076471142652558, EarlyStopping counter: 9 out of 300
EPOCH[1243/2000] loss-1.208-|Sample:2.01|use_time:60.420647859573364
loss: -1.2075367002952389, EarlyStopping counter: 10 out of 300
EPOCH[1244/2000] loss-1.208-|Sample:2.06|use_time:61.24861216545105
loss: -1.2080129792050618, EarlyStopping counter: 11 out of 300
EPOCH[1245/2000] loss-1.212-|Sample:1.88|use_time:60.55933976173401
loss: -1.211875996938566, EarlyStopping counter: 12 out of 300
EPOCH[1246/2000] loss-1.209-|Sample:1.93|use_time:60.27868962287903
loss: -1.2090539176289627, EarlyStopping counter: 13 out of 300
EPOCH[1247/2000] loss-1.208-|Sample:1.98|use_time:60.27321672439575
loss: -1.2084903891493635, EarlyStopping counter: 14 out of 300
EPOCH[1248/2000] loss-1.210-|Sample:1.88|use_time:60.97665333747864
loss: -1.2099475453539592, EarlyStopping counter: 15 out of 300
EPOCH[1249/2000] loss-1.208-|Sample:1.14|use_time:60.64425563812256
loss: -1.2079984792848912, EarlyStopping counter: 16 out of 300
EPOCH[1250/2000] loss-1.209-|Sample:1.96|use_time:60.49821591377258
loss: -1.2088485636362216, EarlyStopping counter: 17 out of 300
[TEST]
{'precision': array([0.02740325, 0.02008115, 0.01215481]), 'recall': array([0.11787285, 0.16891784, 0.2525835 ]), 'ndcg': array([0.07920679, 0.09480738, 0.11542532]), 'coverage': array([24.19712859, 28.24918851, 33.28102372]), 'Acoverage': array([136.15610974, 183.12411924, 262.02439024]), 'ILD': array([0.71611042, 0.73400749, 0.76718113]), 'F1': array([0.20242606, 0.27463392, 0.38004317])}
test time: 265.4038710594177
reg_loss2: tensor(0.0090, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2163, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[1251/2000] loss-1.208-|Sample:2.00|use_time:60.08133268356323
loss: -1.207578272354312, EarlyStopping counter: 18 out of 300
EPOCH[1252/2000] loss-1.207-|Sample:1.97|use_time:60.89886975288391
loss: -1.2068558640596343, EarlyStopping counter: 19 out of 300
EPOCH[1253/2000] loss-1.207-|Sample:1.63|use_time:60.533547163009644
loss: -1.2065172660641554, EarlyStopping counter: 20 out of 300
EPOCH[1254/2000] loss-1.208-|Sample:1.06|use_time:60.144389629364014
loss: -1.2082269540647181, EarlyStopping counter: 21 out of 300
EPOCH[1255/2000] loss-1.208-|Sample:2.05|use_time:60.30693030357361
loss: -1.2078570272864364, EarlyStopping counter: 22 out of 300
EPOCH[1256/2000] loss-1.209-|Sample:1.97|use_time:61.235302448272705
loss: -1.2091741852644013, EarlyStopping counter: 23 out of 300
EPOCH[1257/2000] loss-1.208-|Sample:1.64|use_time:60.059223651885986
loss: -1.2081672883615262, EarlyStopping counter: 24 out of 300
EPOCH[1258/2000] loss-1.208-|Sample:2.01|use_time:60.722442388534546
loss: -1.207881337258874, EarlyStopping counter: 25 out of 300
EPOCH[1259/2000] loss-1.208-|Sample:2.02|use_time:60.304314613342285
loss: -1.2084028197497856, EarlyStopping counter: 26 out of 300
EPOCH[1260/2000] loss-1.210-|Sample:1.99|use_time:60.88339066505432
loss: -1.2097897878507289, EarlyStopping counter: 27 out of 300
EPOCH[1261/2000] loss-1.208-|Sample:1.79|use_time:60.298128604888916
loss: -1.208311345519089, EarlyStopping counter: 28 out of 300
EPOCH[1262/2000] loss-1.210-|Sample:2.05|use_time:60.67828822135925
loss: -1.2100635796058468, EarlyStopping counter: 29 out of 300
EPOCH[1263/2000] loss-1.206-|Sample:2.12|use_time:61.21655082702637
loss: -1.2059543917818767, EarlyStopping counter: 30 out of 300
EPOCH[1264/2000] loss-1.210-|Sample:2.01|use_time:61.26110029220581
loss: -1.2099939264902255, EarlyStopping counter: 31 out of 300
EPOCH[1265/2000] loss-1.207-|Sample:1.04|use_time:61.006409883499146
loss: -1.2069066762924194, EarlyStopping counter: 32 out of 300
EPOCH[1266/2000] loss-1.209-|Sample:2.13|use_time:60.942758560180664
loss: -1.209089011680789, EarlyStopping counter: 33 out of 300
EPOCH[1267/2000] loss-1.210-|Sample:2.03|use_time:61.53434944152832
loss: -1.2097021457625599, EarlyStopping counter: 34 out of 300
EPOCH[1268/2000] loss-1.209-|Sample:1.66|use_time:60.26455760002136
loss: -1.208690279867591, EarlyStopping counter: 35 out of 300
EPOCH[1269/2000] loss-1.208-|Sample:2.02|use_time:60.59245300292969
loss: -1.2077001885669987, EarlyStopping counter: 36 out of 300
EPOCH[1270/2000] loss-1.209-|Sample:2.03|use_time:60.51068830490112
loss: -1.2086863401459484, EarlyStopping counter: 37 out of 300
EPOCH[1271/2000] loss-1.210-|Sample:2.13|use_time:61.17313742637634
loss: -1.2095068198878591, EarlyStopping counter: 38 out of 300
EPOCH[1272/2000] loss-1.207-|Sample:1.01|use_time:60.16295599937439
loss: -1.2066798762577335, EarlyStopping counter: 39 out of 300
EPOCH[1273/2000] loss-1.209-|Sample:2.13|use_time:60.66919183731079
loss: -1.2090163725178416, EarlyStopping counter: 40 out of 300
EPOCH[1274/2000] loss-1.209-|Sample:2.04|use_time:60.15773153305054
loss: -1.2093697146671574, EarlyStopping counter: 41 out of 300
EPOCH[1275/2000] loss-1.208-|Sample:1.99|use_time:60.20835018157959
loss: -1.2081743856755698, EarlyStopping counter: 42 out of 300
EPOCH[1276/2000] loss-1.209-|Sample:2.08|use_time:61.573699712753296
loss: -1.2085110414318923, EarlyStopping counter: 43 out of 300
EPOCH[1277/2000] loss-1.210-|Sample:2.02|use_time:60.34414505958557
loss: -1.2100440321899042, EarlyStopping counter: 44 out of 300
EPOCH[1278/2000] loss-1.208-|Sample:2.03|use_time:60.97851252555847
loss: -1.2083225482847633, EarlyStopping counter: 45 out of 300
EPOCH[1279/2000] loss-1.208-|Sample:1.85|use_time:60.28463077545166
loss: -1.2083635417426504, EarlyStopping counter: 46 out of 300
EPOCH[1280/2000] loss-1.208-|Sample:2.11|use_time:61.222718238830566
loss: -1.2077764388991565, EarlyStopping counter: 47 out of 300
EPOCH[1281/2000] loss-1.209-|Sample:1.50|use_time:59.64802002906799
loss: -1.2088412220885114, EarlyStopping counter: 48 out of 300
EPOCH[1282/2000] loss-1.212-|Sample:2.06|use_time:60.25603485107422
loss: -1.2115603888907083, EarlyStopping counter: 49 out of 300
EPOCH[1283/2000] loss-1.207-|Sample:2.02|use_time:60.489712715148926
loss: -1.2073811816006172, EarlyStopping counter: 50 out of 300
EPOCH[1284/2000] loss-1.208-|Sample:2.04|use_time:60.46657729148865
loss: -1.2084799365299503, EarlyStopping counter: 51 out of 300
EPOCH[1285/2000] loss-1.207-|Sample:2.03|use_time:61.06260132789612
loss: -1.20748841181034, EarlyStopping counter: 52 out of 300
EPOCH[1286/2000] loss-1.210-|Sample:2.07|use_time:61.44884419441223
loss: -1.2101608514785767, EarlyStopping counter: 53 out of 300
EPOCH[1287/2000] loss-1.211-|Sample:2.02|use_time:60.74308371543884
loss: -1.21082085807149, EarlyStopping counter: 54 out of 300
EPOCH[1288/2000] loss-1.209-|Sample:2.07|use_time:60.92001461982727
loss: -1.2094388764079025, EarlyStopping counter: 55 out of 300
EPOCH[1289/2000] loss-1.209-|Sample:2.05|use_time:61.579997301101685
loss: -1.2089192605600125, EarlyStopping counter: 56 out of 300
EPOCH[1290/2000] loss-1.207-|Sample:2.05|use_time:61.79436206817627
loss: -1.2074753046035767, EarlyStopping counter: 57 out of 300
EPOCH[1291/2000] loss-1.208-|Sample:1.06|use_time:60.123769760131836
loss: -1.2083665743106748, EarlyStopping counter: 58 out of 300
EPOCH[1292/2000] loss-1.211-|Sample:2.10|use_time:61.03743290901184
loss: -1.210913698847701, EarlyStopping counter: 59 out of 300
EPOCH[1293/2000] loss-1.207-|Sample:2.00|use_time:61.54857659339905
loss: -1.2068924496813518, EarlyStopping counter: 60 out of 300
EPOCH[1294/2000] loss-1.209-|Sample:1.60|use_time:61.61425971984863
loss: -1.208500664408614, EarlyStopping counter: 61 out of 300
EPOCH[1295/2000] loss-1.207-|Sample:2.14|use_time:60.67207646369934
loss: -1.2069846915035713, EarlyStopping counter: 62 out of 300
EPOCH[1296/2000] loss-1.208-|Sample:2.00|use_time:60.63803720474243
loss: -1.2079595182000138, EarlyStopping counter: 63 out of 300
EPOCH[1297/2000] loss-1.209-|Sample:2.00|use_time:60.480783462524414
loss: -1.2094657682790988, EarlyStopping counter: 64 out of 300
EPOCH[1298/2000] loss-1.206-|Sample:1.05|use_time:60.023985385894775
loss: -1.206496785326702, EarlyStopping counter: 65 out of 300
EPOCH[1299/2000] loss-1.208-|Sample:2.03|use_time:60.39174437522888
loss: -1.2079804757746255, EarlyStopping counter: 66 out of 300
EPOCH[1300/2000] loss-1.207-|Sample:2.06|use_time:60.65423846244812
loss: -1.2068072673751087, EarlyStopping counter: 67 out of 300
[TEST]
{'precision': array([0.02716604, 0.02004994, 0.01217978]), 'recall': array([0.11584374, 0.1681778 , 0.25334384]), 'ndcg': array([0.07884094, 0.09482217, 0.11573966]), 'coverage': array([24.19188514, 28.40087391, 33.32883895]), 'Acoverage': array([135.95626199, 183.17761335, 262.32542554]), 'ILD': array([0.71607713, 0.73317038, 0.76610247]), 'F1': array([0.19942535, 0.27359679, 0.38077011])}
test time: 263.45051860809326
reg_loss2: tensor(0.0090, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2151, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[1301/2000] loss-1.209-|Sample:1.97|use_time:60.51569628715515
loss: -1.2085663574497874, EarlyStopping counter: 68 out of 300
EPOCH[1302/2000] loss-1.209-|Sample:1.92|use_time:60.66126203536987
loss: -1.208952743832658, EarlyStopping counter: 69 out of 300
EPOCH[1303/2000] loss-1.206-|Sample:1.05|use_time:60.31951022148132
loss: -1.20625571216025, EarlyStopping counter: 70 out of 300
EPOCH[1304/2000] loss-1.212-|Sample:2.04|use_time:60.46844148635864
loss: -1.2120284336369211, EarlyStopping counter: 71 out of 300
EPOCH[1305/2000] loss-1.211-|Sample:2.12|use_time:61.55278921127319
loss: -1.2108127809152371, EarlyStopping counter: 72 out of 300
EPOCH[1306/2000] loss-1.209-|Sample:1.56|use_time:59.994452714920044
loss: -1.208659960002434, EarlyStopping counter: 73 out of 300
EPOCH[1307/2000] loss-1.206-|Sample:2.89|use_time:61.76487946510315
loss: -1.2063856648235787, EarlyStopping counter: 74 out of 300
EPOCH[1308/2000] loss-1.210-|Sample:2.14|use_time:60.818814277648926
loss: -1.2101927414173033, EarlyStopping counter: 75 out of 300
EPOCH[1309/2000] loss-1.208-|Sample:2.32|use_time:60.98803377151489
loss: -1.2084440748866012, EarlyStopping counter: 76 out of 300
EPOCH[1310/2000] loss-1.209-|Sample:1.01|use_time:60.32061696052551
loss: -1.2092942377416098, EarlyStopping counter: 77 out of 300
EPOCH[1311/2000] loss-1.211-|Sample:2.05|use_time:60.624900102615356
loss: -1.2112146208925945, EarlyStopping counter: 78 out of 300
EPOCH[1312/2000] loss-1.208-|Sample:2.03|use_time:60.53606390953064
loss: -1.207700961973609, EarlyStopping counter: 79 out of 300
EPOCH[1313/2000] loss-1.209-|Sample:2.02|use_time:60.33890247344971
loss: -1.2088180053524855, EarlyStopping counter: 80 out of 300
EPOCH[1314/2000] loss-1.207-|Sample:2.07|use_time:60.97726631164551
loss: -1.2068599375282847, EarlyStopping counter: 81 out of 300
EPOCH[1315/2000] loss-1.207-|Sample:2.04|use_time:61.45949840545654
loss: -1.2072246568958933, EarlyStopping counter: 82 out of 300
EPOCH[1316/2000] loss-1.208-|Sample:2.04|use_time:61.32446312904358
loss: -1.2079359641889247, EarlyStopping counter: 83 out of 300
EPOCH[1317/2000] loss-1.208-|Sample:1.64|use_time:59.665300369262695
loss: -1.2078747022442702, EarlyStopping counter: 84 out of 300
EPOCH[1318/2000] loss-1.208-|Sample:2.05|use_time:61.66056823730469
loss: -1.2081700185450113, EarlyStopping counter: 85 out of 300
EPOCH[1319/2000] loss-1.210-|Sample:1.62|use_time:60.08932089805603
loss: -1.2095224857330322, EarlyStopping counter: 86 out of 300
EPOCH[1320/2000] loss-1.209-|Sample:2.08|use_time:60.56594944000244
loss: -1.2090136365192692, EarlyStopping counter: 87 out of 300
EPOCH[1321/2000] loss-1.209-|Sample:2.04|use_time:60.53224802017212
loss: -1.209030197887886, EarlyStopping counter: 88 out of 300
EPOCH[1322/2000] loss-1.209-|Sample:2.04|use_time:60.26500344276428
loss: -1.2091235416691477, EarlyStopping counter: 89 out of 300
EPOCH[1323/2000] loss-1.208-|Sample:2.00|use_time:60.571670055389404
loss: -1.2075085988858851, EarlyStopping counter: 90 out of 300
EPOCH[1324/2000] loss-1.208-|Sample:2.00|use_time:61.30541253089905
loss: -1.2084001157341935, EarlyStopping counter: 91 out of 300
EPOCH[1325/2000] loss-1.206-|Sample:1.77|use_time:60.9702205657959
loss: -1.2063648846091293, EarlyStopping counter: 92 out of 300
EPOCH[1326/2000] loss-1.208-|Sample:2.02|use_time:60.78632926940918
loss: -1.2075608299999703, EarlyStopping counter: 93 out of 300
EPOCH[1327/2000] loss-1.209-|Sample:2.10|use_time:61.8857901096344
loss: -1.2093763235138684, EarlyStopping counter: 94 out of 300
EPOCH[1328/2000] loss-1.208-|Sample:1.85|use_time:61.38112139701843
loss: -1.2076467217468634, EarlyStopping counter: 95 out of 300
EPOCH[1329/2000] loss-1.209-|Sample:1.02|use_time:60.30581831932068
loss: -1.2089156377606276, EarlyStopping counter: 96 out of 300
EPOCH[1330/2000] loss-1.209-|Sample:1.88|use_time:60.43202209472656
loss: -1.2087355183392037, EarlyStopping counter: 97 out of 300
EPOCH[1331/2000] loss-1.207-|Sample:1.95|use_time:61.17401194572449
loss: -1.2070062509397181, EarlyStopping counter: 98 out of 300
EPOCH[1332/2000] loss-1.209-|Sample:1.78|use_time:60.722015142440796
loss: -1.2085148648517887, EarlyStopping counter: 99 out of 300
EPOCH[1333/2000] loss-1.209-|Sample:1.92|use_time:60.75168967247009
loss: -1.2087272841755936, EarlyStopping counter: 100 out of 300
EPOCH[1334/2000] loss-1.208-|Sample:2.05|use_time:60.69703149795532
loss: -1.2077286156212412, EarlyStopping counter: 101 out of 300
EPOCH[1335/2000] loss-1.210-|Sample:2.03|use_time:61.870553731918335
loss: -1.2098892316585634, EarlyStopping counter: 102 out of 300
EPOCH[1336/2000] loss-1.209-|Sample:2.05|use_time:60.61158299446106
loss: -1.2091144963008602, EarlyStopping counter: 103 out of 300
EPOCH[1337/2000] loss-1.206-|Sample:3.00|use_time:63.119091749191284
loss: -1.205673022968013, EarlyStopping counter: 104 out of 300
EPOCH[1338/2000] loss-1.209-|Sample:2.25|use_time:61.35585808753967
loss: -1.2085886146964095, EarlyStopping counter: 105 out of 300
EPOCH[1339/2000] loss-1.208-|Sample:2.90|use_time:63.02199625968933
loss: -1.2084394664299198, EarlyStopping counter: 106 out of 300
EPOCH[1340/2000] loss-1.208-|Sample:1.08|use_time:61.66900134086609
loss: -1.2076098831688487, EarlyStopping counter: 107 out of 300
EPOCH[1341/2000] loss-1.211-|Sample:2.40|use_time:61.141831398010254
loss: -1.2107532693118583, EarlyStopping counter: 108 out of 300
EPOCH[1342/2000] loss-1.207-|Sample:2.70|use_time:64.05721473693848
loss: -1.2070045558417715, EarlyStopping counter: 109 out of 300
EPOCH[1343/2000] loss-1.210-|Sample:1.75|use_time:60.39935088157654
loss: -1.2102229188128215, EarlyStopping counter: 110 out of 300
EPOCH[1344/2000] loss-1.208-|Sample:2.76|use_time:61.26522707939148
loss: -1.2078287950376185, EarlyStopping counter: 111 out of 300
EPOCH[1345/2000] loss-1.209-|Sample:2.05|use_time:60.256805658340454
loss: -1.209453143724581, EarlyStopping counter: 112 out of 300
EPOCH[1346/2000] loss-1.207-|Sample:2.08|use_time:60.99876046180725
loss: -1.2068968022741922, EarlyStopping counter: 113 out of 300
EPOCH[1347/2000] loss-1.208-|Sample:1.00|use_time:60.38094353675842
loss: -1.208171042000375, EarlyStopping counter: 114 out of 300
EPOCH[1348/2000] loss-1.209-|Sample:2.06|use_time:60.65827178955078
loss: -1.2085248900622856, EarlyStopping counter: 115 out of 300
EPOCH[1349/2000] loss-1.206-|Sample:1.99|use_time:60.72635626792908
loss: -1.2057294118695143, EarlyStopping counter: 116 out of 300
EPOCH[1350/2000] loss-1.209-|Sample:2.03|use_time:60.64248704910278
loss: -1.2091323864169237, EarlyStopping counter: 117 out of 300
[TEST]
{'precision': array([0.02764045, 0.02029963, 0.01212984]), 'recall': array([0.11834692, 0.17023309, 0.25166389]), 'ndcg': array([0.07986708, 0.09564316, 0.1156661 ]), 'coverage': array([24.25518102, 28.35817728, 33.22808989]), 'Acoverage': array([136.06022959, 182.8831278 , 262.31437837]), 'ILD': array([0.71416008, 0.73210461, 0.76509934]), 'F1': array([0.20304609, 0.27623457, 0.37874673])}
test time: 265.18297958374023
reg_loss2: tensor(0.0090, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2547, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[1351/2000] loss-1.209-|Sample:2.05|use_time:60.49334716796875
loss: -1.2085870533454708, EarlyStopping counter: 118 out of 300
EPOCH[1352/2000] loss-1.208-|Sample:2.05|use_time:60.76104688644409
loss: -1.2078087795071486, EarlyStopping counter: 119 out of 300
EPOCH[1353/2000] loss-1.209-|Sample:2.06|use_time:61.56665229797363
loss: -1.209486647350032, EarlyStopping counter: 120 out of 300
EPOCH[1354/2000] loss-1.209-|Sample:1.53|use_time:60.0918550491333
loss: -1.208655182908221, EarlyStopping counter: 121 out of 300
EPOCH[1355/2000] loss-1.209-|Sample:1.89|use_time:61.3517644405365
loss: -1.2087706414664663, EarlyStopping counter: 122 out of 300
EPOCH[1356/2000] loss-1.206-|Sample:1.07|use_time:60.11468529701233
loss: -1.205560986588641, EarlyStopping counter: 123 out of 300
EPOCH[1357/2000] loss-1.207-|Sample:3.12|use_time:63.245983600616455
loss: -1.2065678282481869, EarlyStopping counter: 124 out of 300
EPOCH[1358/2000] loss-1.208-|Sample:2.46|use_time:62.03683519363403
loss: -1.2083806264691237, EarlyStopping counter: 125 out of 300
EPOCH[1359/2000] loss-1.209-|Sample:3.33|use_time:63.005595207214355
loss: -1.2086102410060604, EarlyStopping counter: 126 out of 300
EPOCH[1360/2000] loss-1.207-|Sample:1.07|use_time:60.2974693775177
loss: -1.2074262368969801, EarlyStopping counter: 127 out of 300
EPOCH[1361/2000] loss-1.208-|Sample:2.01|use_time:60.240516901016235
loss: -1.2084785031109322, EarlyStopping counter: 128 out of 300
EPOCH[1362/2000] loss-1.207-|Sample:2.11|use_time:60.09828543663025
loss: -1.2074363987620285, EarlyStopping counter: 129 out of 300
EPOCH[1363/2000] loss-1.207-|Sample:1.97|use_time:60.08643698692322
loss: -1.2072902598032138, EarlyStopping counter: 130 out of 300
EPOCH[1364/2000] loss-1.209-|Sample:1.94|use_time:60.71513843536377
loss: -1.209451544575575, EarlyStopping counter: 131 out of 300
EPOCH[1365/2000] loss-1.207-|Sample:1.96|use_time:60.1141140460968
loss: -1.207098655584382, EarlyStopping counter: 132 out of 300
EPOCH[1366/2000] loss-1.207-|Sample:1.96|use_time:60.738492250442505
loss: -1.2074452435098044, EarlyStopping counter: 133 out of 300
EPOCH[1367/2000] loss-1.207-|Sample:2.02|use_time:61.29921627044678
loss: -1.2071860650690591, EarlyStopping counter: 134 out of 300
EPOCH[1368/2000] loss-1.210-|Sample:1.55|use_time:59.80211329460144
loss: -1.2101303658834317, EarlyStopping counter: 135 out of 300
EPOCH[1369/2000] loss-1.206-|Sample:2.02|use_time:61.05566596984863
loss: -1.2064920169551199, EarlyStopping counter: 136 out of 300
EPOCH[1370/2000] loss-1.206-|Sample:1.02|use_time:59.84323596954346
loss: -1.2063133716583252, EarlyStopping counter: 137 out of 300
EPOCH[1371/2000] loss-1.208-|Sample:1.78|use_time:59.74022674560547
loss: -1.2077447146904179, EarlyStopping counter: 138 out of 300
EPOCH[1372/2000] loss-1.208-|Sample:1.99|use_time:60.59997510910034
loss: -1.2075575183077556, EarlyStopping counter: 139 out of 300
EPOCH[1373/2000] loss-1.210-|Sample:1.75|use_time:59.8283896446228
loss: -1.210458095480756, EarlyStopping counter: 140 out of 300
EPOCH[1374/2000] loss-1.207-|Sample:1.98|use_time:59.920644760131836
loss: -1.2073110342025757, EarlyStopping counter: 141 out of 300
EPOCH[1375/2000] loss-1.210-|Sample:2.08|use_time:59.53762745857239
loss: -1.2098516429342874, EarlyStopping counter: 142 out of 300
EPOCH[1376/2000] loss-1.208-|Sample:2.00|use_time:60.82296085357666
loss: -1.2082776587183883, EarlyStopping counter: 143 out of 300
EPOCH[1377/2000] loss-1.209-|Sample:2.01|use_time:60.24620318412781
loss: -1.2092324204561187, EarlyStopping counter: 144 out of 300
EPOCH[1378/2000] loss-1.208-|Sample:2.08|use_time:59.791608810424805
loss: -1.2083126451910995, EarlyStopping counter: 145 out of 300
EPOCH[1379/2000] loss-1.209-|Sample:1.95|use_time:60.68197727203369
loss: -1.2086897914002581, EarlyStopping counter: 146 out of 300
EPOCH[1380/2000] loss-1.208-|Sample:1.64|use_time:60.9783353805542
loss: -1.2078074158691778, EarlyStopping counter: 147 out of 300
EPOCH[1381/2000] loss-1.210-|Sample:1.04|use_time:59.873119831085205
loss: -1.2096370051546794, EarlyStopping counter: 148 out of 300
EPOCH[1382/2000] loss-1.210-|Sample:1.90|use_time:60.0138304233551
loss: -1.21004251445212, EarlyStopping counter: 149 out of 300
EPOCH[1383/2000] loss-1.208-|Sample:1.91|use_time:60.92521572113037
loss: -1.2078004203191617, EarlyStopping counter: 150 out of 300
EPOCH[1384/2000] loss-1.208-|Sample:1.58|use_time:59.63256120681763
loss: -1.2084021800901832, EarlyStopping counter: 151 out of 300
EPOCH[1385/2000] loss-1.209-|Sample:1.86|use_time:60.22710919380188
loss: -1.2090835484062754, EarlyStopping counter: 152 out of 300
EPOCH[1386/2000] loss-1.210-|Sample:1.93|use_time:60.24894380569458
loss: -1.209511160850525, EarlyStopping counter: 153 out of 300
EPOCH[1387/2000] loss-1.208-|Sample:1.93|use_time:60.57489848136902
loss: -1.2076856653864791, EarlyStopping counter: 154 out of 300
EPOCH[1388/2000] loss-1.207-|Sample:1.01|use_time:60.46570634841919
loss: -1.207046942013066, EarlyStopping counter: 155 out of 300
EPOCH[1389/2000] loss-1.206-|Sample:1.85|use_time:59.9875967502594
loss: -1.2055940453599139, EarlyStopping counter: 156 out of 300
EPOCH[1390/2000] loss-1.210-|Sample:1.98|use_time:59.741984844207764
loss: -1.2103679412748756, EarlyStopping counter: 157 out of 300
EPOCH[1391/2000] loss-1.209-|Sample:2.00|use_time:60.29308891296387
loss: -1.2091364133648757, EarlyStopping counter: 158 out of 300
EPOCH[1392/2000] loss-1.211-|Sample:2.02|use_time:60.77238392829895
loss: -1.2107743548183907, EarlyStopping counter: 159 out of 300
EPOCH[1393/2000] loss-1.210-|Sample:2.04|use_time:60.29561948776245
loss: -1.2104634424535239, EarlyStopping counter: 160 out of 300
EPOCH[1394/2000] loss-1.210-|Sample:2.04|use_time:60.97332763671875
loss: -1.2104835045046922, EarlyStopping counter: 161 out of 300
EPOCH[1395/2000] loss-1.209-|Sample:1.99|use_time:60.14277482032776
loss: -1.2086079149711422, EarlyStopping counter: 162 out of 300
EPOCH[1396/2000] loss-1.207-|Sample:2.01|use_time:60.404178857803345
loss: -1.2070971581994034, EarlyStopping counter: 163 out of 300
EPOCH[1397/2000] loss-1.210-|Sample:1.64|use_time:59.479474782943726
loss: -1.2099588382534865, EarlyStopping counter: 164 out of 300
EPOCH[1398/2000] loss-1.208-|Sample:2.01|use_time:60.27634906768799
loss: -1.2081925868988037, EarlyStopping counter: 165 out of 300
EPOCH[1399/2000] loss-1.207-|Sample:1.96|use_time:60.0270733833313
loss: -1.2067081055990079, EarlyStopping counter: 166 out of 300
EPOCH[1400/2000] loss-1.209-|Sample:1.99|use_time:59.89833092689514
loss: -1.2094240770107363, EarlyStopping counter: 167 out of 300
[TEST]
{'precision': array([0.0270412 , 0.02019975, 0.01217228]), 'recall': array([0.11625341, 0.16972831, 0.25172418]), 'ndcg': array([0.07888038, 0.09520889, 0.11546444]), 'coverage': array([24.17091136, 28.38302122, 33.278402  ]), 'Acoverage': array([135.93724917, 183.46309187, 262.36227886]), 'ILD': array([0.71568317, 0.73339444, 0.7663116 ]), 'F1': array([0.20001672, 0.27566086, 0.37896342])}
test time: 261.6510214805603
reg_loss2: tensor(0.0089, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2227, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[1401/2000] loss-1.208-|Sample:2.02|use_time:59.84281349182129
loss: -1.2079367027050112, EarlyStopping counter: 168 out of 300
EPOCH[1402/2000] loss-1.209-|Sample:1.52|use_time:60.090176820755005
loss: -1.2092984507723552, EarlyStopping counter: 169 out of 300
EPOCH[1403/2000] loss-1.207-|Sample:1.76|use_time:60.49954438209534
loss: -1.207342415321164, EarlyStopping counter: 170 out of 300
EPOCH[1404/2000] loss-1.211-|Sample:1.00|use_time:59.79927849769592
loss: -1.2110061209376266, EarlyStopping counter: 171 out of 300
EPOCH[1405/2000] loss-1.206-|Sample:2.01|use_time:60.18702006340027
loss: -1.2064102771805554, EarlyStopping counter: 172 out of 300
EPOCH[1406/2000] loss-1.210-|Sample:2.10|use_time:61.431244134902954
loss: -1.2098113647321376, EarlyStopping counter: 173 out of 300
EPOCH[1407/2000] loss-1.210-|Sample:1.69|use_time:59.763368129730225
loss: -1.2095433415436163, EarlyStopping counter: 174 out of 300
EPOCH[1408/2000] loss-1.209-|Sample:2.07|use_time:60.024604082107544
loss: -1.2093091243650855, EarlyStopping counter: 175 out of 300
EPOCH[1409/2000] loss-1.212-|Sample:2.01|use_time:60.05813264846802
loss: -1.2120003205973928, EarlyStopping counter: 176 out of 300
EPOCH[1410/2000] loss-1.209-|Sample:1.98|use_time:61.41464972496033
loss: -1.2092041067960786, EarlyStopping counter: 177 out of 300
EPOCH[1411/2000] loss-1.208-|Sample:1.66|use_time:59.60114812850952
loss: -1.2080199631249033, EarlyStopping counter: 178 out of 300
EPOCH[1412/2000] loss-1.210-|Sample:1.90|use_time:59.93707728385925
loss: -1.210207494293771, EarlyStopping counter: 179 out of 300
EPOCH[1413/2000] loss-1.209-|Sample:1.93|use_time:60.993985176086426
loss: -1.2088472087208817, EarlyStopping counter: 180 out of 300
EPOCH[1414/2000] loss-1.209-|Sample:1.66|use_time:60.584853172302246
loss: -1.2090241472895553, EarlyStopping counter: 181 out of 300
EPOCH[1415/2000] loss-1.209-|Sample:1.06|use_time:59.78565454483032
loss: -1.209044808294715, EarlyStopping counter: 182 out of 300
EPOCH[1416/2000] loss-1.209-|Sample:1.84|use_time:60.17533588409424
loss: -1.2093885729952556, EarlyStopping counter: 183 out of 300
EPOCH[1417/2000] loss-1.208-|Sample:1.99|use_time:61.05501389503479
loss: -1.2080406764658487, EarlyStopping counter: 184 out of 300
EPOCH[1418/2000] loss-1.206-|Sample:1.51|use_time:59.617658853530884
loss: -1.2063991616411907, EarlyStopping counter: 185 out of 300
EPOCH[1419/2000] loss-1.206-|Sample:2.01|use_time:60.19843506813049
loss: -1.2064667271404732, EarlyStopping counter: 186 out of 300
EPOCH[1420/2000] loss-1.209-|Sample:2.05|use_time:60.16179966926575
loss: -1.2091422139144525, EarlyStopping counter: 187 out of 300
EPOCH[1421/2000] loss-1.210-|Sample:1.98|use_time:60.69863557815552
loss: -1.2096984211991473, EarlyStopping counter: 188 out of 300
EPOCH[1422/2000] loss-1.207-|Sample:1.03|use_time:60.30944490432739
loss: -1.2074209073694742, EarlyStopping counter: 189 out of 300
EPOCH[1423/2000] loss-1.207-|Sample:1.98|use_time:60.36261200904846
loss: -1.206981946782368, EarlyStopping counter: 190 out of 300
EPOCH[1424/2000] loss-1.210-|Sample:2.00|use_time:60.21675705909729
loss: -1.209859080430938, EarlyStopping counter: 191 out of 300
EPOCH[1425/2000] loss-1.207-|Sample:2.01|use_time:60.06192708015442
loss: -1.2073846125021213, EarlyStopping counter: 192 out of 300
EPOCH[1426/2000] loss-1.207-|Sample:2.00|use_time:60.63895106315613
loss: -1.2068330572872628, EarlyStopping counter: 193 out of 300
EPOCH[1427/2000] loss-1.210-|Sample:2.03|use_time:60.1685585975647
loss: -1.2100882210382602, EarlyStopping counter: 194 out of 300
EPOCH[1428/2000] loss-1.209-|Sample:1.95|use_time:60.750484228134155
loss: -1.2085166122855209, EarlyStopping counter: 195 out of 300
EPOCH[1429/2000] loss-1.209-|Sample:1.62|use_time:59.45492434501648
loss: -1.2085957003802787, EarlyStopping counter: 196 out of 300
EPOCH[1430/2000] loss-1.207-|Sample:1.89|use_time:60.65350389480591
loss: -1.2065647636971824, EarlyStopping counter: 197 out of 300
EPOCH[1431/2000] loss-1.211-|Sample:1.88|use_time:60.28947734832764
loss: -1.210610517641393, EarlyStopping counter: 198 out of 300
EPOCH[1432/2000] loss-1.208-|Sample:2.02|use_time:60.867523431777954
loss: -1.208338391490099, EarlyStopping counter: 199 out of 300
EPOCH[1433/2000] loss-1.210-|Sample:1.97|use_time:60.34312462806702
loss: -1.209772947357922, EarlyStopping counter: 200 out of 300
EPOCH[1434/2000] loss-1.207-|Sample:2.07|use_time:60.38653492927551
loss: -1.2071691780555538, EarlyStopping counter: 201 out of 300
EPOCH[1435/2000] loss-1.208-|Sample:1.95|use_time:59.918962240219116
loss: -1.2080343758187644, EarlyStopping counter: 202 out of 300
EPOCH[1436/2000] loss-1.210-|Sample:1.97|use_time:60.391884326934814
loss: -1.21016951886619, EarlyStopping counter: 203 out of 300
EPOCH[1437/2000] loss-1.207-|Sample:1.94|use_time:59.5516152381897
loss: -1.207384565981423, EarlyStopping counter: 204 out of 300
EPOCH[1438/2000] loss-1.209-|Sample:2.11|use_time:60.437251806259155
loss: -1.209078172358071, EarlyStopping counter: 205 out of 300
EPOCH[1439/2000] loss-1.209-|Sample:1.98|use_time:60.49023509025574
loss: -1.2091876704518387, EarlyStopping counter: 206 out of 300
EPOCH[1440/2000] loss-1.210-|Sample:2.03|use_time:60.807960987091064
loss: -1.2098720131850824, EarlyStopping counter: 207 out of 300
EPOCH[1441/2000] loss-1.207-|Sample:1.03|use_time:59.699060678482056
loss: -1.2073845514437047, EarlyStopping counter: 208 out of 300
EPOCH[1442/2000] loss-1.210-|Sample:2.06|use_time:60.19768762588501
loss: -1.2095156268375675, EarlyStopping counter: 209 out of 300
EPOCH[1443/2000] loss-1.208-|Sample:2.05|use_time:61.441529750823975
loss: -1.208253296410165, EarlyStopping counter: 210 out of 300
EPOCH[1444/2000] loss-1.207-|Sample:1.65|use_time:60.029534339904785
loss: -1.207110056063024, EarlyStopping counter: 211 out of 300
EPOCH[1445/2000] loss-1.207-|Sample:2.02|use_time:60.262110471725464
loss: -1.206708326572325, EarlyStopping counter: 212 out of 300
EPOCH[1446/2000] loss-1.207-|Sample:2.03|use_time:60.14194440841675
loss: -1.206825893099715, EarlyStopping counter: 213 out of 300
EPOCH[1447/2000] loss-1.208-|Sample:1.97|use_time:60.57486295700073
loss: -1.2080269557673757, EarlyStopping counter: 214 out of 300
EPOCH[1448/2000] loss-1.210-|Sample:1.03|use_time:59.81399154663086
loss: -1.2096730063601238, EarlyStopping counter: 215 out of 300
EPOCH[1449/2000] loss-1.207-|Sample:2.05|use_time:60.12031364440918
loss: -1.207411254324564, EarlyStopping counter: 216 out of 300
EPOCH[1450/2000] loss-1.208-|Sample:2.06|use_time:60.23520851135254
loss: -1.207947800799114, EarlyStopping counter: 217 out of 300
[TEST]
{'precision': array([0.0272784 , 0.02000624, 0.01219725]), 'recall': array([0.11670872, 0.1688725 , 0.2525058 ]), 'ndcg': array([0.0792295 , 0.09505995, 0.11582012]), 'coverage': array([24.27665418, 28.45405743, 33.41785268]), 'Acoverage': array([135.45936177, 182.99598063, 261.90855942]), 'ILD': array([0.71315578, 0.73201722, 0.76564937]), 'F1': array([0.20059057, 0.27443444, 0.37976707])}
test time: 261.56942796707153
reg_loss2: tensor(0.0089, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2411, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[1451/2000] loss-1.208-|Sample:2.07|use_time:60.22710919380188
loss: -1.2078163623809814, EarlyStopping counter: 218 out of 300
EPOCH[1452/2000] loss-1.207-|Sample:1.98|use_time:60.37929892539978
loss: -1.2067912671624161, EarlyStopping counter: 219 out of 300
EPOCH[1453/2000] loss-1.208-|Sample:1.00|use_time:59.931999921798706
loss: -1.2084175871639717, EarlyStopping counter: 220 out of 300
EPOCH[1454/2000] loss-1.208-|Sample:2.04|use_time:60.01863980293274
loss: -1.20774035628249, EarlyStopping counter: 221 out of 300
EPOCH[1455/2000] loss-1.209-|Sample:1.99|use_time:61.36875605583191
loss: -1.2086178994760282, EarlyStopping counter: 222 out of 300
EPOCH[1456/2000] loss-1.210-|Sample:1.51|use_time:59.94246244430542
loss: -1.2099661420031291, EarlyStopping counter: 223 out of 300
EPOCH[1457/2000] loss-1.209-|Sample:1.96|use_time:60.08080530166626
loss: -1.2090689350919026, EarlyStopping counter: 224 out of 300
EPOCH[1458/2000] loss-1.209-|Sample:2.00|use_time:60.11273407936096
loss: -1.208918522043926, EarlyStopping counter: 225 out of 300
EPOCH[1459/2000] loss-1.209-|Sample:2.07|use_time:60.73234987258911
loss: -1.2092038771001303, EarlyStopping counter: 226 out of 300
EPOCH[1460/2000] loss-1.210-|Sample:2.06|use_time:60.000847816467285
loss: -1.2095068896689065, EarlyStopping counter: 227 out of 300
EPOCH[1461/2000] loss-1.209-|Sample:2.07|use_time:60.07312297821045
loss: -1.2088051336567576, EarlyStopping counter: 228 out of 300
EPOCH[1462/2000] loss-1.210-|Sample:2.02|use_time:60.76744508743286
loss: -1.2099352260915244, EarlyStopping counter: 229 out of 300
EPOCH[1463/2000] loss-1.208-|Sample:1.98|use_time:60.97907781600952
loss: -1.207991213333316, EarlyStopping counter: 230 out of 300
EPOCH[1464/2000] loss-1.208-|Sample:1.01|use_time:59.4638831615448
loss: -1.207592280899606, EarlyStopping counter: 231 out of 300
EPOCH[1465/2000] loss-1.208-|Sample:1.94|use_time:60.04639744758606
loss: -1.207654819255922, EarlyStopping counter: 232 out of 300
EPOCH[1466/2000] loss-1.208-|Sample:1.96|use_time:60.97291350364685
loss: -1.2084268593206637, EarlyStopping counter: 233 out of 300
EPOCH[1467/2000] loss-1.208-|Sample:1.79|use_time:60.10932493209839
loss: -1.2084419087665836, EarlyStopping counter: 234 out of 300
EPOCH[1468/2000] loss-1.211-|Sample:1.93|use_time:60.37878727912903
loss: -1.211431308490474, EarlyStopping counter: 235 out of 300
EPOCH[1469/2000] loss-1.207-|Sample:1.83|use_time:59.90044975280762
loss: -1.2073368822656028, EarlyStopping counter: 236 out of 300
EPOCH[1470/2000] loss-1.209-|Sample:1.91|use_time:60.678417921066284
loss: -1.2092559250389658, EarlyStopping counter: 237 out of 300
EPOCH[1471/2000] loss-1.206-|Sample:1.08|use_time:60.063348054885864
loss: -1.2060190759054044, EarlyStopping counter: 238 out of 300
EPOCH[1472/2000] loss-1.207-|Sample:2.05|use_time:60.187997817993164
loss: -1.2072163006154502, EarlyStopping counter: 239 out of 300
EPOCH[1473/2000] loss-1.209-|Sample:1.92|use_time:60.264445543289185
loss: -1.2094473257297422, EarlyStopping counter: 240 out of 300
EPOCH[1474/2000] loss-1.206-|Sample:2.01|use_time:60.210182428359985
loss: -1.2064405418023831, EarlyStopping counter: 241 out of 300
EPOCH[1475/2000] loss-1.207-|Sample:2.02|use_time:60.67647624015808
loss: -1.2069663449031551, EarlyStopping counter: 242 out of 300
EPOCH[1476/2000] loss-1.208-|Sample:1.96|use_time:60.27543067932129
loss: -1.2082745709070346, EarlyStopping counter: 243 out of 300
EPOCH[1477/2000] loss-1.209-|Sample:2.06|use_time:60.67231106758118
loss: -1.2090203645752697, EarlyStopping counter: 244 out of 300
EPOCH[1478/2000] loss-1.208-|Sample:1.89|use_time:60.452887535095215
loss: -1.2083270811453097, EarlyStopping counter: 245 out of 300
EPOCH[1479/2000] loss-1.207-|Sample:2.05|use_time:61.724597692489624
loss: -1.2074400331915878, EarlyStopping counter: 246 out of 300
EPOCH[1480/2000] loss-1.209-|Sample:1.63|use_time:60.12917494773865
loss: -1.2087164622981375, EarlyStopping counter: 247 out of 300
EPOCH[1481/2000] loss-1.208-|Sample:2.00|use_time:60.23158931732178
loss: -1.2083213474692367, EarlyStopping counter: 248 out of 300
EPOCH[1482/2000] loss-1.208-|Sample:2.10|use_time:60.0049889087677
loss: -1.2079893205224015, EarlyStopping counter: 249 out of 300
EPOCH[1483/2000] loss-1.209-|Sample:2.04|use_time:59.85321068763733
loss: -1.209344959840542, EarlyStopping counter: 250 out of 300
EPOCH[1484/2000] loss-1.207-|Sample:2.02|use_time:59.796674966812134
loss: -1.2066706942348946, EarlyStopping counter: 251 out of 300
EPOCH[1485/2000] loss-1.208-|Sample:2.02|use_time:60.32096743583679
loss: -1.2080866825289842, EarlyStopping counter: 252 out of 300
EPOCH[1486/2000] loss-1.207-|Sample:2.10|use_time:59.96957588195801
loss: -1.2066932335132505, EarlyStopping counter: 253 out of 300
EPOCH[1487/2000] loss-1.209-|Sample:1.99|use_time:60.18559956550598
loss: -1.2086481728204868, EarlyStopping counter: 254 out of 300
EPOCH[1488/2000] loss-1.210-|Sample:1.99|use_time:60.495558977127075
loss: -1.2101878567439754, EarlyStopping counter: 255 out of 300
EPOCH[1489/2000] loss-1.208-|Sample:2.01|use_time:61.24911284446716
loss: -1.207638359651333, EarlyStopping counter: 256 out of 300
EPOCH[1490/2000] loss-1.209-|Sample:1.02|use_time:59.67477369308472
loss: -1.209065102949375, EarlyStopping counter: 257 out of 300
EPOCH[1491/2000] loss-1.209-|Sample:1.98|use_time:60.19497537612915
loss: -1.208613485824771, EarlyStopping counter: 258 out of 300
EPOCH[1492/2000] loss-1.206-|Sample:2.05|use_time:61.042396068573
loss: -1.2064867077804193, EarlyStopping counter: 259 out of 300
EPOCH[1493/2000] loss-1.209-|Sample:1.68|use_time:59.77831172943115
loss: -1.2090109848394626, EarlyStopping counter: 260 out of 300
EPOCH[1494/2000] loss-1.206-|Sample:1.96|use_time:60.17148423194885
loss: -1.2064263006535971, EarlyStopping counter: 261 out of 300
EPOCH[1495/2000] loss-1.208-|Sample:1.91|use_time:59.77561569213867
loss: -1.2081023222062646, EarlyStopping counter: 262 out of 300
EPOCH[1496/2000] loss-1.208-|Sample:2.05|use_time:60.70975375175476
loss: -1.2077204454235915, EarlyStopping counter: 263 out of 300
EPOCH[1497/2000] loss-1.209-|Sample:1.01|use_time:60.095375061035156
loss: -1.2085712304929408, EarlyStopping counter: 264 out of 300
EPOCH[1498/2000] loss-1.210-|Sample:1.87|use_time:60.668428897857666
loss: -1.2099301582429467, EarlyStopping counter: 265 out of 300
EPOCH[1499/2000] loss-1.208-|Sample:1.91|use_time:60.46064114570618
loss: -1.2079537176504367, EarlyStopping counter: 266 out of 300
EPOCH[1500/2000] loss-1.209-|Sample:1.80|use_time:60.2838180065155
loss: -1.2086566366800449, EarlyStopping counter: 267 out of 300
[TEST]
{'precision': array([0.0271161 , 0.02036205, 0.01217478]), 'recall': array([0.11533761, 0.16991201, 0.25215   ]), 'ndcg': array([0.07875489, 0.09534954, 0.11558087]), 'coverage': array([24.2772784 , 28.42059925, 33.27777778]), 'Acoverage': array([135.61252398, 182.69715904, 261.59005816]), 'ILD': array([0.71357192, 0.73210986, 0.76544758]), 'F1': array([0.19857819, 0.27581207, 0.37933975])}
test time: 263.91485810279846
reg_loss2: tensor(0.0089, device='cuda:0', grad_fn=<MulBackward0>) au_loss: tensor(-1.2196, device='cuda:0', grad_fn=<AddBackward0>)
EPOCH[1501/2000] loss-1.207-|Sample:2.09|use_time:60.03536248207092
loss: -1.206784155310654, EarlyStopping counter: 268 out of 300
EPOCH[1502/2000] loss-1.210-|Sample:1.57|use_time:59.607067346572876
loss: -1.2099004169789755, EarlyStopping counter: 269 out of 300
EPOCH[1503/2000] loss-1.207-|Sample:1.73|use_time:60.350436210632324
loss: -1.2074075210385207, EarlyStopping counter: 270 out of 300
EPOCH[1504/2000] loss-1.208-|Sample:1.87|use_time:60.51980996131897
loss: -1.2084203289776314, EarlyStopping counter: 271 out of 300
EPOCH[1505/2000] loss-1.211-|Sample:1.04|use_time:60.00528860092163
loss: -1.2105252510163842, EarlyStopping counter: 272 out of 300
EPOCH[1506/2000] loss-1.209-|Sample:1.08|use_time:60.45613431930542
loss: -1.208942744790054, EarlyStopping counter: 273 out of 300
EPOCH[1507/2000] loss-1.206-|Sample:1.07|use_time:60.37123894691467
loss: -1.2062437534332275, EarlyStopping counter: 274 out of 300
EPOCH[1508/2000] loss-1.208-|Sample:1.09|use_time:60.35362672805786
loss: -1.2084558591610048, EarlyStopping counter: 275 out of 300
EPOCH[1509/2000] loss-1.210-|Sample:1.03|use_time:60.31692123413086
loss: -1.2099152047459671, EarlyStopping counter: 276 out of 300
EPOCH[1510/2000] loss-1.207-|Sample:1.05|use_time:60.172425270080566
loss: -1.2068637115199392, EarlyStopping counter: 277 out of 300
EPOCH[1511/2000] loss-1.209-|Sample:1.03|use_time:60.26329255104065
loss: -1.2088582370339371, EarlyStopping counter: 278 out of 300
EPOCH[1512/2000] loss-1.208-|Sample:1.05|use_time:60.26966404914856
loss: -1.2080800533294678, EarlyStopping counter: 279 out of 300
EPOCH[1513/2000] loss-1.206-|Sample:1.07|use_time:60.97607493400574
loss: -1.2056756426648396, EarlyStopping counter: 280 out of 300
EPOCH[1514/2000] loss-1.211-|Sample:1.07|use_time:60.71575570106506
loss: -1.2107954170645736, EarlyStopping counter: 281 out of 300
EPOCH[1515/2000] loss-1.207-|Sample:1.08|use_time:60.42463946342468
loss: -1.2071632873721239, EarlyStopping counter: 282 out of 300
EPOCH[1516/2000] loss-1.209-|Sample:1.08|use_time:60.423312187194824
loss: -1.209413897700426, EarlyStopping counter: 283 out of 300
EPOCH[1517/2000] loss-1.208-|Sample:1.08|use_time:60.42583513259888
loss: -1.2078735944701404, EarlyStopping counter: 284 out of 300
EPOCH[1518/2000] loss-1.211-|Sample:1.05|use_time:60.822559118270874
loss: -1.2107379872624466, EarlyStopping counter: 285 out of 300
EPOCH[1519/2000] loss-1.206-|Sample:1.05|use_time:60.51259732246399
loss: -1.2062676359967488, EarlyStopping counter: 286 out of 300
EPOCH[1520/2000] loss-1.208-|Sample:1.03|use_time:60.18840169906616
loss: -1.2078197031486324, EarlyStopping counter: 287 out of 300
EPOCH[1521/2000] loss-1.208-|Sample:1.07|use_time:60.449235916137695
loss: -1.207907077742786, EarlyStopping counter: 288 out of 300
EPOCH[1522/2000] loss-1.209-|Sample:1.02|use_time:60.47271919250488
loss: -1.2089082118941517, EarlyStopping counter: 289 out of 300
EPOCH[1523/2000] loss-1.208-|Sample:1.03|use_time:60.05810761451721
loss: -1.2083259617410056, EarlyStopping counter: 290 out of 300
EPOCH[1524/2000] loss-1.207-|Sample:1.06|use_time:60.894179582595825
loss: -1.2067983819217216, EarlyStopping counter: 291 out of 300
EPOCH[1525/2000] loss-1.209-|Sample:1.06|use_time:60.59788107872009
loss: -1.209386095768068, EarlyStopping counter: 292 out of 300
EPOCH[1526/2000] loss-1.209-|Sample:1.05|use_time:60.15645360946655
loss: -1.2091683730846499, EarlyStopping counter: 293 out of 300
EPOCH[1527/2000] loss-1.207-|Sample:1.11|use_time:60.37053346633911
loss: -1.2073963066426718, EarlyStopping counter: 294 out of 300
EPOCH[1528/2000] loss-1.208-|Sample:1.04|use_time:60.53466081619263
loss: -1.2075853871136177, EarlyStopping counter: 295 out of 300
EPOCH[1529/2000] loss-1.209-|Sample:1.04|use_time:60.826080560684204
loss: -1.2092901817182216, EarlyStopping counter: 296 out of 300
EPOCH[1530/2000] loss-1.207-|Sample:1.04|use_time:60.36460018157959
loss: -1.2069966996588357, EarlyStopping counter: 297 out of 300
EPOCH[1531/2000] loss-1.209-|Sample:1.05|use_time:60.41670203208923
loss: -1.2086329750898408, EarlyStopping counter: 298 out of 300
EPOCH[1532/2000] loss-1.209-|Sample:1.07|use_time:60.63320446014404
loss: -1.2090189369713389, EarlyStopping counter: 299 out of 300
EPOCH[1533/2000] loss-1.208-|Sample:1.08|use_time:60.445780515670776
loss: -1.208192098431471, EarlyStopping counter: 300 out of 300
